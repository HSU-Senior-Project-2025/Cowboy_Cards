import{t as Ps,c as As,r,j as e,a as ve,S as _s,R as ts,u as as,C as Be,L as ue,b as Fs,d as rs,e as ie,f as Ls,$ as Os,V as ns,g as ls,A as os,h as is,X as cs,T as ds,D as ms,P as Rs,i as us,k as qs,l as he,m as ze,n as Ve,o as Ge,I as Us,p as $e,q as pe,s as Ms,v as re,w as v,x as O,y as B,z as K,B as $s,E as xe,F as M,G as Bs,H as ne,J as P,K as Ne,M as Je,N as He,O as zs,Q as xs,U as de,W as hs,Y as Vs,Z as Gs,_ as Js,a0 as Hs,a1 as Ks,a2 as F,a3 as z,a4 as V,a5 as $,a6 as Ys,a7 as Qs,a8 as Ws,a9 as Xs,aa as Qe,ab as Zs,ac as et,ad as st,ae as tt,af as at,ag as rt,ah as nt,ai as fs,aj as ye,ak as Ke,al as le,am as lt,an as ot,ao as it,ap as ct,aq as dt,ar as we,as as gs,at as mt,au as ut,av as xt,aw as We,ax as ht,ay as ft,az as gt,aA as jt,aB as pt,aC as yt,aD as L,aE as wt}from"./nm-g6DxaIw7.js";import"./index-CqUntBf8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}})();var Aa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _a(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function T(...s){return Ps(As(s))}const vt=ve("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),be=r.forwardRef(({className:s,variant:t,...a},n)=>e.jsx("div",{ref:n,role:"alert",className:T(vt({variant:t}),s),...a}));be.displayName="Alert";const Nt=r.forwardRef(({className:s,...t},a)=>e.jsx("h5",{ref:a,className:T("mb-1 font-medium leading-none tracking-tight",s),...t}));Nt.displayName="AlertTitle";const Ce=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:T("text-sm [&_p]:leading-relaxed",s),...t}));Ce.displayName="AlertDescription";const bt=ve("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),X=r.forwardRef(({className:s,variant:t,size:a,asChild:n=!1,...o},i)=>{const d=n?_s:"button";return e.jsx(d,{className:T(bt({variant:t,size:a,className:s})),ref:i,...o})});X.displayName="Button";const oe=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:T("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));oe.displayName="Card";const Se=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:T("flex flex-col space-y-1.5 p-6",s),...t}));Se.displayName="CardHeader";const ke=r.forwardRef(({className:s,...t},a)=>e.jsx("h3",{ref:a,className:T("text-2xl font-semibold leading-none tracking-tight",s),...t}));ke.displayName="CardTitle";const Ie=r.forwardRef(({className:s,...t},a)=>e.jsx("p",{ref:a,className:T("text-sm text-muted-foreground",s),...t}));Ie.displayName="CardDescription";const Ee=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:T("p-6 pt-0",s),...t}));Ee.displayName="CardContent";const De=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:T("flex items-center p-6 pt-0",s),...t}));De.displayName="CardFooter";const J=r.forwardRef(({className:s,type:t,...a},n)=>e.jsx("input",{type:t,className:T("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...a}));J.displayName="Input";const Ct=ve("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),H=r.forwardRef(({className:s,...t},a)=>e.jsx(ts,{ref:a,className:T(Ct(),s),...t}));H.displayName=ts.displayName;const St=1,kt=1e6;let Ue=0;function It(){return Ue=(Ue+1)%Number.MAX_SAFE_INTEGER,Ue.toString()}const Me=new Map,Xe=s=>{if(Me.has(s))return;const t=setTimeout(()=>{Me.delete(s),me({type:"REMOVE_TOAST",toastId:s})},kt);Me.set(s,t)},Et=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,St)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?Xe(a):s.toasts.forEach(n=>{Xe(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},ge=[];let je={toasts:[]};function me(s){je=Et(je,s),ge.forEach(t=>{t(je)})}function Dt({...s}){const t=It(),a=o=>me({type:"UPDATE_TOAST",toast:{...o,id:t}}),n=()=>me({type:"DISMISS_TOAST",toastId:t});return me({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:o=>{o||n()}}}),{id:t,dismiss:n,update:a}}function Te(){const[s,t]=r.useState(je);return r.useEffect(()=>(ge.push(t),()=>{const a=ge.indexOf(t);a>-1&&ge.splice(a,1)}),[s]),{...s,toast:Dt,dismiss:a=>me({type:"DISMISS_TOAST",toastId:a})}}const Ze={method:"GET",headers:{},credentials:"include"},Tt="https://cowboy-cards.dsouth.org";async function w(s="",t=Ze){const a={...Ze,...t};try{const n=await fetch(Tt+s,a);if(!n.ok){console.log("resp",n);const i=await n.text();throw new Error(`HTTP error! Status: ${n.status}, Message: ${i}`)}return n.status===204?null:await n.json()}catch(n){throw console.error("API request failed:",n),n}}const Pt="modulepreload",At=function(s,t){return new URL(s,t).href},es={},Fa=function(t,a,n){let o=Promise.resolve();if(a&&a.length>0){const d=document.getElementsByTagName("link"),m=document.querySelector("meta[property=csp-nonce]"),h=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));o=Promise.allSettled(a.map(l=>{if(l=At(l,n),l in es)return;es[l]=!0;const c=l.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(!!n)for(let x=d.length-1;x>=0;x--){const j=d[x];if(j.href===l&&(!c||j.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${f}`))return;const p=document.createElement("link");if(p.rel=c?"stylesheet":Pt,c||(p.as="script"),p.crossOrigin="",p.href=l,h&&p.setAttribute("nonce",h),document.head.appendChild(p),c)return new Promise((x,j)=>{p.addEventListener("load",x),p.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(d){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=d,window.dispatchEvent(m),!m.defaultPrevented)throw d}return o.then(d=>{for(const m of d||[])m.status==="rejected"&&i(m.reason);return t().catch(i)})},js=()=>{const[s,t]=r.useState(!0),[a,n]=r.useState(!1),[o,i]=r.useState(""),[d,m]=r.useState(""),[h,l]=r.useState(""),[c,f]=r.useState(""),[u,p]=r.useState(""),[x,j]=r.useState({}),N=as(),{toast:b}=Te(),C=()=>{const k={};let I=!0;return o?/\S+@\S+\.\S+/.test(o)||(k.email="Email is invalid",I=!1):(k.email="Email is required",I=!1),d?d.length<8&&(k.password="Password must be at least 8 characters",I=!1):(k.password="Password is required",I=!1),!s&&!h&&(k.username="Username is required",I=!1),j(k),I},R=async k=>{if(k.preventDefault(),!!C()){n(!0),j({});try{let I;s?I=await w("/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:o,password:d})}):I=await w("/signup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:h,email:o,password:d,first_name:c,last_name:u})}),b({duration:8e3,title:s?"Welcome back!":"Account created",description:s?"You have been successfully logged in.":"Your account has been created successfully."}),N.push("/home")}catch(I){console.error("Authentication error:",I),j(I),Object.keys(x).length===0&&j({general:I.message||"An unexpected error occurred. Please try again."}),b({title:"Authentication failed",description:I.message||"Please check your credentials and try again.",variant:"destructive"})}finally{n(!1)}}},G=()=>{j({}),s?(l(""),f(""),p("")):(i(""),m(""))};return e.jsxs(oe,{className:"w-11/12 max-w-[350px] mb-8",children:[e.jsxs(Se,{children:[e.jsx(ke,{className:"text-4xl tracking-wide font-smokum font-bold",children:s?"Welcome back":"Create account"}),e.jsx(Ie,{children:s?"Enter your credentials to continue":"Sign up for a new account"})]}),e.jsxs("form",{onSubmit:R,children:[e.jsxs(Ee,{className:"space-y-4",children:[x.general&&e.jsxs(be,{variant:"destructive",className:"mb-4",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx(Ce,{children:x.general})]}),!s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"username",children:"Username"}),e.jsx(J,{id:"username",type:"text",placeholder:"johndoe",value:h,onChange:k=>l(k.target.value),required:!0,className:x.username?"border-red-500":""}),x.username&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"firstName",children:"First Name"}),e.jsx(J,{id:"firstName",type:"text",placeholder:"John",value:c,onChange:k=>f(k.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"lastName",children:"Last Name"}),e.jsx(J,{id:"lastName",type:"text",placeholder:"Doe",value:u,onChange:k=>p(k.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"email",children:"Email"}),e.jsx(J,{id:"email",type:"email",placeholder:"name@example.com",value:o,onChange:k=>i(k.target.value),required:!0,className:x.email?"border-red-500":""}),x.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"password",children:"Password"}),e.jsx(J,{id:"password",type:"password",value:d,onChange:k=>m(k.target.value),required:!0,className:x.password?"border-red-500":""}),x.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.password}),!s&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long"})]}),s&&e.jsx(ue,{to:"/reset-password",className:"text-sm text-primary",children:"Forgot password?"})]}),e.jsxs(De,{className:"flex flex-col space-y-4",children:[e.jsxs(X,{type:"submit",className:"w-full",disabled:a,children:[e.jsx(Fs,{className:"mr-2 h-4 w-4"}),a?s?"Signing in...":"Signing up...":s?"Sign in":"Sign up"]}),e.jsx(X,{variant:"link",type:"button",onClick:()=>{t(!s),G()},className:"text-sm",disabled:a,children:s?"Need an account? Sign up":"Already have an account? Sign in"})]})]})]})},_t=()=>{var N;const t=((N=rs().state)==null?void 0:N.email)||"",[a,n]=r.useState(""),[o,i]=r.useState(""),[d,m]=r.useState(""),[h,l]=r.useState(!1),[c,f]=r.useState({}),u=ie(),{toast:p}=Te(),x=()=>{const b={};let C=!0;return d||(b.token="Reset token is required",C=!1),a?a.length<8&&(b.password="Password must be at least 8 characters",C=!1):(b.password="Password is required",C=!1),o?a!==o&&(b.confirmPassword="Passwords do not match",C=!1):(b.confirmPassword="Please confirm your password",C=!1),f({...c,...b}),C},j=async b=>{if(b.preventDefault(),!!x()){l(!0),f({});try{await w("/reset-password/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,token:d,password:a})}),p({title:"Password reset successful",description:"Your password has been reset. You can now log in with your new password."}),u.push("/auth")}catch(C){console.error("Password reset error:",C),C.message==="Invalid token"?f({token:"Invalid or expired token"}):f({general:C.message||"An error occurred during password reset. Please try again."}),p({title:"Password reset failed",description:C.message||"Please check your inputs and try again.",variant:"destructive"})}finally{l(!1)}}};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:e.jsxs(oe,{className:"w-[350px]",children:[e.jsxs(Se,{children:[e.jsx(ke,{children:"Reset Your Password"}),e.jsx(Ie,{children:"Enter your new password and the reset token sent to your email"})]}),e.jsxs("form",{onSubmit:j,children:[e.jsxs(Ee,{className:"space-y-4",children:[c.general&&e.jsxs(be,{variant:"destructive",className:"mb-4",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx(Ce,{children:c.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"token",children:"Reset Token"}),e.jsx(J,{id:"token",type:"text",placeholder:"Enter the token from your email",value:d,onChange:b=>m(b.target.value),required:!0,className:c.token?"border-red-500":""}),c.token&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.token})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"password",children:"New Password"}),e.jsx(J,{id:"password",type:"password",placeholder:"Enter your new password",value:a,onChange:b=>n(b.target.value),required:!0,className:c.password?"border-red-500":""}),c.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.password}),e.jsx("p",{className:"text-xs text-gray-500",children:"Password must be at least 8 characters long"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(J,{id:"confirmPassword",type:"password",placeholder:"Confirm your new password",value:o,onChange:b=>i(b.target.value),required:!0,className:c.confirmPassword?"border-red-500":""}),c.confirmPassword&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.confirmPassword})]})]}),e.jsx(De,{className:"flex flex-col space-y-4",children:e.jsx(X,{type:"submit",className:"w-full",disabled:h,children:h?"Processing...":"Reset Password"})})]})]})})},Ft=()=>{const[s,t]=r.useState(""),[a,n]=r.useState({}),[o,i]=r.useState(!1),{toast:d}=Te(),m=ie(),h=()=>{const c={};let f=!0;return s?/\S+@\S+\.\S+/.test(s)||(c.email="Email is invalid",f=!1):(c.email="Email is required",f=!1),n(c),f},l=async c=>{if(c.preventDefault(),!!h()){i(!0),n({});try{await w("/reset-password/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s})}),d({title:"Reset token sent",description:"If the email exists in our system, a reset token has been sent to it."}),m.push("/confirm-reset-password",{email:s})}catch(f){console.error("Reset password request error:",f),n({general:"An error occurred while processing your request. Please try again."}),d({title:"Reset request failed",description:"Please try again later.",variant:"destructive"})}finally{i(!1)}}};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:e.jsxs(oe,{className:"w-11/12 max-w-[350px]",children:[e.jsxs(Se,{children:[e.jsx(ke,{className:"text-4xl tracking-wide font-smokum font-bold",children:"Reset Password"}),e.jsx(Ie,{children:"Enter your email to reset your password"})]}),e.jsxs("form",{onSubmit:l,children:[e.jsxs(Ee,{className:"space-y-4",children:[a.general&&e.jsxs(be,{variant:"destructive",className:"mb-4",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx(Ce,{children:a.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"email",children:"Email"}),e.jsx(J,{id:"email",type:"email",placeholder:"name@example.com",value:s,onChange:c=>t(c.target.value),required:!0,className:a.email?"border-red-500":""}),a.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.email})]})]}),e.jsx(De,{className:"flex flex-col space-y-4",children:e.jsx(X,{type:"submit",className:"w-full",disabled:o,children:o?"Sending...":"Send Reset Token"})})]})]})})},Lt=({...s})=>{const{theme:t="system"}=Ls();return e.jsx(Os,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},Ot=Rs,ps=r.forwardRef(({className:s,...t},a)=>e.jsx(ns,{ref:a,className:T("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));ps.displayName=ns.displayName;const Rt=ve("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ys=r.forwardRef(({className:s,variant:t,...a},n)=>e.jsx(ls,{ref:n,className:T(Rt({variant:t}),s),...a}));ys.displayName=ls.displayName;const qt=r.forwardRef(({className:s,...t},a)=>e.jsx(os,{ref:a,className:T("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));qt.displayName=os.displayName;const ws=r.forwardRef(({className:s,...t},a)=>e.jsx(is,{ref:a,className:T("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(cs,{className:"h-4 w-4"})}));ws.displayName=is.displayName;const vs=r.forwardRef(({className:s,...t},a)=>e.jsx(ds,{ref:a,className:T("text-sm font-semibold",s),...t}));vs.displayName=ds.displayName;const Ns=r.forwardRef(({className:s,...t},a)=>e.jsx(ms,{ref:a,className:T("text-sm opacity-90",s),...t}));Ns.displayName=ms.displayName;function Ut(){const{toasts:s}=Te();return e.jsxs(Ot,{children:[s.map(function({id:t,title:a,description:n,action:o,...i}){return e.jsxs(ys,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(vs,{children:a}),n&&e.jsx(Ns,{children:n})]}),o,e.jsx(ws,{})]},t)}),e.jsx(ps,{})]})}const Mt=qs,$t=r.forwardRef(({className:s,sideOffset:t=4,...a},n)=>e.jsx(us,{ref:n,sideOffset:t,className:T("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));$t.displayName=us.displayName;const bs=r.createContext(void 0);function Bt({children:s}){const[t,a]=r.useState(()=>localStorage.getItem("theme")||"light");return r.useEffect(()=>{localStorage.setItem("theme",t),t==="dark"?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},[t]),e.jsx(bs.Provider,{value:{theme:t,setTheme:a},children:s})}function Cs(){const s=r.useContext(bs);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s}function zt(s){return he({queryKey:["class",s],queryFn:()=>w("/api/classes/",{method:"GET",headers:{id:s}}),staleTime:5*60*1e3})}function Vt(s){return he({queryKey:["classSets",s],queryFn:()=>w("/api/class_set/list_sets",{method:"GET",headers:{id:s}}),staleTime:5*60*1e3})}function Gt(s){return he({queryKey:["classMembers",s],queryFn:()=>w("/api/class_user/members",{method:"GET",headers:{class_id:s}}),staleTime:5*60*1e3})}function Jt(s){return he({queryKey:["classLeaderboard",s],queryFn:()=>w("/api/classes/leaderboard",{method:"GET",headers:{id:s}}),staleTime:5*60*1e3})}function Ht(){return he({queryKey:["userSets"],queryFn:()=>w("/api/set_user/list"),staleTime:5*60*1e3})}function Kt(){const s=ze();return Ve({mutationFn:({id:t,field:a,value:n})=>w(`/api/classes/${a}`,{method:"PUT",headers:{id:t,[a]:n}}),onSuccess:(t,a)=>{s.invalidateQueries({queryKey:["class",a.id]})}})}function Yt(s){const t=ze();return Ve({mutationFn:a=>w("/api/class_user/",{method:"DELETE",headers:{student_id:a,class_id:s}}),onSuccess:()=>{t.invalidateQueries({queryKey:["classMembers",s]})}})}function Qt(){const s=ze();return Ve({mutationFn:({classId:t,setId:a})=>w("/api/class_set/",{method:"POST",headers:{class_id:t,set_id:a.toString()}}),onSuccess:(t,a)=>{s.invalidateQueries({queryKey:["classSets",a.classId]})}})}const Wt=s=>{const[t,a]=r.useState(null),[n]=Ge(),{data:o=[],isLoading:i,error:d}=Ht(),m=Qt(),h=o.filter(u=>!s.existingSetIds.includes(u.SetID));r.useEffect(()=>{s.isOpen||a(null)},[s.isOpen]);const l=async()=>{if(!t||!s.classId){n({message:"Please select a set to add.",duration:2e3,color:"warning"});return}try{await m.mutateAsync({classId:s.classId,setId:t}),n({message:"Set added successfully!",duration:2e3,color:"success"}),s.onDidDismiss()}catch(u){const p=`Failed to add set: ${u instanceof Error?u.message:"Unknown error"}`;n({message:p,duration:3e3,color:"danger"})}},c=i||m.isPending,f=d||m.error;return e.jsxs(Us,{isOpen:s.isOpen,onDidDismiss:s.onDidDismiss,children:[e.jsx($e,{children:e.jsxs(pe,{children:[e.jsx(Ms,{children:"Add Set to Class"}),e.jsx(re,{slot:"end",children:e.jsx(v,{onClick:s.onDidDismiss,color:"medium",children:"Cancel"})})]})}),e.jsxs(O,{className:"ion-padding",children:[c&&!h.length?e.jsxs("div",{className:"flex justify-center items-center h-full",children:[e.jsx(B,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading your sets..."})]}):f?e.jsx(K,{color:"danger",children:e.jsx("p",{children:f instanceof Error?f.message:String(f)})}):h.length===0?e.jsx("p",{className:"text-center text-gray-500 mt-4",children:"You have no available sets to add to this class. Create a new set or check if all your sets are already added."}):e.jsx($s,{value:t,onIonChange:u=>{a(Number(u.detail.value))},children:e.jsx(xe,{children:h.map(u=>e.jsxs(M,{children:[e.jsx(Bs,{slot:"start",value:u.SetID},u.SetID),e.jsxs(ne,{children:[e.jsx("h2",{children:u.SetName}),e.jsx("p",{className:"text-sm text-gray-500",children:u.SetDescription})]})]},u.SetID))})}),f&&h.length>0&&e.jsx(K,{color:"danger",className:"block mt-4",children:e.jsx("p",{children:f instanceof Error?f.message:String(f)})})]}),!c&&h.length>0&&e.jsx("div",{className:"ion-padding",children:e.jsx(v,{expand:"block",onClick:l,disabled:!t||m.isPending,className:"ion-margin-bottom",children:m.isPending?e.jsx(B,{name:"dots"}):"Add Selected Set"})})]})},Xt=s=>e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs(v,{routerLink:"/home",color:"primary",children:[e.jsx(P,{slot:"start",icon:Ne}),"Back"]}),s.isTeacher&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{onClick:s.onAddSetClick,color:"primary",disabled:!s.classId,children:[e.jsx(P,{slot:"start",icon:Je}),"Add Existing Set"]}),e.jsxs(v,{routerLink:`/create-set?classId=${s.classId}`,color:"primary",disabled:!s.classId,children:[e.jsx(P,{slot:"start",icon:He}),"Create New Set"]})]})]}),se=s=>e.jsxs("div",{children:[e.jsx(M,{children:e.jsx(zs,{type:s.type,label:s.label,name:s.name,value:s.value,onIonChange:s.onChange})}),s.error&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.error})]}),Zt=s=>e.jsx(e.Fragment,{children:s.isEditing?e.jsxs(e.Fragment,{children:[e.jsx(se,{type:"text",label:"Class Name",name:"class_name",value:s.updatedInfo.class_name,onChange:s.handleChange,error:s.formErrors.className}),e.jsx(se,{type:"text",label:"Class Description",name:"class_description",value:s.updatedInfo.class_description,onChange:s.handleChange,error:s.formErrors.classDescription}),s.formErrors.general&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.formErrors.general}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx(v,{onClick:s.handleSave,color:"primary",size:"small",children:"Save"}),e.jsx(v,{onClick:s.handleCancel,color:"medium",size:"small",children:"Cancel"})]})]}):s.loading?e.jsx("div",{children:"Loading..."}):s.classData?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s.loading?"Loading...":s.classData.ClassName}),s.isTeacher&&!s.isEditing&&e.jsx(P,{icon:He,size:"large",color:"primary",className:"hover:transform hover:scale-110 cursor-pointer p-2",onClick:s.handleEdit})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:s.loading?"Loading...":s.classData.ClassDescription})]}):e.jsx("h1",{children:"Class details unavailable"})}),ea=s=>e.jsxs(xs,{value:s.selectedTab,onIonChange:t=>s.onTabChange(t.detail.value),className:"w-full mb-6",children:[e.jsxs(de,{value:"flashcards",children:[e.jsx(P,{icon:hs,className:"mr-2"}),e.jsx(ne,{children:"Flashcard Sets"})]}),e.jsxs(de,{value:"leaderboard",children:[e.jsx(P,{icon:Vs,className:"mr-2"}),e.jsx(ne,{children:"Leaderboard"})]}),e.jsxs(de,{value:"students",children:[e.jsx(P,{icon:Gs,className:"mr-2"}),e.jsx(ne,{children:"Students"})]})]}),sa=s=>{var o;const t=ie(),[a,n]=r.useState([]);return e.jsx("div",{className:"mt-6",children:s.loading?e.jsx("div",{children:"Loading..."}):(o=s.flashcardSets)!=null&&o.length?e.jsx(Js,{children:e.jsx(Hs,{children:s.flashcardSets.sort((i,d)=>i.ID-d.ID).map(i=>e.jsx(Ks,{size:"12",sizeMd:"6",sizeLg:"4",children:e.jsxs(F,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-200 rounded-lg border shadow-sm",onClick:()=>t.push(`/set-overview/${i.ID}`),children:[e.jsx(z,{children:e.jsx(V,{className:"text-lg font-semibold",children:i.SetName})}),e.jsx($,{children:e.jsx("p",{className:"text-muted-foreground mb-2",children:i.SetDescription})})]})},i.ID))})}):e.jsx("p",{children:"No flashcard sets available."})})},Ss=()=>e.jsx(Ys,{className:"hidden sm:block ion-no-border fixed bottom-0 w-full",children:e.jsxs(pe,{children:[e.jsx(re,{slot:"start",children:e.jsx(v,{routerLink:"/home",children:e.jsx(P,{icon:Qs})})}),e.jsx(K,{className:"mx-auto text-center text-sm",children:"©Cowboy Cards 2025. Built for learning and fun."})]})}),ta=s=>e.jsxs(F,{className:"rounded-lg border shadow-sm",children:[e.jsx(z,{children:e.jsx(V,{className:"text-xl font-semibold",children:"Class Leaderboard"})}),e.jsx($,{children:e.jsx(xe,{className:"max-h-96 overflow-y-auto space-y-3",lines:"none",children:s.leaderboard===null?e.jsx("h1",{className:"text-center text-gray-500",children:"No scores available"}):s.leaderboard.map((t,a)=>e.jsx(Ws.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:a*.1},children:e.jsxs(M,{className:"muted-item p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a===0&&e.jsx("span",{className:"text-yellow-500 text-xl",children:"🥇"}),a===1&&e.jsx("span",{className:"text-gray-400 text-xl",children:"🥈"}),a===2&&e.jsx("span",{className:"text-orange-500 text-xl",children:"🥉"}),e.jsx("span",{className:"font-medium text-lg",children:t.Username})]}),e.jsxs("span",{slot:"end",className:"text-primary font-semibold",children:[t.ClassScore," points"]})]})},t.UserID))})})]}),aa=s=>e.jsx(e.Fragment,{children:s.loadingScores?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(B,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Calculating scores..."})]}):e.jsx(ta,{leaderboard:s.leaderboardData})}),Y=()=>{const[s,t]=r.useState(null),a=l=>t(l.nativeEvent),n=()=>t(null),o=l=>{var c;i.push(l),(c=document.querySelector("ion-menu"))==null||c.close()},i=as(),{theme:d,setTheme:m}=Cs(),h=()=>{m(d==="dark"?"light":"dark")};return e.jsxs(e.Fragment,{children:[e.jsxs(Xs,{side:"start",contentId:"main-content",children:[e.jsx($e,{children:e.jsx(pe,{children:e.jsx(re,{slot:"start",children:e.jsx(Qe,{children:e.jsx(v,{children:e.jsx(P,{icon:Zs})})})})})}),e.jsx(O,{children:e.jsxs(xe,{children:[e.jsx(M,{button:!0,onClick:()=>o("/home"),children:"My Dashboard"}),e.jsx(M,{button:!0,onClick:()=>o("/public-cards"),children:"Public Cards"}),e.jsx(M,{button:!0,onClick:()=>o("/public-classes"),children:"Public Classes"}),e.jsx(M,{button:!0,onClick:()=>o("/user-account"),children:"My Account"})]})})]}),e.jsx($e,{children:e.jsxs(pe,{children:[e.jsx(re,{slot:"start",children:e.jsx(Qe,{children:e.jsx(v,{children:e.jsx(P,{icon:et})})})}),e.jsxs("div",{className:"cursor-pointer",onClick:()=>i.push("/home"),children:[e.jsx("img",{src:"/Spirit-Cowboy-Profile-Only.png",alt:"Cowboy Cards Logo",className:"h-8 w-auto xs:hidden block"}),e.jsx("h2",{className:"hidden xs:block text-2xl sm:text-3xl md:text-4xl text-ellipsis overflow-hidden whitespace-nowrap font-ewert text-[color:--ion-color-primary]",children:"Cowboy Cards"})]}),e.jsxs(re,{slot:"end",children:[e.jsx(v,{onClick:a,children:e.jsx(P,{icon:st,className:"text-[32px] stroke-[2]"})}),e.jsx(tt,{event:s,isOpen:!!s,onDidDismiss:n,children:e.jsx(O,{className:"p-2",children:e.jsxs(xe,{children:[e.jsx(M,{button:!0,onClick:()=>{n(),i.push("/create-set")},children:"Create Set"}),e.jsx(M,{button:!0,onClick:()=>{n(),i.push("/create-class")},children:"Create Class"}),e.jsx(M,{button:!0,onClick:()=>{n(),i.push("/public-classes")},children:"Join Class"})]})})}),e.jsx(v,{fill:"clear",onClick:h,children:e.jsx(P,{slot:"icon-only",icon:d==="dark"?at:rt})})]}),e.jsx(re,{slot:"end",children:e.jsx(v,{routerLink:"/user-account",children:e.jsx(P,{icon:nt,size:"large"})})})]})})]})},ra=s=>e.jsxs(F,{className:"mt-6",children:[e.jsx(z,{children:e.jsx(V,{className:"text-xl font-semibold",children:"Class Students"})}),e.jsx($,{children:e.jsx(xe,{className:"space-y-3",lines:"none",children:s.students.map(t=>e.jsxs(M,{className:"muted-item p-3",children:[e.jsxs("span",{className:"font-medium",children:[t.FirstName," ",t.LastName]}),e.jsx("span",{slot:"end",className:"text-muted-foreground",children:t.email}),s.isTeacher&&e.jsx(P,{slot:"end",icon:fs,color:"danger",className:"cursor-pointer",onClick:()=>s.onDeleteStudent(t.UserID)})]},t.UserID))})})]}),na=s=>{const[t,a]=r.useState({isOpen:!1,studentId:null}),n=o=>{a({isOpen:!0,studentId:o})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(ra,{isTeacher:s.isTeacher,students:s.students,onDeleteStudent:n})}),e.jsx(ye,{isOpen:t.isOpen,onDidDismiss:()=>a({isOpen:!1,studentId:null}),header:"Confirm Deletion",message:"Are you sure you want to remove this student from the class? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Delete",handler:()=>{t.studentId!==null&&(s.handleActualDelete(t.studentId),console.log(`Student deletion initiated for ID: ${t.studentId}`))}}]})]})},la=()=>{const{id:s}=Ke(),[t,a]=r.useState(0),[n,o]=r.useState(),[i,d]=r.useState("flashcards"),[m,h]=r.useState(!1),[l,c]=r.useState({class_name:"",class_description:""}),[f,u]=r.useState(!1),[p,x]=r.useState({}),{data:j,isLoading:N,error:b}=zt(s),{data:C=[],isLoading:R,error:G}=Vt(s),{data:k=[],isLoading:I,error:ae}=Gt(s),{data:Q=[],isLoading:Z,error:A}=Jt(s),D=Kt(),U=Yt(s),te=(j==null?void 0:j.Role)==="teacher",Ae=()=>{c({class_name:(j==null?void 0:j.ClassName)||"",class_description:(j==null?void 0:j.ClassDescription)||""}),h(!0)},_e=()=>{const g={};let y=!0;return l.class_name=l.class_name.trim(),l.class_description=l.class_description.trim(),l.class_name||(g.className="Class name is required",y=!1),l.class_description||(g.classDescription="Class description is required",y=!1),x(g),y},Fe=async()=>{if(_e())try{await Promise.all([D.mutateAsync({id:s,field:"class_name",value:l.class_name}),D.mutateAsync({id:s,field:"class_description",value:l.class_description})]),h(!1)}catch{alert("Failed to update some fields. Please try again.")}},Le=g=>{const{name:y}=g.target,E=g.detail.value;c(_=>({..._,[y]:E}))},Oe=()=>{h(!1)},Re=async g=>{if(g!==null)try{await U.mutateAsync(g)}catch{alert("Error deleting student")}};r.useEffect(()=>{n&&n.on("select",()=>{a(n.selectedScrollSnap())})},[n]);const ce=N||R||I||Z,fe=b||G||ae||A;return e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsxs(O,{className:"ion-padding",children:[e.jsxs("div",{id:"main-content",className:"max-w-4xl mx-auto",children:[fe&&e.jsx("div",{className:"text-red-500",children:fe.message}),e.jsx(Zt,{classData:j,isTeacher:te,loading:ce,handleEdit:Ae,isEditing:m,updatedInfo:l,formErrors:p,handleChange:Le,handleSave:Fe,handleCancel:Oe}),e.jsx(Xt,{isTeacher:te,classId:s,onAddSetClick:()=>u(!0)}),e.jsx(ea,{selectedTab:i,onTabChange:d}),i==="leaderboard"&&e.jsx(aa,{leaderboardData:Q,loadingScores:Z}),i==="flashcards"&&e.jsx(sa,{flashcardSets:C,currentCardIndex:t,setApi:o,loading:ce}),i==="students"&&e.jsx(na,{isTeacher:te,students:k,handleActualDelete:Re})]}),e.jsx(Ss,{})]}),e.jsx(Wt,{isOpen:f,onDidDismiss:()=>u(!1),classId:s,existingSetIds:C.map(g=>g.ID)})]})},oa=()=>{const[s,t]=r.useState(!1),[a,n]=r.useState(!1),[o,i]=r.useState(null),[d,m]=r.useState({className:"",description:""}),[h,l]=r.useState(!1);return r.useEffect(()=>{async function c(){if(s){n(!0),i(null);try{const f=await w("/api/classes",{method:"POST",headers:{class_name:d.className,class_description:d.description}});console.log("Class created successfully:",f),t(!1),m({className:"",description:""}),l(!0),n(!1)}catch(f){i(`Failed to create class: ${f.message}`)}finally{n(!1)}}}s&&c()},[s,d]),e.jsxs(O,{children:[e.jsx(Y,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[o&&e.jsx("div",{className:"text-red-500 mt-2",children:o}),e.jsx("h1",{className:"text-4xl tracking-wide font-bold font-smokum mb-6",children:"Create New Class"}),e.jsxs("form",{children:[e.jsx(F,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs($,{children:[e.jsx(le,{placeholder:"Enter Class Name",value:d.className,onIonChange:c=>m(f=>({...f,className:c.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),e.jsx(le,{placeholder:"Enter Class Description",value:d.description,onIonChange:c=>m(f=>({...f,description:c.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}})]})}),e.jsx("div",{className:"flex flex-col md:flex-row justify-center md:justify-end gap-4 mt-8",children:e.jsx(v,{color:"success",disabled:a,onClick:()=>t(!0),children:a?"Creating...":"Create Class"})})]}),h&&e.jsx(K,{children:e.jsx("p",{children:"Class created successfully!"})})]})]})},ia=()=>{const s=ie(),[t,a]=r.useState(""),[n,o]=r.useState(""),[i,d]=r.useState({title:"",description:""}),[m,h]=r.useState(!1),[l,c]=r.useState(null),f=async()=>{h(!0),c(null);const u={title:"",description:""};let p=!1;if(t.trim()||(u.title="Title is required",p=!0),n.trim()||(u.description="Description is required",p=!0),d(u),p){h(!1);return}try{const x=await w("/api/flashcards/sets",{method:"POST",headers:{set_name:t,set_description:n}});s.push(`/set-overview/${x.ID}`)}catch(x){console.error("Error saving flashcard set:",x),c(`Failed to save flashcard set: ${x.message}`)}finally{h(!1)}};return e.jsxs(O,{className:"",children:[e.jsx(Y,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[m&&e.jsx("div",{children:"Loading..."}),l&&e.jsx("div",{className:"text-red-500 mt-2",children:l}),e.jsx("h1",{className:"text-4xl tracking-wide font-bold font-smokum mb-6",children:"Create New Flashcard Set"}),e.jsx(F,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs($,{children:[e.jsx(le,{placeholder:"Enter set title",value:t,onIonChange:u=>a(u.detail.value),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),i.title&&e.jsx(K,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:i.title})}),e.jsx(le,{placeholder:"Enter set description",value:n,onIonChange:u=>o(u.detail.value),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}}),i.description&&e.jsx(K,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:i.description})})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(v,{color:"success",className:"rounded-lg shadow-sm w-full md:w-auto",onClick:f,disabled:m,children:m?"Creating...":"Create Set"})})]})]})},ca=s=>{const[t,a]=r.useState(!1),n=async d=>{var m;try{const h=await w(`${d}`,{method:"POST",headers:{card_id:s.cardId.toString()}});console.log(`Score update successful for card ${s.cardId}:`,h),(m=s.onAdvance)==null||m.call(s)}catch(h){console.error(`Failed to update score for card ${s.cardId}:`,h)}},o=()=>{n("/api/card_history/incorrect")},i=()=>{n("/api/card_history/correct")};return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsxs("div",{className:`flip-card cursor-pointer ${t?"flipped":""}`,onClick:()=>a(!t),children:[e.jsx(oe,{className:"flip-card-front p-8 min-h-[300px] flex items-center justify-center text-center",children:e.jsx("p",{className:"text-xl",children:s.front})}),e.jsx(oe,{className:"flip-card-back p-8 min-h-[300px] flex items-center justify-center text-center absolute top-0 w-full",children:e.jsx("p",{className:"text-xl",children:s.back})})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsxs(X,{variant:"outline",className:"w-32",onClick:o,children:[e.jsx(cs,{className:"mr-2 h-4 w-4"}),"Learning"]}),e.jsxs(X,{className:"w-32",onClick:i,children:[e.jsx(lt,{className:"mr-2 h-4 w-4"}),"Mastered"]})]})]})},ks=r.createContext(null);function Pe(){const s=r.useContext(ks);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const Is=r.forwardRef(({orientation:s="horizontal",opts:t,setApi:a,plugins:n,className:o,children:i,...d},m)=>{const[h,l]=ot({...t,axis:s==="horizontal"?"x":"y"},n),[c,f]=r.useState(!1),[u,p]=r.useState(!1),x=r.useCallback(C=>{C&&(f(C.canScrollPrev()),p(C.canScrollNext()))},[]),j=r.useCallback(()=>{l==null||l.scrollPrev()},[l]),N=r.useCallback(()=>{l==null||l.scrollNext()},[l]),b=r.useCallback(C=>{C.key==="ArrowLeft"?(C.preventDefault(),j()):C.key==="ArrowRight"&&(C.preventDefault(),N())},[j,N]);return r.useEffect(()=>{!l||!a||a(l)},[l,a]),r.useEffect(()=>{if(l)return x(l),l.on("reInit",x),l.on("select",x),()=>{l==null||l.off("select",x)}},[l,x]),e.jsx(ks.Provider,{value:{carouselRef:h,api:l,opts:t,orientation:s||((t==null?void 0:t.axis)==="y"?"vertical":"horizontal"),scrollPrev:j,scrollNext:N,canScrollPrev:c,canScrollNext:u},children:e.jsx("div",{ref:m,onKeyDownCapture:b,className:T("relative",o),role:"region","aria-roledescription":"carousel",...d,children:i})})});Is.displayName="Carousel";const Es=r.forwardRef(({className:s,...t},a)=>{const{carouselRef:n,orientation:o}=Pe();return e.jsx("div",{ref:n,className:"overflow-hidden",children:e.jsx("div",{ref:a,className:T("flex",o==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...t})})});Es.displayName="CarouselContent";const Ds=r.forwardRef(({className:s,...t},a)=>{const{orientation:n}=Pe();return e.jsx("div",{ref:a,role:"group","aria-roledescription":"slide",className:T("min-w-0 shrink-0 grow-0 basis-full",n==="horizontal"?"pl-4":"pt-4",s),...t})});Ds.displayName="CarouselItem";const da=r.forwardRef(({className:s,variant:t="outline",size:a="icon",...n},o)=>{const{orientation:i,scrollPrev:d,canScrollPrev:m}=Pe();return e.jsxs(X,{ref:o,variant:t,size:a,className:T("absolute  h-8 w-8 rounded-full",i==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!m,onClick:d,...n,children:[e.jsx(it,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});da.displayName="CarouselPrevious";const ma=r.forwardRef(({className:s,variant:t="outline",size:a="icon",...n},o)=>{const{orientation:i,scrollNext:d,canScrollNext:m}=Pe();return e.jsxs(X,{ref:o,variant:t,size:a,className:T("absolute h-8 w-8 rounded-full",i==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!m,onClick:d,...n,children:[e.jsx(ct,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});ma.displayName="CarouselNext";const ua=()=>{const{id:s}=Ke();ie();const[t,a]=r.useState(),[n,o]=r.useState([]),[i,d]=r.useState(),[m,h]=r.useState(0),[l,c]=r.useState(!0);r.useEffect(()=>{const u=async()=>{try{const x=await w("/api/flashcards/sets/",{method:"GET",headers:{id:s}});a(x)}catch(x){console.error("Failed to fetch set info",x)}},p=async()=>{c(!0);try{const x=await w("/api/flashcards/list",{method:"GET",headers:{set_id:s}});o(Array.isArray(x)?x.map(j=>({ID:j.ID,Front:j.Front,Back:j.Back,SetID:j.SetID,CreatedAt:j.CreatedAt,UpdatedAt:j.UpdatedAt})):[])}catch(x){console.error("Failed to fetch cards",x),o([])}finally{c(!1)}};s&&(u(),p())},[s]),r.useEffect(()=>{if(!i)return;const u=()=>{h(i.selectedScrollSnap())};return u(),i.on("select",u),i.on("reInit",u),()=>{i.off("select",u),i.off("reInit",u)}},[i]);const f=()=>{i&&i.scrollNext()};return e.jsxs(O,{className:"",children:[e.jsx(Y,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(v,{className:"rounded-lg",fill:"outline",style:{"--border-radius":"0.5rem"},routerLink:`/set-overview/${s}`,children:[e.jsx(P,{slot:"start",icon:Ne}),"Back"]}),e.jsx("div",{children:l?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(B,{name:"dots"}),e.jsx(B,{name:"dots"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl font-bold",children:t==null?void 0:t.SetName}),e.jsx("p",{className:"text-gray-500",children:t==null?void 0:t.SetDescription})]})})]}),e.jsx("div",{className:"w-full max-w-xl mx-auto relative py-8 min-h-[400px] flex items-center justify-center",children:l?e.jsx(B,{name:"circular"}):n.length===0?e.jsx("div",{className:"text-center text-gray-500 text-lg py-20",children:"This set has no cards yet."}):e.jsxs(e.Fragment,{children:[e.jsx(Is,{orientation:"vertical",setApi:d,className:"w-full",children:e.jsx(Es,{className:"-mt-1 h-[400px]",children:n.map((u,p)=>e.jsx(Ds,{children:e.jsx(ca,{front:u.Front,back:u.Back,onAdvance:f,cardId:u.ID})},p))})}),e.jsx("div",{className:"absolute right-[-50px] top-1/2 transform -translate-y-1/2 flex flex-col gap-2",children:n.map((u,p)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${p===m?"bg-primary":"bg-gray-300"}`},p))})]})})]})]})},xa=()=>{const[s,t]=r.useState("classes"),[a,n]=r.useState([]),[o,i]=r.useState([]),[d,m]=r.useState(!1),[h,l]=r.useState(!1),[c,f]=r.useState(null);return r.useEffect(()=>{const u=async()=>{m(!0),f(null);try{const x=await w("/api/class_user/classes");console.log("Classes: ",x),n(x)}catch(x){f(`Error fetching classes: ${x.message}`)}finally{m(!1)}},p=async()=>{l(!0);try{const x=await w("/api/set_user/list");console.log("Sets: ",x),i(x)}catch(x){f(`Error fetching sets: ${x.message}`)}finally{l(!1)}};u(),p()},[]),e.jsxs(O,{className:"flex flex-col min-h-screen",fullscreen:!0,children:[e.jsx(Y,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 flex-grow",children:[c&&e.jsx("div",{className:"text-red-500 mt-2",children:c}),e.jsxs("div",{className:"flex flex-col me:flex-row me:justify-between me:items-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-smokum font-bold",children:s==="classes"?"My Classes":"My Flashcard Sets"}),e.jsx("div",{className:"flex items-center gap-2 mt-4 me:mt-0",children:e.jsxs(v,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},routerLink:s==="classes"?"/public-classes":"/public-cards",children:[e.jsx(P,{slot:"start",icon:Je})," ",s==="classes"?"Join Class":"Join Set"]})})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(xs,{value:s,onIonChange:u=>t(u.detail.value||"classes"),style:{"--background":"var(--ion-color-light)"},children:[e.jsxs(de,{value:"classes",children:[e.jsx(P,{icon:dt,className:"mr-2"}),e.jsx(ne,{children:"My Classes"})]}),e.jsxs(de,{value:"flashcards",children:[e.jsx(P,{icon:hs,className:"mr-2"}),e.jsx(ne,{children:"My Cards"})]})]})}),s==="classes"&&e.jsx(e.Fragment,{children:d?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(B,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading classes..."})]}):a===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any classes. Join a class to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(u=>e.jsx(ue,{to:`/class/${u.ClassID}`,children:e.jsxs(F,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(z,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(V,{className:"text-2xl font-semibold leading-none tracking-tight",children:u.ClassName}),e.jsx(we,{className:"text-sm text-muted-foreground",children:u.ClassDescription})]}),e.jsx($,{})]})},u.ClassID))})}),s==="flashcards"&&e.jsx(e.Fragment,{children:h?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(B,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading sets..."})]}):o===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any sets. Join a set to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:o.map(u=>e.jsx(ue,{to:`/set-overview/${u.SetID}`,children:e.jsxs(F,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(z,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(V,{className:"text-2xl font-semibold leading-none tracking-tight",children:u.SetName}),e.jsx(we,{className:"text-sm text-muted-foreground",children:u.SetDescription})]}),e.jsx($,{})]})},u.SetID))})})]}),e.jsx(Ss,{})]})},ha=()=>e.jsx(O,{children:e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center from-white to-gray-50",children:[e.jsxs("div",{className:"text-center mb-8 sm:mb-12 md:mb-16 mt-6 sm:mt-10 md:mt-14 mx-2",children:[e.jsx("h1",{className:"text-5xl sm:text-6xl md:text-7xl text-primary mb-4 font-ewert",children:"Cowboy Cards"}),e.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-rye",children:"Master any subject with smart flashcards"})]}),e.jsx(js,{})]})}),fa=()=>{const s=rs();return r.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]),e.jsxs(O,{children:[e.jsx(Y,{}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})]})},ga=()=>{const[s,t]=r.useState(null),[a,n]=r.useState(!1),[o,i]=r.useState([]),[d,m]=r.useState(""),h=o.filter(l=>l.SetName.toLowerCase().includes(d.toLowerCase())||l.SetDescription&&l.SetDescription.toLowerCase().includes(d.toLowerCase()));return r.useEffect(()=>{async function l(){n(!0),t(null);try{const c=await w("/api/flashcards/sets/list");i(c)}catch(c){console.error("Error fetching flashcard sets:",c),t(`Error fetching flashcard sets: ${c.message}`)}finally{n(!1)}}l()},[]),e.jsxs(O,{children:[e.jsx(Y,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-0 py-8 w-4/5",children:[e.jsxs("div",{className:"flex items-center flex-col justify-between mb-4",children:[e.jsx("h1",{className:"text-4xl tracking-wide font-bold font-smokum pb-8",children:"Public Flashcard Sets"}),a&&e.jsx("div",{children:"Loading..."}),s&&e.jsx("div",{className:"text-red-500 mt-2",children:s}),e.jsx(gs,{value:d,onIonInput:l=>m(l.target.value),placeholder:"Search flashcard sets",className:"mb-4 max-w-lg"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:h.map(l=>e.jsx(ue,{to:`/flashcards/${l.ID}`,children:e.jsx(F,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(z,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(V,{className:"text-2xl font-semibold leading-none tracking-tight",children:l.SetName}),e.jsx(we,{className:"text-sm ",children:l.SetDescription||"No description"})]})})},l.ID))})]})]})},ja=()=>{const[s,t]=r.useState([]),[a,n]=r.useState(!1),[o,i]=r.useState(null),[d,m]=r.useState(""),h=s.filter(l=>l.ClassName.toLowerCase().includes(d.toLowerCase())||l.ClassDescription&&l.ClassDescription.toLowerCase().includes(d.toLowerCase()));return r.useEffect(()=>{(async()=>{n(!0),i(null);try{const c=await w("/api/classes/list");t(c)}catch(c){i(`Error fetching classes: ${c.message}`)}finally{n(!1)}})()},[]),e.jsxs(O,{children:[e.jsx(Y,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-0 py-8 w-4/5",children:[e.jsxs("div",{className:"flex items-center flex-col justify-between mb-4",children:[e.jsx("h1",{className:"text-4xl tracking-wide font-bold font-smokum pb-8",children:"Public Classes"}),a&&e.jsx("div",{children:"Loading..."}),o&&e.jsx("div",{className:"text-red-500 mt-2",children:o}),e.jsx(gs,{value:d,onIonInput:l=>m(l.target.value),placeholder:"Search classes",className:"mb-4 max-w-lg"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:h.map(l=>e.jsx(ue,{to:`/class/${l.ID}`,children:e.jsx(F,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(z,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(V,{className:"text-2xl font-semibold leading-none tracking-tight",children:l.ClassName}),e.jsx(we,{className:"text-sm ",children:l.ClassDescription||"No description"}),e.jsx(v,{expand:"block",color:"primary",className:"mt-4",onClick:async()=>{try{const c=await w("/api/class_user",{method:"POST",headers:{class_id:l.ID,role:"student"}});console.log("Join class response:",c)}catch(c){console.error("Error joining class:",c)}},children:"Join Class"})]})})},l.ID))})]})]})},pa=s=>e.jsx("div",{className:"mt-8 min-h-[200px]",children:s.loading?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(B,{name:"circular"})}):s.cardsToDisplay.length===0&&!s.isEditing?e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-900 dark:text-gray-400 mb-4",children:"This set has no cards yet."}),s.isOwner&&e.jsx(v,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},onClick:s.onAddCardClick,children:"Add Cards"})]}):e.jsxs("div",{className:"w-full",children:[s.cardsToDisplay.map((t,a)=>{var n,o,i,d;return s.isEditing&&s.isOwner?e.jsxs(F,{className:"mb-4 rounded-lg border shadow-sm p-4",children:[e.jsxs(M,{lines:"none",children:[e.jsxs(K,{className:"text-md font-semibold text-gray-900 dark:text-gray-300 mr-auto",children:["Card ",a+1]}),e.jsx(v,{fill:"clear",color:"danger",size:"small",onClick:()=>s.onRemoveCard(a),children:e.jsx(P,{slot:"icon-only",icon:fs})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(le,{label:"Front",labelPlacement:"stacked",value:t.Front,onIonInput:m=>s.onCardChange(a,"Front",m.detail.value),className:`w-full border rounded-md p-2 ${(n=s.cardErrors[a])!=null&&n.front?"border-red-500":"border-gray-300"}`,autoGrow:!0,rows:3}),((o=s.cardErrors[a])==null?void 0:o.front)&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.cardErrors[a].front})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(le,{label:"Back",labelPlacement:"stacked",value:t.Back,onIonInput:m=>s.onCardChange(a,"Back",m.detail.value),className:`w-full border rounded-md p-2 ${(i=s.cardErrors[a])!=null&&i.back?"border-red-500":"border-gray-300"}`,autoGrow:!0,rows:3}),((d=s.cardErrors[a])==null?void 0:d.back)&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.cardErrors[a].back})]})]})]},t.ID<=0?`new-${a}`:t.ID):e.jsx(F,{className:"mb-4 rounded-lg border shadow-sm",children:e.jsxs($,{children:[e.jsx("div",{className:"border-b border-gray-300 mb-3 pb-1 m-4",children:e.jsxs(K,{className:"text-md font-semibold text-gray-900 dark:text-gray-300",children:["Card ",a+1]})}),e.jsxs("div",{className:"flex flex-row justify-between items-start",children:[e.jsx("div",{className:"w-3/12 pr-4 border-r border-gray-300 m-4",children:e.jsx(K,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:t.Front})}),e.jsx("div",{className:"w-9/12 pl-4 m-4",children:e.jsx(K,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:t.Back})})]})]})},t.ID)}),s.isEditing&&s.isOwner&&e.jsxs(v,{expand:"block",fill:"outline",onClick:s.onAddCard,className:"mt-4 rounded-lg",children:[e.jsx(P,{slot:"start",icon:Je}),"Add New Card"]})]})}),ya=s=>e.jsxs(e.Fragment,{children:[s.isOwner&&!s.isEditing&&e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"rounded-lg flex-grow md:flex-grow-0",fill:"outline",style:{"--border-radius":"0.5rem"},onClick:s.onEditClick,children:"Edit Set & Cards"}),e.jsx(v,{className:"rounded-lg flex-grow md:flex-grow-0",color:"danger",style:{"--border-radius":"0.5rem"},onClick:s.onDeleteClick,children:"Delete Set"})]}),s.isOwner&&s.isEditing&&e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"rounded-lg flex-grow md:flex-grow-0",color:"primary",size:"small",onClick:s.onSaveClick,children:"Save All Changes"}),e.jsx(v,{className:"rounded-lg flex-grow md:flex-grow-0",color:"medium",size:"small",onClick:s.onCancelClick,children:"Cancel"})]}),e.jsx(v,{className:"rounded-lg flex-grow md:flex-grow-0",color:"primary",style:{"--border-radius":"0.5rem"},routerLink:s.studyLink,disabled:s.isEditing,children:"Study Set"})]}),wa=s=>e.jsxs("div",{className:"gap-4 flex-1 pr-4",children:[e.jsx("div",{className:"flex flex-col",children:s.loading||!s.flashcardSetData?e.jsx(B,{name:"dots"}):s.isEditing&&s.isOwner?e.jsxs(e.Fragment,{children:[e.jsx(se,{type:"text",label:"Set Name",name:"set_name",value:s.updatedInfo.set_name,onChange:s.onMetadataChange,error:s.metadataErrors.setName}),e.jsx(se,{type:"text",label:"Set Description",name:"set_description",value:s.updatedInfo.set_description,onChange:s.onMetadataChange,error:s.metadataErrors.setDescription}),s.metadataErrors.general&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.metadataErrors.general})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-3xl font-bold",children:s.flashcardSetData.SetName}),e.jsx("p",{className:"text-base mt-1 text-gray-700",children:s.flashcardSetData.SetDescription})]})}),e.jsxs(v,{className:"rounded-lg flex-grow md:flex-grow-0 mt-4",fill:"outline",style:{"--border-radius":"0.5rem"},onClick:s.onBackClick,disabled:s.isEditing,children:[e.jsx(P,{slot:"start",icon:Ne}),"Back"]})]}),va=()=>{const{id:s}=Ke(),t=ie(),[a]=Ge(),[n,o]=r.useState(),[i,d]=r.useState([]),[m,h]=r.useState([]),[l,c]=r.useState([]),[f,u]=r.useState(!0),[p,x]=r.useState(!1),[j,N]=r.useState(!1),[b,C]=r.useState(!1),[R,G]=r.useState({set_name:"",set_description:""}),[k,I]=r.useState({}),[ae,Q]=r.useState({}),Z=r.useCallback(async()=>{u(!0);try{const[g,y]=await Promise.all([w("/api/flashcards/sets/",{method:"GET",headers:{id:s}}),w("/api/flashcards/list",{method:"GET",headers:{set_id:s}})]);o(g),N(g.Role==="owner");const E=Array.isArray(y)?y:[];d(E),h(E)}catch(g){console.error("Failed to fetch data",g);let y="Unknown error";g instanceof Error&&(y=g.message),a({message:`Error loading data: ${y}`,duration:3e3,color:"danger"})}finally{u(!1)}},[s,a]);r.useEffect(()=>{Z()},[Z]);const A=()=>{n&&(G({set_name:n.SetName||"",set_description:n.SetDescription||""}),h([...i]),c(i.map(g=>({...g}))),C(!0),I({}),Q({}))},D=g=>{const{name:y}=g.target,E=g.detail.value??"";G(_=>({..._,[y]:E}))},U=(g,y,E)=>{const _=E??"";c(ee=>ee.map((S,q)=>q===g?{...S,[y]:_}:S))},te=()=>{if(!n)return;const g={ID:0-l.filter(y=>y.ID<=0).length-1,Front:"",Back:"",SetID:n.ID,CreatedAt:new Date().toISOString(),UpdatedAt:new Date().toISOString()};c(y=>[...y,g])},Ae=g=>{c(y=>y.filter((E,_)=>_!==g))},_e=()=>{const g={};let y=!0;const E=R.set_name.trim(),_=R.set_description.trim();return E||(g.setName="Set name is required",y=!1),_||(g.setDescription="Set description is required",y=!1),I(g),G({set_name:E,set_description:_}),y},Fe=()=>{const g={};let y=!0;return l.forEach((E,_)=>{const ee={},S=E.Front.trim(),q=E.Back.trim();S||(ee.front="Front cannot be empty",y=!1),q||(ee.back="Back cannot be empty",y=!1),Object.keys(ee).length>0&&(g[_]=ee),(S!==E.Front||q!==E.Back)&&c(qe=>qe.map((Ye,Ts)=>Ts===_?{...Ye,Front:S,Back:q}:Ye))}),Q(g),y},Le=async()=>{const g=_e(),y=Fe();if(!g||!y||!n){console.log("Form validation failed:",k,ae),a({message:"Please fix validation errors before saving.",duration:3e3,color:"warning"});return}u(!0);const E=[];R.set_name!==(n.SetName||"").trim()&&E.push(w("/api/flashcards/sets/set_name",{method:"PUT",headers:{id:s,set_name:R.set_name}})),R.set_description!==(n.SetDescription||"").trim()&&E.push(w("/api/flashcards/sets/set_description",{method:"PUT",headers:{id:s,set_description:R.set_description}}));const _=new Map(m.map(S=>[S.ID,S])),ee=new Map(l.map(S=>[S.ID,S]));m.forEach(S=>{!ee.has(S.ID)&&S.ID>0&&E.push(w("/api/flashcards",{method:"DELETE",headers:{id:S.ID}}))}),l.forEach(S=>{if(S.ID<=0)E.push(w("/api/flashcards",{method:"POST",headers:{front:S.Front,back:S.Back,set_id:n.ID}}));else{const q=_.get(S.ID);q&&(S.Front!==(q.Front||"").trim()&&E.push(w("/api/flashcards/front",{method:"PUT",headers:{id:S.ID,front:S.Front}})),S.Back!==(q.Back||"").trim()&&E.push(w("/api/flashcards/back",{method:"PUT",headers:{id:S.ID,back:S.Back}})))}});try{await Promise.all(E),a({message:"Set details and cards updated successfully!",duration:2e3,color:"success"}),C(!1),I({}),Q({}),await Z()}catch(S){console.error("Failed to update set:",S);let q="Unknown error during save";S instanceof Error&&(q=S.message),I(qe=>({...qe,general:`Failed to save: ${q}`})),a({message:`Failed to save changes: ${q}`,duration:3e3,color:"danger"})}finally{u(!1)}},Oe=()=>{C(!1),I({}),Q({})},Re=async()=>{if(!s){console.error("Cannot delete set: ID is missing."),a({message:"Cannot delete: Set ID missing.",duration:3e3,color:"danger"});return}try{await w("/api/flashcards/sets/",{method:"DELETE",headers:{id:s}}),a({message:"Set deleted successfully.",duration:2e3,color:"success"}),t.push("/student-dashboard")}catch(g){console.error("Failed to delete set:",g);let y="Unknown error during deletion";g instanceof Error&&(y=g.message),a({message:`Failed to delete set: ${y}`,duration:3e3,color:"danger"})}},ce=()=>{b||window.history.back()},fe=b?l:i;return e.jsxs(O,{className:"",children:[e.jsx(Y,{}),e.jsxs("div",{id:"main-content",className:"container max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4 mb-6",children:[e.jsx(wa,{loading:f,flashcardSetData:n,isEditing:b,isOwner:j,updatedInfo:R,metadataErrors:k,onMetadataChange:D,onBackClick:ce}),e.jsx(ya,{isOwner:j,isEditing:b,onBackClick:ce,onEditClick:A,onSaveClick:Le,onCancelClick:Oe,onDeleteClick:()=>x(!0),studyLink:`/flashcards/${s}`})]}),e.jsx(pa,{loading:f,cardsToDisplay:fe,isEditing:b,isOwner:j,cardErrors:ae,onCardChange:U,onAddCard:te,onRemoveCard:Ae,onAddCardClick:A})]}),e.jsx(ye,{isOpen:p,onDidDismiss:()=>x(!1),header:"Confirm Deletion",message:"Are you sure you want to delete this set? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary"},{text:"Delete",role:"destructive",handler:Re}]})]})},W=s=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium",children:[s.label,":"]}),e.jsx("span",{children:s.value})]}),Na=s=>{var t,a,n,o,i,d,m,h,l,c,f,u,p,x;return e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs(F,{className:"md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(z,{className:"p-6",children:e.jsx(V,{className:"text-xl font-rye font-semibold text-primary",children:"Account Information"})}),e.jsx($,{className:"p-6 pt-0",children:s.isEditing?e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{type:"text",label:"First Name",name:"first_name",value:((t=s.updatedInfo)==null?void 0:t.first_name)||"",error:s.errors.first_name,onChange:s.handleChange}),e.jsx(se,{type:"text",label:"Last Name",name:"last_name",value:((a=s.updatedInfo)==null?void 0:a.last_name)||"",error:s.errors.last_name,onChange:s.handleChange}),e.jsx(se,{type:"text",label:"Username",name:"username",value:((n=s.updatedInfo)==null?void 0:n.username)||"",error:s.errors.username,onChange:s.handleChange}),e.jsx(se,{type:"email",label:"Email",name:"email",value:((o=s.updatedInfo)==null?void 0:o.email)||"",error:s.errors.email,onChange:s.handleChange}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(v,{onClick:s.handleSave,children:"Save Changes"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{label:"First Name",value:(i=s.userInfo)==null?void 0:i.first_name}),e.jsx(W,{label:"Last Name",value:(d=s.userInfo)==null?void 0:d.last_name}),e.jsx(W,{label:"Username",value:(m=s.userInfo)==null?void 0:m.username}),e.jsx(W,{label:"Email",value:(h=s.userInfo)==null?void 0:h.email}),e.jsxs(v,{fill:"outline",onClick:s.handleEdit,className:"mt-4",children:[e.jsx(P,{slot:"start",icon:He}),"Edit Info"]})]})})]}),e.jsxs(F,{className:"md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(z,{className:"p-6",children:e.jsx(V,{className:"text-xl font-rye font-semibold text-primary",children:"Account Stats"})}),e.jsx($,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(W,{label:"Account Created",value:(l=s.userInfo)==null?void 0:l.created_at}),e.jsx(W,{label:"Login Streak",value:(c=s.userInfo)==null?void 0:c.login_streak}),e.jsx(W,{label:"Classes Taken",value:(f=s.userInfo)==null?void 0:f.numClasses}),e.jsx(W,{label:"Cards Mastered/Studied",value:`${(u=s.userInfo)==null?void 0:u.cardsMastered} / ${(p=s.userInfo)==null?void 0:p.cardsStudied}`}),e.jsx(W,{label:"Total Card Views",value:(x=s.userInfo)==null?void 0:x.totalCardViews})]})})]})]})},ss=256;function ba(s){const[t,a]=r.useState(0),{ref:n,inView:o}=mt({threshold:.7,triggerOnce:!0});return r.useEffect(()=>{if(o){const i=setTimeout(()=>a(t+1),1e3);t==s.streak-1&&clearTimeout(i)}},[t,s.streak,o]),e.jsxs(F,{className:"md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(z,{className:"p-6",children:e.jsx(V,{className:"text-xl font-rye font-semibold text-primary",children:"Login Streak"})}),e.jsxs($,{ref:n,className:"py-6 px-0 flex flex-row items-center justify-center gap-8",children:[e.jsx("img",{src:`/frame-${t}.png`,alt:"bonsai tree",width:ss,height:ss}),e.jsx("span",{className:"text-6xl px-4 font-rye font-extrabold text-[color:--ion-color-primary] tabular-nums",children:o&&e.jsx(ut,{start:0,end:s.streak,duration:6,useEasing:!1})})]})]})}const Ca=s=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 py-6",children:[e.jsx(ba,{streak:s.streak}),e.jsxs(F,{className:"md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(z,{className:"p-6",children:e.jsx(V,{className:"text-xl font-rye font-semibold text-primary",children:"Account Options"})}),e.jsx($,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(xt,{label:"Theme",value:s.theme,onIonChange:t=>s.setTheme(t.detail.value),interface:"popover",placeholder:"Select Theme",children:[e.jsx(We,{value:"light",children:"Light"}),e.jsx(We,{value:"dark",children:"Dark"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"mr-4",children:[e.jsx("h4",{className:"text-sm font-medium text-black dark:text-white",children:"Change Your Password"}),e.jsx("p",{className:"text-xs dark:text-gray-300",children:"Reset your account password."})]}),e.jsx(v,{color:"primary",onClick:()=>s.setShowPasswordAlert(!0),children:"Change Password"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"mr-4",children:[e.jsx("h4",{className:"text-sm font-medium text-black dark:text-white",children:"Delete Your Account"}),e.jsx("p",{className:"text-xs dark:text-gray-300",children:"This will delete all account data and can't be undone."})]}),e.jsx(v,{color:"danger",onClick:()=>s.setShowDeleteAlert(!0),children:"Delete Account"})]})]})})]})]}),e.jsx(ye,{isOpen:s.showPasswordAlert,onDidDismiss:()=>s.setShowPasswordAlert(!1),header:"Change Password",inputs:[{name:"oldPassword",type:"password",placeholder:"Old Password"},{name:"newPassword",type:"password",placeholder:"New Password"},{name:"confirmPassword",type:"password",placeholder:"Confirm New Password"}],buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Save",handler:t=>t.newPassword!==t.confirmPassword?(s.presentToast({message:"Passwords do not match",duration:2e3,color:"danger"}),!0):(console.log("Password changed"),!0)}]}),e.jsx(ye,{isOpen:s.showDeleteAlert,onDidDismiss:()=>s.setShowDeleteAlert(!1),header:"Confirm Deletion",message:"Are you sure you want to delete your account? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Delete",handler:()=>{console.log("Account deleted")}}]})]}),Sa=()=>{const{theme:s,setTheme:t}=Cs(),[a,n]=r.useState(),[o,i]=r.useState(!0),[d,m]=r.useState(null),[h,l]=r.useState(null),[c,f]=r.useState(!1),[u,p]=r.useState(!1),[x,j]=r.useState(!1),[N,b]=r.useState(a),C=A=>{l(h===A?null:A)},R=()=>{b(a),j(!0)},G=async()=>{if(!k())return;const A=["first_name","last_name","username","email"];try{const D=A.filter(U=>N[U]!==a[U]).map(U=>w(`/api/users/${U}`,{method:"PUT",headers:{[U]:N[U]}}));await Promise.all(D),n(N),j(!1)}catch(D){console.error(D),alert("Failed to update some fields. Please try again.")}},k=()=>{const A={};let D=!0;return N.first_name||(A.first_name="First name is required",D=!1),N.last_name||(A.last_name="Last name is required",D=!1),N.email?/\S+@\S+\.\S+/.test(N.email)||(A.email="Email is invalid",D=!1):(A.email="Email is required",D=!1),N.username||(A.username="Username is required",D=!1),N.first_name=N.first_name.trim(),N.last_name=N.last_name.trim(),N.email=N.email.trim(),N.username=N.username.trim(),ae(A),D},[I,ae]=r.useState({}),Q=A=>{const{name:D}=A.target,U=A.detail.value;b(te=>({...te,[D]:U}))};r.useEffect(()=>{(async()=>{i(!0),m(null);try{const D=await w("/api/users/",{method:"GET",headers:{}});n(D),b(D),console.log("data",D)}catch(D){console.log(`Failed to fetch User Data: ${D.message}`),m(`Failed to fetch User Data: ${D.message}`)}finally{i(!1)}})()},[]);const[Z]=Ge();return e.jsxs(O,{children:[e.jsx(Y,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("p",{className:"text-xl font-rye font-semibold text-primary",children:["Welcome back, ",(a==null?void 0:a.username)||"User","!"]})}),e.jsxs(v,{onClick:()=>window.history.back(),fill:"outline",className:"mb-6",children:[e.jsx(P,{slot:"start",icon:Ne}),"Back"]}),o&&e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(B,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading account details..."})]}),d&&!o&&e.jsx("div",{className:"text-red-500 text-center p-4 border border-red-500 rounded-md",children:d}),!o&&!d&&a&&e.jsxs(e.Fragment,{children:[e.jsx(Na,{isEditing:x,errors:I,handleChange:Q,handleSave:G,updatedInfo:N,userInfo:a,handleEdit:R}),e.jsx(Ca,{streak:(a==null?void 0:a.login_streak)??0,isEditing:x,errors:I,handleChange:Q,handleSave:G,updatedInfo:N,userInfo:a,expandedClass:h,toggleClassDetails:C,showPasswordAlert:c,setShowPasswordAlert:f,showDeleteAlert:u,setShowDeleteAlert:p,theme:s,setTheme:t,presentToast:Z})]})]})]})};ht();const ka=new ft;function Ia(){return e.jsx(gt,{client:ka,children:e.jsx(Bt,{children:e.jsxs(Mt,{children:[e.jsx(jt,{children:e.jsx(pt,{children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsxs(yt,{children:[e.jsx(L,{exact:!0,path:"/",component:ha}),e.jsx(L,{exact:!0,path:"/home",component:xa}),e.jsx(L,{exact:!0,path:"/class/:id",component:la}),e.jsx(L,{exact:!0,path:"/auth",component:js}),e.jsx(L,{exact:!0,path:"/reset-password",component:Ft}),e.jsx(L,{exact:!0,path:"/confirm-reset-password",component:_t}),e.jsx(L,{exact:!0,path:"/public-cards",component:ga}),e.jsx(L,{exact:!0,path:"/user-account",component:Sa}),e.jsx(L,{exact:!0,path:"/flashcards/:id",component:ua}),e.jsx(L,{exact:!0,path:"/create-set",component:ia}),e.jsx(L,{exact:!0,path:"/create-class",component:oa}),e.jsx(L,{exact:!0,path:"/public-classes",component:ja}),e.jsx(L,{exact:!0,path:"/set-overview/:id",component:va}),e.jsx(L,{component:fa})]})})})}),e.jsx(Ut,{}),e.jsx(Lt,{})]})})})}const Ea=document.getElementById("root"),Da=wt(Ea);Da.render(e.jsx(Ia,{}));export{Fa as _,Aa as c,_a as g};
//# sourceMappingURL=index-CqUntBf8.js.map
