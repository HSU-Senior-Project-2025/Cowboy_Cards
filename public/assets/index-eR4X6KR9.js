import{t as Qs,c as zs,r as l,j as e,a as _e,S as Vs,R as xs,u as hs,C as Ze,L as he,b as Gs,d as Ce,e as Se,I as U,f as _,g as Ys,h as Pe,i as ue,k as p,l as T,m as Hs,n as ne,o as Js,p as Xe,q as os,s as Ws,v as be,w as K,x as Xs,y as Zs,z as et,A as st,B as tt,D as at,E as rt,$ as nt,V as fs,F as gs,G as js,H as ys,X as ps,T as ws,J as vs,P as lt,K as Ns,M as ot,N as ee,O as M,Q as oe,U as de,W as it,Y as ct,Z as $,_ as dt,a0 as mt,a1 as xe,a2 as es,a3 as bs,a4 as ut,a5 as Fe,a6 as Cs,a7 as ve,a8 as Ss,a9 as xt,aa as ht,ab as ft,ac as gt,ad as jt,ae as q,af as H,ag as J,ah as Q,ai as yt,aj as ks,ak as Ae,al as ss,am as fe,an as Is,ao as pt,ap as wt,aq as vt,ar as Nt,as as bt,at as Le,au as Es,av as Ct,aw as St,ax as is,ay as kt,az as It,aA as Et,aB as Dt,aC as Tt,aD as Pt,aE as At,aF as R,aG as Lt}from"./nm-GYPCddrh.js";import"./index-eR4X6KR9.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();function er(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function E(...s){return Qs(zs(s))}const _t=_e("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),qe=l.forwardRef(({className:s,variant:a,...t},r)=>e.jsx("div",{ref:r,role:"alert",className:E(_t({variant:a}),s),...t}));qe.displayName="Alert";const Ft=l.forwardRef(({className:s,...a},t)=>e.jsx("h5",{ref:t,className:E("mb-1 font-medium leading-none tracking-tight",s),...a}));Ft.displayName="AlertTitle";const Oe=l.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:E("text-sm [&_p]:leading-relaxed",s),...a}));Oe.displayName="AlertDescription";const qt=_e("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),le=l.forwardRef(({className:s,variant:a,size:t,asChild:r=!1,...n},o)=>{const i=r?Vs:"button";return e.jsx(i,{className:E(qt({variant:a,size:t,className:s})),ref:o,...n})});le.displayName="Button";const ge=l.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:E("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a}));ge.displayName="Card";const Re=l.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:E("flex flex-col space-y-1.5 p-6",s),...a}));Re.displayName="CardHeader";const Ue=l.forwardRef(({className:s,...a},t)=>e.jsx("h3",{ref:t,className:E("text-2xl font-semibold leading-none tracking-tight",s),...a}));Ue.displayName="CardTitle";const Me=l.forwardRef(({className:s,...a},t)=>e.jsx("p",{ref:t,className:E("text-sm text-muted-foreground",s),...a}));Me.displayName="CardDescription";const $e=l.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:E("p-6 pt-0",s),...a}));$e.displayName="CardContent";const Be=l.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:E("flex items-center p-6 pt-0",s),...a}));Be.displayName="CardFooter";const G=l.forwardRef(({className:s,type:a,...t},r)=>e.jsx("input",{type:a,className:E("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...t}));G.displayName="Input";const Ot=_e("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Y=l.forwardRef(({className:s,...a},t)=>e.jsx(xs,{ref:t,className:E(Ot(),s),...a}));Y.displayName=xs.displayName;const Rt=1,Ut=1e6;let Je=0;function Mt(){return Je=(Je+1)%Number.MAX_SAFE_INTEGER,Je.toString()}const We=new Map,cs=s=>{if(We.has(s))return;const a=setTimeout(()=>{We.delete(s),Ne({type:"REMOVE_TOAST",toastId:s})},Ut);We.set(s,a)},$t=(s,a)=>{switch(a.type){case"ADD_TOAST":return{...s,toasts:[a.toast,...s.toasts].slice(0,Rt)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(t=>t.id===a.toast.id?{...t,...a.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=a;return t?cs(t):s.toasts.forEach(r=>{cs(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==a.toastId)}}},De=[];let Te={toasts:[]};function Ne(s){Te=$t(Te,s),De.forEach(a=>{a(Te)})}function Bt({...s}){const a=Mt(),t=n=>Ne({type:"UPDATE_TOAST",toast:{...n,id:a}}),r=()=>Ne({type:"DISMISS_TOAST",toastId:a});return Ne({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:n=>{n||r()}}}),{id:a,dismiss:r,update:t}}function Ke(){const[s,a]=l.useState(Te);return l.useEffect(()=>(De.push(a),()=>{const t=De.indexOf(a);t>-1&&De.splice(t,1)}),[s]),{...s,toast:Bt,dismiss:t=>Ne({type:"DISMISS_TOAST",toastId:t})}}const ds={method:"GET",headers:{},credentials:"include"},Kt="https://cowboy-cards.dsouth.org";async function v(s="",a=ds){const t={...ds,...a};try{const r=await fetch(Kt+s,t);if(!r.ok){const o=await r.text();throw new Error(`HTTP error! Status: ${r.status}, Message: ${o}`)}return r.status===204?null:await r.json()}catch(r){throw console.error("API request failed:",r),r}}const Qt="modulepreload",zt=function(s,a){return new URL(s,a).href},ms={},sr=function(a,t,r){let n=Promise.resolve();if(t&&t.length>0){const i=document.getElementsByTagName("link"),d=document.querySelector("meta[property=csp-nonce]"),m=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));n=Promise.allSettled(t.map(c=>{if(c=zt(c,r),c in ms)return;ms[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(!!r)for(let h=i.length-1;h>=0;h--){const j=i[h];if(j.href===c&&(!u||j.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${f}`))return;const y=document.createElement("link");if(y.rel=u?"stylesheet":Qt,u||(y.as="script"),y.crossOrigin="",y.href=c,m&&y.setAttribute("nonce",m),document.head.appendChild(y),u)return new Promise((h,j)=>{y.addEventListener("load",h),y.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i}return n.then(i=>{for(const d of i||[])d.status==="rejected"&&o(d.reason);return a().catch(o)})},Ds=()=>{const[s,a]=l.useState(!0),[t,r]=l.useState(!1),[n,o]=l.useState(""),[i,d]=l.useState(""),[m,c]=l.useState(""),[u,f]=l.useState(""),[g,y]=l.useState(""),[h,j]=l.useState(""),[x,N]=l.useState({}),C=hs(),{toast:z}=Ke(),se=()=>{const b={};let S=!0;return n?/\S+@\S+\.\S+/.test(n)||(b.email="Email is invalid",S=!1):(b.email="Email is required",S=!1),i?i.length<8&&(b.password="Password must be at least 8 characters",S=!1):(b.password="Password is required",S=!1),s||(m?m!==i&&(b.confirmPassword="Passwords do not match",S=!1):(b.confirmPassword="Confirm password is required",S=!1)),!s&&!u&&(b.username="Username is required",S=!1),N(b),S},B=async b=>{if(b.preventDefault(),!!se()){r(!0),N({});try{let S;s?S=await v("/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:n,password:i})}):S=await v("/signup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:u,email:n,password:i,first_name:g,last_name:h})}),z({duration:8e3,title:s?"Welcome back!":"Account created",description:s?"You have been successfully logged in.":"Your account has been created successfully."}),C.push("/home")}catch(S){N(S),Object.keys(x).length===0&&N({general:S.message||"An unexpected error occurred. Please try again."}),z({title:"Authentication failed",description:S.message||"Please check your credentials and try again.",variant:"destructive"})}finally{r(!1)}}},Z=()=>{N({}),s?(f(""),y(""),j("")):(o(""),d(""))};return e.jsxs(ge,{className:"w-11/12 max-w-[350px] mb-8",children:[e.jsxs(Re,{children:[e.jsx(Ue,{className:"text-4xl tracking-wide font-smokum font-bold",children:s?"Welcome back":"Create account"}),e.jsx(Me,{children:s?"Enter your credentials to continue":"Sign up for a new account"})]}),e.jsxs("form",{onSubmit:B,children:[e.jsxs($e,{className:"space-y-4",children:[x.general&&e.jsxs(qe,{variant:"destructive",className:"mb-4",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx(Oe,{children:x.general})]}),!s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"username",children:"Username"}),e.jsx(G,{id:"username",type:"text",placeholder:"johndoe",value:u,onChange:b=>f(b.target.value),required:!0,className:x.username?"border-red-500":""}),x.username&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"firstName",children:"First Name"}),e.jsx(G,{id:"firstName",type:"text",placeholder:"John",value:g,onChange:b=>y(b.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"lastName",children:"Last Name"}),e.jsx(G,{id:"lastName",type:"text",placeholder:"Doe",value:h,onChange:b=>j(b.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"email",children:"Email"}),e.jsx(G,{id:"email",type:"email",placeholder:"name@example.com",value:n,onChange:b=>o(b.target.value),required:!0,className:x.email?"border-red-500":""}),x.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"password",children:"Password"}),e.jsx(G,{id:"password",type:"password",value:i,onChange:b=>d(b.target.value),required:!0,className:x.password?"border-red-500":""}),x.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.password}),!s&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long"})]}),!s&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(G,{id:"confirmPassword",type:"password",value:m,onChange:b=>c(b.target.value),required:!0,className:x.confirmPassword?"border-red-500":""}),x.confirmPassword&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.confirmPassword})]}),s&&e.jsx(he,{to:"/reset-password",className:"text-sm text-primary",children:"Forgot password?"})]}),e.jsxs(Be,{className:"flex flex-col space-y-4",children:[e.jsxs(le,{type:"submit",className:"w-full",disabled:t,children:[e.jsx(Gs,{className:"mr-2 h-4 w-4"}),t?s?"Signing in...":"Signing up...":s?"Sign in":"Sign up"]}),e.jsx(le,{variant:"link",type:"button",onClick:()=>{a(!s),Z()},className:"text-sm",disabled:t,children:s?"Need an account? Sign up":"Already have an account? Sign in"})]})]})]})},Vt=()=>{var x;const a=((x=Ce().state)==null?void 0:x.email)||"",[t,r]=l.useState(""),[n,o]=l.useState(""),[i,d]=l.useState(""),[m,c]=l.useState(!1),[u,f]=l.useState({}),g=Se(),{toast:y}=Ke(),h=()=>{const N={};let C=!0;return i||(N.token="Reset token is required",C=!1),t?t.length<8&&(N.password="Password must be at least 8 characters",C=!1):(N.password="Password is required",C=!1),n?t!==n&&(N.confirmPassword="Passwords do not match",C=!1):(N.confirmPassword="Please confirm your password",C=!1),f({...u,...N}),C},j=async N=>{if(N.preventDefault(),!!h()){c(!0),f({});try{await v("/reset-password",{method:"POST",headers:{password:t,token:i,email:a}}),y({title:"Password reset successful",description:"Your password has been reset. You can now log in with your new password."}),g.push("/")}catch(C){C.message==="Invalid token"?f({token:"Invalid or expired token"}):f({general:C.message||"An error occurred during password reset. Please try again."}),y({title:"Password reset failed",description:C.message||"Please check your inputs and try again.",variant:"destructive"})}finally{c(!1)}}};return e.jsx(U,{children:e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs(ge,{className:"w-[350px]",children:[e.jsxs(Re,{children:[e.jsx(Ue,{children:"Reset Your Password"}),e.jsx(Me,{children:"Enter your new password and the reset token sent to your email"})]}),e.jsxs("form",{onSubmit:j,children:[e.jsxs($e,{className:"space-y-4",children:[u.general&&e.jsxs(qe,{variant:"destructive",className:"mb-4",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx(Oe,{children:u.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"token",children:"Reset Token"}),e.jsx(G,{id:"token",type:"text",placeholder:"Enter the token from your email",value:i,onChange:N=>d(N.target.value),required:!0,className:u.token?"border-red-500":""}),u.token&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.token})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"password",children:"New Password"}),e.jsx(G,{id:"password",type:"password",placeholder:"Enter your new password",value:t,onChange:N=>r(N.target.value),required:!0,className:u.password?"border-red-500":""}),u.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.password}),e.jsx("p",{className:"text-xs text-gray-500",children:"Password must be at least 8 characters long"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(G,{id:"confirmPassword",type:"password",placeholder:"Confirm your new password",value:n,onChange:N=>o(N.target.value),required:!0,className:u.confirmPassword?"border-red-500":""}),u.confirmPassword&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.confirmPassword})]})]}),e.jsx(Be,{className:"flex flex-col space-y-4",children:e.jsx(le,{type:"submit",className:"w-full",disabled:m,children:m?"Processing...":"Reset password"})})]})]})})})})},Gt=()=>{const[s,a]=l.useState(""),[t,r]=l.useState({}),[n,o]=l.useState(!1),{toast:i}=Ke(),d=Se(),m=()=>{const u={};let f=!0;return s?/\S+@\S+\.\S+/.test(s)||(u.email="Email is invalid",f=!1):(u.email="Email is required",f=!1),r(u),f},c=async u=>{if(u.preventDefault(),!!m()){o(!0),r({});try{await v("/send-reset-password-token",{method:"POST",headers:{email:s}}),i({title:"Reset token sent",description:"If the email exists in our system, a reset token has been sent to it."}),d.push("/confirm-reset-password",{email:s})}catch(f){let g="An unexpected error occurred. Please try again.";f.message&&(f.message.includes("Invalid email")?g="The provided email address is not registered.":f.message.includes("Database connection error")?g="Unable to connect to the server. Please try again later.":g=f.message),r({general:g})}finally{o(!1)}}};return e.jsx(U,{children:e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs(ge,{className:"w-11/12 max-w-[350px]",children:[e.jsxs(Re,{children:[e.jsx(Ue,{className:"text-4xl tracking-wide font-smokum font-bold",children:"Reset password"}),e.jsx(Me,{children:"Enter your email to reset your password"})]}),e.jsxs("form",{onSubmit:c,children:[e.jsxs($e,{className:"space-y-4",children:[t.general&&e.jsxs(qe,{variant:"destructive",className:"mb-4",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx(Oe,{children:t.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"text-3xl tracking-wide font-smokum font-bold",htmlFor:"email",children:"Email"}),e.jsx(G,{id:"email",type:"email",placeholder:"name@example.com",value:s,onChange:u=>a(u.target.value),required:!0,className:t.email?"border-red-500":""}),t.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:t.email})]})]}),e.jsx(Be,{className:"flex flex-col space-y-4",children:e.jsx(le,{type:"submit",className:"w-full",disabled:n,children:n?"Sending...":"Send reset token"})})]})]})})})})},W=()=>{const s=Ce();return s.pathname==="/"||s.pathname==="/reset-password"||s.pathname==="/confirm-reset-password"?null:e.jsx(Ys,{className:"hidden md:flex ion-no-border",children:e.jsxs(Pe,{children:[e.jsx(ue,{slot:"start",children:e.jsx(p,{children:e.jsx(he,{to:"/home",children:e.jsx(T,{icon:Hs})})})}),e.jsx(ne,{className:"mx-auto text-center text-sm",children:"©Cowboy Cards 2025. Built for learning and fun."})]})})},Ts=l.createContext(void 0);function Yt({children:s}){const[a,t]=l.useState(()=>localStorage.getItem("theme")||"light");return l.useEffect(()=>{localStorage.setItem("theme",a),a==="dark"?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},[a]),e.jsx(Ts.Provider,{value:{theme:a,setTheme:t},children:s})}function Ps(){const s=l.useContext(Ts);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s}const X=()=>{const[s,a]=l.useState(null),t=Ce(),r=hs(),{theme:n,setTheme:o}=Ps();if(t.pathname==="/"||t.pathname==="/reset-password"||t.pathname==="/confirm-reset-password")return null;const i=u=>a(u.nativeEvent),d=()=>a(null),m=u=>{var f;r.push(u),(f=document.querySelector("ion-menu"))==null||f.close()},c=()=>{o(n==="dark"?"light":"dark")};return e.jsxs(e.Fragment,{children:[e.jsxs(Js,{side:"start",contentId:"main-content",children:[e.jsx(Xe,{children:e.jsx(Pe,{children:e.jsx(ue,{slot:"start",children:e.jsx(os,{children:e.jsx(p,{children:e.jsx(T,{icon:Ws})})})})})}),e.jsx(_,{children:e.jsxs(be,{children:[e.jsx(K,{button:!0,onClick:()=>m("/home"),children:"My Dashboard"}),e.jsx(K,{button:!0,onClick:()=>m("/public-cards"),children:"Public Cards"}),e.jsx(K,{button:!0,onClick:()=>m("/public-classes"),children:"Public Classes"}),e.jsx(K,{button:!0,onClick:()=>m("/user-account"),children:"My Account"})]})})]}),e.jsx(Xe,{children:e.jsxs(Pe,{children:[e.jsx(ue,{slot:"start",children:e.jsx(os,{children:e.jsx(p,{children:e.jsx(T,{icon:Xs})})})}),e.jsxs("div",{className:"cursor-pointer",onClick:()=>r.push("/home"),children:[e.jsx("img",{src:"/Spirit-Cowboy-Profile-Only.png",alt:"Cowboy Cards Logo",className:"h-8 w-auto me:hidden block"}),e.jsx("h2",{className:"hidden me:block text-2xl sm:text-3xl md:text-4xl text-ellipsis overflow-hidden whitespace-nowrap font-ewert text-[color:--ion-color-primary]",children:"Cowboy Cards"})]}),e.jsxs(ue,{slot:"end",children:[e.jsx(p,{onClick:i,children:e.jsx(T,{icon:Zs,className:"text-[32px] stroke-[2]"})}),e.jsx(et,{event:s,isOpen:!!s,onDidDismiss:d,children:e.jsx(_,{children:e.jsxs(be,{children:[e.jsx(K,{button:!0,onClick:()=>{d(),r.push("/create-set")},children:"Create Set"}),e.jsx(K,{button:!0,onClick:()=>{d(),r.push("/create-class")},children:"Create Class"}),e.jsx(K,{button:!0,onClick:()=>{d(),r.push("/public-classes")},children:"Join Class"})]})})}),e.jsx(p,{fill:"clear",onClick:c,children:e.jsx(T,{slot:"icon-only",icon:n==="dark"?st:tt})})]}),e.jsx(ue,{slot:"end",children:e.jsx(p,{routerLink:"/user-account",children:e.jsx(T,{icon:at,size:"large"})})})]})})]})},Ht=({...s})=>{const{theme:a="system"}=rt();return e.jsx(nt,{theme:a,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},Jt=lt,As=l.forwardRef(({className:s,...a},t)=>e.jsx(fs,{ref:t,className:E("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a}));As.displayName=fs.displayName;const Wt=_e("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ls=l.forwardRef(({className:s,variant:a,...t},r)=>e.jsx(gs,{ref:r,className:E(Wt({variant:a}),s),...t}));Ls.displayName=gs.displayName;const Xt=l.forwardRef(({className:s,...a},t)=>e.jsx(js,{ref:t,className:E("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a}));Xt.displayName=js.displayName;const _s=l.forwardRef(({className:s,...a},t)=>e.jsx(ys,{ref:t,className:E("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:e.jsx(ps,{className:"h-4 w-4"})}));_s.displayName=ys.displayName;const Fs=l.forwardRef(({className:s,...a},t)=>e.jsx(ws,{ref:t,className:E("text-sm font-semibold",s),...a}));Fs.displayName=ws.displayName;const qs=l.forwardRef(({className:s,...a},t)=>e.jsx(vs,{ref:t,className:E("text-sm opacity-90",s),...a}));qs.displayName=vs.displayName;function Zt(){const{toasts:s}=Ke();return e.jsxs(Jt,{children:[s.map(function({id:a,title:t,description:r,action:n,...o}){return e.jsxs(Ls,{...o,children:[e.jsxs("div",{className:"grid gap-1",children:[t&&e.jsx(Fs,{children:t}),r&&e.jsx(qs,{children:r})]}),n,e.jsx(_s,{})]},a)}),e.jsx(As,{})]})}const ea=ot,sa=l.forwardRef(({className:s,sideOffset:a=4,...t},r)=>e.jsx(Ns,{ref:r,sideOffset:a,className:E("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t}));sa.displayName=Ns.displayName;function ta(s){return ee({queryKey:["class",s],queryFn:()=>v("/api/classes/",{method:"GET",headers:{id:s}}),staleTime:5*60*1e3})}function aa(s){return ee({queryKey:["classSets",s],queryFn:()=>v("/api/class_set/list_sets",{method:"GET",headers:{id:s}}),staleTime:5*60*1e3})}function ra(s){return ee({queryKey:["classMembers",s],queryFn:()=>v("/api/class_user/members",{method:"GET",headers:{class_id:s}}),staleTime:5*60*1e3})}function na(s){return ee({queryKey:["classLeaderboard",s],queryFn:()=>v("/api/classes/leaderboard",{method:"GET",headers:{id:s}}),staleTime:5*60*1e3})}function ts(){return ee({queryKey:["userSets"],queryFn:()=>v("/api/set_user/list"),staleTime:5*60*1e3})}function Os(){return ee({queryKey:["userClasses"],queryFn:()=>v("/api/class_user/classes"),staleTime:5*60*1e3})}function la(){const s=M();return oe({mutationFn:({id:a,field:t,value:r})=>v(`/api/classes/${t}`,{method:"PUT",headers:{id:a,[t]:r}}),onSuccess:(a,t)=>{s.invalidateQueries({queryKey:["class",t.id]}),s.invalidateQueries({queryKey:["userClasses"]})}})}function oa(s){const a=M();return oe({mutationFn:t=>v("/api/class_user/",{method:"DELETE",headers:{student_id:t,class_id:s}}),onSuccess:()=>{a.invalidateQueries({queryKey:["classMembers",s]}),a.invalidateQueries({queryKey:["classLeaderboard",s]}),a.invalidateQueries({queryKey:["userClasses"]})}})}function ia(){const s=M();return oe({mutationFn:({classId:a,setId:t})=>v("/api/class_set/",{method:"POST",headers:{class_id:a,set_id:t.toString()}}),onSuccess:(a,t)=>{s.invalidateQueries({queryKey:["classSets",t.classId]})}})}const ca=s=>{const[a,t]=l.useState(null),[r]=de(),{data:n=[],isLoading:o,error:i}=ts(),d=ia(),m=Array.isArray(n)?n.filter(g=>Array.isArray(s.existingSetIds)?!s.existingSetIds.includes(g.SetID):!0):[];l.useEffect(()=>{s.isOpen||t(null)},[s.isOpen]);const c=async()=>{if(!a||!s.classId){r({message:"Please select a set to add.",duration:2e3,color:"warning"});return}try{await d.mutateAsync({classId:s.classId,setId:a}),r({message:"Set added successfully!",duration:2e3,color:"success"}),s.onDidDismiss()}catch(g){const y=`Failed to add set: ${g instanceof Error?g.message:"Unknown error"}`;r({message:y,duration:3e3,color:"danger"})}},u=o||d.isPending,f=i||d.error;return e.jsxs(it,{isOpen:s.isOpen,onDidDismiss:s.onDidDismiss,children:[e.jsx(Xe,{children:e.jsxs(Pe,{children:[e.jsx(ct,{children:"Add Set to Class"}),e.jsx(ue,{slot:"end",children:e.jsx(p,{onClick:s.onDidDismiss,color:"medium",children:"Cancel"})})]})}),e.jsxs(_,{children:[u&&!(m!=null&&m.length)?e.jsxs("div",{className:"flex justify-center items-center h-full",children:[e.jsx($,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading your sets..."})]}):f?e.jsx(ne,{color:"danger",children:e.jsx("p",{children:f instanceof Error?f.message:String(f)})}):(m==null?void 0:m.length)===0?e.jsx("p",{className:"text-center text-gray-500 mt-4",children:"You have no available sets to add to this class. Create a new set or check if all your sets are already added."}):e.jsx(dt,{value:a,onIonChange:g=>{t(Number(g.detail.value))},children:e.jsx(be,{children:m==null?void 0:m.map(g=>e.jsxs(K,{children:[e.jsx(mt,{slot:"start",value:g.SetID},g.SetID),e.jsxs(xe,{children:[e.jsx("h2",{children:g.SetName}),e.jsx("p",{className:"text-sm text-gray-500",children:g.SetDescription})]})]},g.SetID))})}),f&&(m==null?void 0:m.length)>0&&e.jsx(ne,{color:"danger",className:"block mt-4",children:e.jsx("p",{children:f instanceof Error?f.message:String(f)})})]}),!u&&(m==null?void 0:m.length)>0&&e.jsx("div",{className:"ion-padding",children:e.jsx(p,{expand:"block",onClick:c,disabled:!a||d.isPending,className:"ion-margin-bottom",children:d.isPending?e.jsx($,{name:"dots"}):"Add Selected Set"})})]})},da=s=>e.jsxs("div",{className:"flex flex-col items-center sm:items-end justify-end mt-4",children:[s.isTeacher&&!s.isEditing&&e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"rounded-lg mt-2 sm:mt-2 sm:ml-2 w-full sm:w-auto max-w-80",style:{"--border-radius":"0.5rem"},onClick:s.handleEdit,children:"Edit Class"}),e.jsxs(p,{className:"rounded-lg sm:ml-0 w-full sm:w-auto max-w-80",style:{"--border-radius":"0.5rem"},onClick:s.onAddSetClick,color:"primary",disabled:!s.classId,children:[e.jsx(T,{slot:"start",icon:es}),"Add Existing Set"]}),e.jsxs(p,{className:"rounded-lg sm:ml-0 w-full sm:w-auto max-w-80",style:{"--border-radius":"0.5rem"},routerLink:`/create-set?classId=${s.classId}`,color:"primary",disabled:!s.classId,children:[e.jsx(T,{slot:"start",icon:bs}),"Create New Set"]})]}),s.isTeacher&&s.isEditing&&e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"rounded-lg mt-2 sm:mt-2 sm:ml-2 w-full sm:w-auto max-w-80",color:"primary",size:"small",onClick:s.handleSave,children:"Save All Changes"}),e.jsx(p,{className:"rounded-lg mt-2 sm:mt-2 sm:ml-2 w-full sm:w-auto max-w-80",color:"medium",size:"small",onClick:s.handleCancel,children:"Cancel"})]})]}),ce=s=>e.jsxs("div",{children:[e.jsx(K,{children:e.jsx(ut,{type:s.type,label:s.label,name:s.name,value:s.value,onIonChange:s.onChange})}),s.error&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.error})]}),ma=s=>e.jsx("div",{className:"gap-4 flex-1 sm:pr-4",children:e.jsx("div",{className:"flex flex-col",children:s.loading||!s.classData?e.jsx($,{name:"dots"}):s.isEditing&&s.isTeacher?e.jsxs(e.Fragment,{children:[e.jsx(ce,{type:"text",label:"Class Name",name:"class_name",value:s.updatedInfo.class_name,onChange:s.handleChange,error:s.formErrors.className}),e.jsx(ce,{type:"text",label:"Class Description",name:"class_description",value:s.updatedInfo.class_description,onChange:s.handleChange,error:s.formErrors.classDescription}),s.formErrors.general&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.formErrors.general})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-3xl font-bold",children:s.classData.ClassName||"Untitled Class"}),e.jsx("p",{className:"text-base mt-1 text-gray-700 dark:text-gray-400",children:s.classData.ClassDescription||"No description available"}),e.jsxs(p,{className:"rounded-lg mt-4 max-w-[200px]",style:{"--border-radius":"0.5rem"},routerLink:"/home",color:"primary",children:[e.jsx(T,{slot:"start",icon:Fe}),"Back"]})]})})}),ua=s=>e.jsxs(Cs,{value:s.selectedTab,onIonChange:a=>s.onTabChange(a.detail.value),className:"w-full mb-6",children:[e.jsxs(ve,{value:"flashcards",children:[e.jsx(T,{icon:Ss,className:"mr-2"}),e.jsx(xe,{children:"Flashcard Sets"})]}),e.jsxs(ve,{value:"leaderboard",children:[e.jsx(T,{icon:xt,className:"mr-2"}),e.jsx(xe,{children:"Leaderboard"})]}),e.jsxs(ve,{value:"students",children:[e.jsx(T,{icon:ht,className:"mr-2"}),e.jsx(xe,{children:"Students"})]})]}),xa=s=>{var n,o;const a=Se(),[t,r]=l.useState([]);return e.jsx("div",{className:"mt-6",children:s.loading?e.jsx("div",{children:"Loading..."}):(n=s.flashcardSets)!=null&&n.length?e.jsx(ft,{children:e.jsx(gt,{children:(o=s.flashcardSets.sort((i,d)=>i.ID-d.ID))==null?void 0:o.map(i=>e.jsx(jt,{size:"12",sizeMd:"6",sizeLg:"4",children:e.jsxs(q,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-200 rounded-lg border shadow-sm",onClick:()=>a.push(`/set-overview/${i.ID}`,{fromClassID:s.classID}),children:[e.jsx(H,{children:e.jsx(J,{className:"text-lg font-semibold",children:i.SetName})}),e.jsx(Q,{children:e.jsx("p",{className:"text-muted-foreground mb-2",children:i.SetDescription})})]})},i.ID))})}):e.jsx("p",{children:"No flashcard sets available. Create one or add an existing set to your class."})})},ha=s=>{var a;return e.jsxs(q,{className:"rounded-lg border shadow-sm",children:[e.jsx(H,{children:e.jsx(J,{className:"text-xl font-semibold",children:"Class Leaderboard"})}),e.jsx(Q,{children:e.jsx(be,{className:"max-h-96 overflow-y-auto space-y-3",lines:"none",children:s.leaderboard===null?e.jsx("h1",{className:"text-center text-gray-500",children:"No scores available"}):(a=s.leaderboard)==null?void 0:a.map((t,r)=>e.jsx(yt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:r*.1},children:e.jsxs(K,{className:"muted-item py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r===0&&e.jsx("span",{className:"text-yellow-500 text-xl",children:"🥇"}),r===1&&e.jsx("span",{className:"text-gray-400 text-xl",children:"🥈"}),r===2&&e.jsx("span",{className:"text-orange-500 text-xl",children:"🥉"}),e.jsx("span",{className:"font-medium text-lg",children:t.Username})]}),e.jsxs("span",{slot:"end",className:"text-primary font-semibold ml-2",children:[t.ClassScore," points"]})]})},t.UserID))})})]})},fa=s=>e.jsx(e.Fragment,{children:s.loadingScores?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx($,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Calculating scores..."})]}):e.jsx(ha,{leaderboard:s.leaderboardData})}),ga=s=>{var a;return e.jsxs(q,{className:"mt-6",children:[e.jsx(H,{children:e.jsx(J,{className:"text-xl font-semibold",children:"Class Students"})}),e.jsx(Q,{children:e.jsx(be,{className:"space-y-3",lines:"none",children:(a=s.students)==null?void 0:a.map(t=>e.jsxs(K,{className:"muted-item py-3",children:[e.jsx("span",{className:"font-medium",children:t.Username}),s.isTeacher&&e.jsx(T,{slot:"end",icon:ks,color:"danger",className:"cursor-pointer",onClick:()=>s.onDeleteStudent(t.UserID)})]},t.UserID))})})]})},ja=s=>{const[a,t]=l.useState({isOpen:!1,studentId:null}),r=n=>{t({isOpen:!0,studentId:n})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(ga,{isTeacher:s.isTeacher,students:s.students,onDeleteStudent:r})}),e.jsx(Ae,{isOpen:a.isOpen,onDidDismiss:()=>t({isOpen:!1,studentId:null}),header:"Confirm Deletion",message:"Are you sure you want to remove this student from the class? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{}},{text:"Delete",handler:()=>{a.studentId!==null&&s.handleActualDelete(a.studentId)}}]})]})},ya=()=>{const{id:s}=ss(),[a,t]=l.useState(0),[r,n]=l.useState(),[o,i]=l.useState("flashcards"),[d]=de(),[m,c]=l.useState(!1),[u,f]=l.useState({class_name:"",class_description:""}),[g,y]=l.useState(!1),[h,j]=l.useState({}),{data:x,isLoading:N,error:C}=ta(s),{data:z=[],isLoading:se,error:B}=aa(s),{data:Z=[],isLoading:b,error:S}=ra(s),{data:V=[],isLoading:te,error:k}=na(s),P=la(),ae=oa(s),A=(x==null?void 0:x.Role)==="teacher",je=()=>{f({class_name:(x==null?void 0:x.ClassName)||"",class_description:(x==null?void 0:x.ClassDescription)||""}),c(!0)},ye=()=>{const O={};let ie=!0;return u.class_name=u.class_name.trim(),u.class_description=u.class_description.trim(),u.class_name||(O.className="Class name is required",ie=!1),u.class_description||(O.classDescription="Class description is required",ie=!1),j(O),ie},pe=async()=>{if(ye())try{await Promise.all([P.mutateAsync({id:s,field:"class_name",value:u.class_name}),P.mutateAsync({id:s,field:"class_description",value:u.class_description})]),c(!1)}catch{d({message:"Failed to update some fields. Please try again.",duration:4e3,color:"danger"})}},ke=O=>{const{name:ie}=O.target,Ge=O.detail.value;f(Ye=>({...Ye,[ie]:Ge}))},ze=()=>{c(!1)},Ve=async O=>{if(O!==null)try{await ae.mutateAsync(O)}catch{d({message:"Error deleting student",duration:4e3,color:"danger"})}};l.useEffect(()=>{r&&r.on("select",()=>{t(r.selectedScrollSnap())})},[r]);const Ie=N||se||b||te,Ee=C||B||S||k;return e.jsxs(U,{children:[e.jsx(X,{}),e.jsxs(_,{children:[e.jsxs("div",{className:"container max-w-4xl mx-auto px-4 py-8",children:[Ee&&e.jsx("div",{className:"text-red-500",children:Ee.message}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx(ma,{loading:Ie,classData:x,isEditing:m,isTeacher:A,updatedInfo:u,formErrors:h,handleChange:ke}),e.jsx(da,{isTeacher:A,isEditing:m,handleEdit:je,handleSave:pe,handleCancel:ze,classId:s,onAddSetClick:()=>y(!0)})]}),e.jsx(ua,{selectedTab:o,onTabChange:i}),o==="leaderboard"&&e.jsx(fa,{leaderboardData:V,loadingScores:te}),o==="flashcards"&&e.jsx(xa,{flashcardSets:z,currentCardIndex:a,setApi:n,loading:Ie,classId:s}),o==="students"&&e.jsx(ja,{isTeacher:A,students:Z,handleActualDelete:Ve})]}),e.jsx(ca,{isOpen:g,onDidDismiss:()=>y(!1),classId:s,existingSetIds:(z==null?void 0:z.map(O=>O.ID))||[]})]}),e.jsx(W,{})]})},pa=()=>{const s=M(),[a,t]=l.useState(!1),[r,n]=l.useState(null),[o,i]=l.useState({className:"",description:""}),[d,m]=l.useState(!1),c=async()=>{if(!a){t(!0),n(null);try{const u=await v("/api/classes",{method:"POST",headers:{class_name:o.className,class_description:o.description}});i({className:"",description:""}),m(!0),s.invalidateQueries({queryKey:["userClasses"]})}catch(u){n(`Failed to create class: ${u.message}`)}finally{t(!1)}}};return e.jsxs(U,{children:[e.jsx(X,{}),e.jsx(_,{children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[a&&e.jsx("div",{children:"Loading..."}),r&&e.jsx("div",{className:"text-red-500 mt-2",children:r}),e.jsx("h1",{className:"text-4xl tracking-wide font-bold font-smokum mb-6",children:"Create New Class"}),e.jsxs("form",{children:[e.jsx(q,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(Q,{children:[e.jsx(fe,{placeholder:"Enter Class Name",value:o.className,onIonChange:u=>i(f=>({...f,className:u.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),e.jsx(fe,{placeholder:"Enter Class Description",value:o.description,onIonChange:u=>i(f=>({...f,description:u.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(p,{color:"primary",className:"rounded-lg shadow-sm w-full md:w-auto",onClick:c,disabled:a,children:a?"Creating...":"Create Class"})})]}),d&&e.jsx(Is,{isOpen:d,color:"success",onDidDismiss:()=>m(!1),message:"Class created successfully!",duration:2e3})]})}),e.jsx(W,{})]})},wa=()=>{const s=M();Se();const[a,t]=l.useState(""),[r,n]=l.useState(""),[o,i]=l.useState({title:"",description:""}),[d,m]=l.useState(!1),[c,u]=l.useState(null),[f,g]=l.useState(!1),y=async()=>{if(d)return;m(!0),u(null);const h={title:"",description:""};let j=!1;if(a.trim()||(h.title="Title is required",j=!0),r.trim()||(h.description="Description is required",j=!0),i(h),j){m(!1);return}try{const x=await v("/api/flashcards/sets",{method:"POST",headers:{set_name:a,set_description:r}});t(""),n(""),g(!0),s.invalidateQueries({queryKey:["userSets"]})}catch(x){u(`Failed to save flashcard set: ${x.message}`)}finally{m(!1)}};return e.jsxs(U,{children:[e.jsx(X,{}),e.jsx(_,{children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[d&&e.jsx("div",{children:"Loading..."}),c&&e.jsx("div",{className:"text-red-500 mt-2",children:c}),e.jsx("h1",{className:"text-4xl tracking-wide font-bold font-smokum mb-6",children:"Create New Flashcard Set"}),e.jsx(q,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(Q,{children:[e.jsx(fe,{placeholder:"Enter Set Title",value:a,onIonChange:h=>t(h.detail.value),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),o.title&&e.jsx(ne,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:o.title})}),e.jsx(fe,{placeholder:"Enter Set Description",value:r,onIonChange:h=>n(h.detail.value),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}}),o.description&&e.jsx(ne,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:o.description})})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(p,{color:"primary",className:"rounded-lg shadow-sm w-full md:w-auto",onClick:y,disabled:d,children:d?"Creating...":"Create Set"})}),f&&e.jsx(Is,{isOpen:f,color:"success",onDidDismiss:()=>g(!1),message:"Set created successfully!",duration:2e3})]})}),e.jsx(W,{})]})};function va(s){return ee({queryKey:["flashcardSet",s],queryFn:()=>v("/api/flashcards/sets/",{method:"GET",headers:{id:s}}),staleTime:5*60*1e3})}function Na(s){return ee({queryKey:["flashcardCards",s],queryFn:()=>v("/api/flashcards/list",{method:"GET",headers:{set_id:s}}),staleTime:5*60*1e3})}function ba(){const s=M();return oe({mutationFn:({cardId:a,isCorrect:t,setId:r})=>v(t?"/api/card_history/correct":"/api/card_history/incorrect",{method:"POST",headers:{card_id:a.toString(),set_id:r.toString()}}),onSuccess:()=>{s.invalidateQueries({queryKey:["userSets"]}),s.invalidateQueries({queryKey:["classLeaderboard"]})}})}const Ca=s=>{const[a,t]=l.useState(!1),r=ba(),[n,o]=l.useState(null),i=s.setId,d=async(u,f)=>{var g;try{await r.mutateAsync({cardId:s.cardId,isCorrect:u,setId:f}),(g=s.onAdvance)==null||g.call(s)}catch(y){o(y)}},m=()=>{d(!1,i)},c=()=>{d(!0,i)};return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[n&&e.jsxs("div",{className:"text-red-500",children:["Error: ",n.message]}),e.jsxs("div",{className:`flip-card cursor-pointer ${a?"flipped":""}`,onClick:()=>t(!a),children:[e.jsx(ge,{className:"flip-card-front p-8 min-h-[300px] flex items-center justify-center text-center",children:e.jsx("p",{className:"text-xl",children:s.front})}),e.jsx(ge,{className:"flip-card-back p-8 min-h-[300px] flex items-center justify-center text-center absolute top-0 w-full",children:e.jsx("p",{className:"text-xl",children:s.back})})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsxs(le,{variant:"outline",id:"shadcn-button",className:"w-32",onClick:m,children:[e.jsx(ps,{className:"mr-2 h-4 w-4"}),"Not yet"]}),e.jsxs(le,{id:"shadcn-button",className:"w-32",onClick:c,children:[e.jsx(pt,{className:"mr-2 h-4 w-4"}),"Got it"]})]})]})},Rs=l.createContext(null);function Qe(){const s=l.useContext(Rs);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const Us=l.forwardRef(({orientation:s="horizontal",opts:a,setApi:t,plugins:r,className:n,children:o,...i},d)=>{const[m,c]=wt({...a,axis:s==="horizontal"?"x":"y"},r),[u,f]=l.useState(!1),[g,y]=l.useState(!1),h=l.useCallback(C=>{C&&(f(C.canScrollPrev()),y(C.canScrollNext()))},[]),j=l.useCallback(()=>{c==null||c.scrollPrev()},[c]),x=l.useCallback(()=>{c==null||c.scrollNext()},[c]),N=l.useCallback(C=>{C.key==="ArrowLeft"?(C.preventDefault(),j()):C.key==="ArrowRight"&&(C.preventDefault(),x())},[j,x]);return l.useEffect(()=>{!c||!t||t(c)},[c,t]),l.useEffect(()=>{if(c)return h(c),c.on("reInit",h),c.on("select",h),()=>{c==null||c.off("select",h)}},[c,h]),e.jsx(Rs.Provider,{value:{carouselRef:m,api:c,opts:a,orientation:s||((a==null?void 0:a.axis)==="y"?"vertical":"horizontal"),scrollPrev:j,scrollNext:x,canScrollPrev:u,canScrollNext:g},children:e.jsx("div",{ref:d,onKeyDownCapture:N,className:E("relative",n),role:"region","aria-roledescription":"carousel",...i,children:o})})});Us.displayName="Carousel";const Ms=l.forwardRef(({className:s,...a},t)=>{const{carouselRef:r,orientation:n}=Qe();return e.jsx("div",{ref:r,className:"overflow-hidden",children:e.jsx("div",{ref:t,className:E("flex",n==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...a})})});Ms.displayName="CarouselContent";const $s=l.forwardRef(({className:s,...a},t)=>{const{orientation:r}=Qe();return e.jsx("div",{ref:t,role:"group","aria-roledescription":"slide",className:E("min-w-0 shrink-0 grow-0 basis-full",r==="horizontal"?"pl-4":"pt-4",s),...a})});$s.displayName="CarouselItem";const Sa=l.forwardRef(({className:s,variant:a="outline",size:t="icon",...r},n)=>{const{orientation:o,scrollPrev:i,canScrollPrev:d}=Qe();return e.jsxs(le,{ref:n,variant:a,size:t,className:E("absolute  h-8 w-8 rounded-full",o==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!d,onClick:i,...r,children:[e.jsx(vt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});Sa.displayName="CarouselPrevious";const ka=l.forwardRef(({className:s,variant:a="outline",size:t="icon",...r},n)=>{const{orientation:o,scrollNext:i,canScrollNext:d}=Qe();return e.jsxs(le,{ref:n,variant:a,size:t,className:E("absolute h-8 w-8 rounded-full",o==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!d,onClick:i,...r,children:[e.jsx(Nt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});ka.displayName="CarouselNext";const Ia=()=>{const{id:s}=ss(),[a]=de(),[t,r]=l.useState(),[n,o]=l.useState(0),{data:i,isLoading:d,error:m}=va(s),{data:c=[],isLoading:u,error:f}=Na(s),g=d||u,y=m||f;if(y){let x="Unknown error";y instanceof Error&&(x=y.message),a({message:`Error loading data: ${x}`,duration:3e3,color:"danger"})}l.useEffect(()=>{if(!t)return;const x=()=>{o(t.selectedScrollSnap())};return x(),t.on("select",x),t.on("reInit",x),()=>{t.off("select",x),t.off("reInit",x)}},[t]);const h=()=>{t&&c.length>0&&(n===c.length-1?a({message:"Congratulations! You have completed the set.",duration:3e3,color:"success"}):t.scrollNext())},j=c.length?Math.round((n+1)/c.length*100):0;return e.jsxs(U,{children:[e.jsx(X,{}),e.jsx(_,{children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(p,{className:"rounded-lg",style:{"--border-radius":"0.5rem"},routerLink:`/set-overview/${s}`,children:[e.jsx(T,{slot:"start",icon:Fe}),"Back"]}),e.jsx("div",{children:g?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx($,{name:"dots"}),e.jsx($,{name:"dots"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl font-bold",children:i==null?void 0:i.SetName}),e.jsx("p",{className:"text-gray-500",children:i==null?void 0:i.SetDescription})]})})]}),e.jsx("div",{className:"w-full max-w-xl mx-auto relative py-8 min-h-[400px] flex flex-col items-center justify-center",children:g?e.jsx($,{name:"circular"}):c.length===0?e.jsx("div",{className:"text-center text-gray-500 text-lg py-20",children:"This set has no cards."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full mb-4 bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:e.jsx("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-300",style:{width:`${j}%`}})}),e.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:["Card ",n+1," of ",c.length]}),e.jsx(Us,{orientation:"vertical",setApi:r,className:"w-full",children:e.jsx(Ms,{className:"-mt-1 h-[400px]",children:c==null?void 0:c.map((x,N)=>e.jsx($s,{children:e.jsx(Ca,{front:x.Front,back:x.Back,onAdvance:h,cardId:x.ID,setId:s})},N))})})]})})]})}),e.jsx(W,{})]})},Ea=()=>{const[s,a]=l.useState("classes"),{data:t=[],isLoading:r,error:n}=Os(),{data:o,isLoading:i,error:d}=ts(),m=n||d;return e.jsxs(U,{children:[e.jsx(X,{}),e.jsx(_,{children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 flex-grow",children:[m&&e.jsx("div",{className:"text-red-500 mt-2",children:m.message}),e.jsxs("div",{className:"flex flex-col me:flex-row me:justify-between me:items-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-smokum font-bold",children:s==="classes"?"My Classes":"My Flashcard Sets"}),e.jsx("div",{className:"flex items-center gap-2 mt-4 me:mt-0",children:e.jsxs(p,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},routerLink:s==="classes"?"/public-classes":"/public-cards",children:[e.jsx(T,{slot:"start",icon:es})," ",s==="classes"?"Join Class":"Join Set"]})})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(Cs,{value:s,onIonChange:c=>a(c.detail.value||"classes"),style:{"--background":"var(--ion-color-light)"},children:[e.jsxs(ve,{value:"classes",children:[e.jsx(T,{icon:bt,className:"mr-2"}),e.jsx(xe,{children:"My Classes"})]}),e.jsxs(ve,{value:"flashcards",children:[e.jsx(T,{icon:Ss,className:"mr-2"}),e.jsx(xe,{children:"My Cards"})]})]})}),s==="classes"&&e.jsx(e.Fragment,{children:r?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx($,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading classes..."})]}):t===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any classes. Join a class to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t==null?void 0:t.map(c=>e.jsx(he,{to:`/class/${c.ClassID}`,children:e.jsxs(q,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(H,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(J,{className:"text-2xl font-semibold leading-none tracking-tight",children:c.ClassName}),e.jsx(Le,{className:"text-sm text-muted-foreground",children:c.ClassDescription})]}),e.jsx(Q,{})]})},c.ClassID))})}),s==="flashcards"&&e.jsx(e.Fragment,{children:i?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx($,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading sets..."})]}):o===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any sets. Join a set to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:o==null?void 0:o.map(c=>e.jsx(he,{to:`/set-overview/${c.SetID}`,children:e.jsxs(q,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(H,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(J,{className:"text-2xl font-semibold leading-none tracking-tight",children:c.SetName}),e.jsx(Le,{className:"text-sm text-muted-foreground",children:c.SetDescription})]}),e.jsx(Q,{})]})},c.SetID))})})]})}),e.jsx(W,{})]})},Da=()=>e.jsx(U,{children:e.jsx(_,{children:e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center from-white to-gray-50",children:[e.jsxs("div",{className:"text-center mb-8 sm:mb-12 md:mb-16 mt-6 sm:mt-10 md:mt-14 mx-2",children:[e.jsx("h1",{className:"text-5xl sm:text-6xl md:text-7xl text-primary mb-4 font-ewert",children:"Cowboy Cards"}),e.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-rye",children:"Master any subject with smart flashcards"})]}),e.jsx(Ds,{})]})})}),Ta=()=>(Ce(),e.jsx(U,{children:e.jsx(_,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/home",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})})})),Pa=()=>{const s=M(),[a,t]=l.useState(null),[r,n]=l.useState(!1),[o,i]=l.useState([]),[d,m]=l.useState(""),[c]=de(),{data:u,isLoading:f}=ts(),g=o.filter(h=>h.SetName.toLowerCase().includes(d.toLowerCase())||h.SetDescription&&h.SetDescription.toLowerCase().includes(d.toLowerCase()));l.useEffect(()=>{async function h(){n(!0),t(null);try{const j=await v("/api/flashcards/sets/list");i(j)}catch(j){t(`Error fetching flashcard sets: ${j.message}`)}finally{n(!1)}}h()},[]);const y=h=>u?u.some(j=>j.SetID===h):!1;return e.jsxs(U,{children:[e.jsx(X,{}),e.jsx(_,{children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-0 py-8 w-4/5",children:[e.jsxs("div",{className:"flex items-center flex-col justify-between mb-4",children:[e.jsx("h1",{className:"text-4xl tracking-wide font-bold font-smokum pb-8",children:"Public Flashcard Sets"}),r||f&&e.jsx("div",{children:"Loading..."}),a&&e.jsx("div",{className:"text-red-500 mt-2",children:a}),e.jsx(Es,{value:d,onIonInput:h=>m(h.target.value),placeholder:"Search flashcard sets",className:"mb-4 max-w-lg"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:g==null?void 0:g.map(h=>!y(h.ID)&&e.jsx(he,{to:`/set-overview/${h.ID}`,children:e.jsx(q,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(H,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(J,{className:"text-2xl font-semibold leading-none tracking-tight",children:h.SetName}),e.jsx(Le,{className:"text-sm ",children:h.SetDescription||"No description"}),e.jsx(p,{expand:"block",color:"primary",className:"mt-4",onClick:async j=>{try{const x=await v("/api/set_user",{method:"POST",headers:{set_id:h.ID,role:"user"}});c({message:"Successfully joined set",duration:2e3,color:"success"}),s.invalidateQueries({queryKey:["userSets"]})}catch(x){t(`Error joining set: ${x.message}`)}},children:"Join Set"})]})})},h.ID))})]})}),e.jsx(W,{})]})},Aa=()=>{const s=M(),[a,t]=l.useState([]),[r,n]=l.useState(!1),[o,i]=l.useState(null),[d,m]=l.useState(""),[c]=de(),{data:u,isLoading:f}=Os(),g=h=>u?u.some(j=>j.ClassID===h):!1,y=a.filter(h=>h.ClassName.toLowerCase().includes(d.toLowerCase())||h.ClassDescription&&h.ClassDescription.toLowerCase().includes(d.toLowerCase()));return l.useEffect(()=>{(async()=>{n(!0),i(null);try{const j=await v("/api/classes/list");t(j)}catch(j){i(`Error fetching classes: ${j.message}`)}finally{n(!1)}})()},[]),e.jsxs(U,{children:[e.jsx(X,{}),e.jsx(_,{children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-0 py-8 w-4/5",children:[e.jsxs("div",{className:"flex items-center flex-col justify-between mb-4",children:[e.jsx("h1",{className:"text-4xl tracking-wide font-bold font-smokum pb-8",children:"Public Classes"}),(r||f)&&e.jsx("div",{children:"Loading..."}),o&&e.jsx("div",{className:"text-red-500 mt-2",children:o}),e.jsx(Es,{value:d,onIonInput:h=>m(h.target.value),placeholder:"Search classes",className:"mb-4 max-w-lg"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:y==null?void 0:y.map(h=>!g(h.ID)&&e.jsx(he,{to:`/class/${h.ID}`,children:e.jsx(q,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(H,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(J,{className:"text-2xl font-semibold leading-none tracking-tight",children:h.ClassName}),e.jsx(Le,{className:"text-sm ",children:h.ClassDescription||"No description"}),e.jsx(p,{expand:"block",color:"primary",className:"mt-4",onClick:async()=>{try{const j=await v("/api/class_user",{method:"POST",headers:{class_id:h.ID,role:"student"}});c({message:"Successfully joined class",duration:2e3,color:"success"}),s.invalidateQueries({queryKey:["userClasses"]}),s.invalidateQueries({queryKey:["classMembers"]})}catch(j){i(`Error joining class: ${j.message}`)}},children:"Join Class"})]})})},h.ID))})]})}),e.jsx(W,{})]})},La=s=>{var t;const a=Array.isArray(s.cardsToDisplay)&&s.cardsToDisplay.length>0;return e.jsx("div",{className:"mt-8 min-h-[200px]",children:s.loading?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx($,{name:"circular"})}):!a&&!s.isEditing?e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-900 dark:text-gray-400 mb-4",children:"This set has no cards."}),s.isOwner&&e.jsx(p,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},onClick:s.onAddCardClick,children:"Add Cards"})]}):e.jsxs("div",{className:"w-full",children:[(t=s.cardsToDisplay)==null?void 0:t.map((r,n)=>{var o,i,d,m;return s.isEditing&&s.isOwner?e.jsxs(q,{className:"mb-4 rounded-lg border shadow-sm p-4",children:[e.jsxs(K,{lines:"none",children:[e.jsxs(ne,{className:"text-md font-semibold text-gray-900 dark:text-gray-300 mr-auto",children:["Card ",n+1]}),e.jsx(p,{fill:"clear",color:"danger",size:"small",onClick:()=>s.onRemoveCard(n),children:e.jsx(T,{slot:"icon-only",icon:ks})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mt-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(fe,{label:"Front",labelPlacement:"stacked",value:r.Front,onIonInput:c=>s.onCardChange(n,"Front",c.detail.value),className:`w-full border rounded-md p-2 ${(o=s.cardErrors[n])!=null&&o.front?"border-red-500":"border-gray-300"}`,autoGrow:!0,rows:3}),((i=s.cardErrors[n])==null?void 0:i.front)&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.cardErrors[n].front})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(fe,{label:"Back",labelPlacement:"stacked",value:r.Back,onIonInput:c=>s.onCardChange(n,"Back",c.detail.value),className:`w-full border rounded-md p-2 ${(d=s.cardErrors[n])!=null&&d.back?"border-red-500":"border-gray-300"}`,autoGrow:!0,rows:3}),((m=s.cardErrors[n])==null?void 0:m.back)&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.cardErrors[n].back})]})]})]},r.ID<=0?`new-${n}`:r.ID):e.jsx(q,{className:"mb-4 rounded-lg border shadow-sm",children:e.jsxs(Q,{children:[e.jsx("div",{className:"border-b border-gray-300 mb-3 pb-1 m-4",children:e.jsxs(ne,{className:"text-md font-semibold text-gray-900 dark:text-gray-300",children:["Card ",n+1]})}),e.jsxs("div",{className:"flex flex-row justify-between items-start",children:[e.jsx("div",{className:"w-3/12 pr-4 border-r border-gray-300 m-4",children:e.jsx(ne,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:r.Front})}),e.jsx("div",{className:"w-9/12 pl-4 m-4",children:e.jsx(ne,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:r.Back})})]})]})},r.ID)}),s.isEditing&&s.isOwner&&e.jsxs(p,{expand:"block",onClick:s.onAddCard,className:"mt-4 rounded-lg",children:[e.jsx(T,{slot:"start",icon:es}),"Add New Card"]})]})})},_a=s=>{const a=Array.isArray(s.cardsToDisplay)&&s.cardsToDisplay.length>0;return e.jsxs("div",{className:"flex flex-col items-center sm:items-end justify-end mt-4",children:[a&&e.jsx(p,{className:"rounded-lg sm:ml-0 w-full sm:w-auto max-w-80",color:"primary",style:{"--border-radius":"0.5rem"},routerLink:s.studyLink,disabled:s.isEditing,children:"Study Set"}),s.isOwner&&!s.isEditing&&e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"rounded-lg mt-2 sm:mt-2 sm:ml-2 w-full sm:w-auto max-w-80",style:{"--border-radius":"0.5rem"},onClick:s.onEditClick,children:"Edit Set & Cards"}),e.jsx(p,{className:"rounded-lg mt-2 sm:mt-2 sm:ml-2 w-full sm:w-auto max-w-80",color:"danger",style:{"--border-radius":"0.5rem"},onClick:s.onDeleteClick,children:"Delete Set"})]}),s.isOwner&&s.isEditing&&e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"rounded-lg mt-2 sm:mt-2 sm:ml-2 w-full sm:w-auto max-w-80",color:"primary",size:"small",onClick:s.onSaveClick,children:"Save All Changes"}),e.jsx(p,{className:"rounded-lg mt-2 sm:mt-2 sm:ml-2 w-full sm:w-auto max-w-80",color:"medium",size:"small",onClick:s.onCancelClick,children:"Cancel"})]})]})},Fa=s=>e.jsx("div",{className:"gap-4 flex-1 sm:pr-4",children:e.jsx("div",{className:"flex flex-col",children:s.loading||!s.flashcardSetData?e.jsx($,{name:"dots"}):s.isEditing&&s.isOwner?e.jsxs(e.Fragment,{children:[e.jsx(ce,{type:"text",label:"Set Name",name:"set_name",value:s.updatedInfo.set_name,onChange:s.onMetadataChange,error:s.metadataErrors.setName}),e.jsx(ce,{type:"text",label:"Set Description",name:"set_description",value:s.updatedInfo.set_description,onChange:s.onMetadataChange,error:s.metadataErrors.setDescription}),s.metadataErrors.general&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.metadataErrors.general})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-3xl font-bold",children:s.flashcardSetData.SetName||"Untitled Set"}),e.jsx("p",{className:"text-base mt-1 text-gray-700 dark:text-gray-400",children:s.flashcardSetData.SetDescription||"No description available"}),e.jsxs(p,{className:"rounded-lg mt-4 max-w-[200px]",style:{"--border-radius":"0.5rem"},onClick:s.onBackClick,disabled:s.isEditing,children:[e.jsx(T,{slot:"start",icon:Fe}),"Back"]})]})})});function qa(s,a=!0){return ee({queryKey:["set",s],queryFn:()=>v("/api/flashcards/sets/",{method:"GET",headers:{id:s}}),enabled:a&&!!s,staleTime:5*60*1e3})}function Oa(s,a=!0){return ee({queryKey:["setCards",s],queryFn:()=>v("/api/flashcards/list",{method:"GET",headers:{set_id:s}}),enabled:a&&!!s,staleTime:5*60*1e3})}function Ra(){const s=M();return oe({mutationFn:({id:a,field:t,value:r})=>v(`/api/flashcards/sets/${t}`,{method:"PUT",headers:{id:a,[t]:r}}),onSuccess:(a,t)=>{s.invalidateQueries({queryKey:["set",t.id]}),s.invalidateQueries({queryKey:["userSets"]})}})}function Ua(){const s=M();return oe({mutationFn:({id:a,field:t,value:r})=>v(`/api/flashcards/${t}`,{method:"PUT",headers:{id:a,[t]:r}}),onSuccess:(a,t)=>{const n=s.getQueryCache().findAll({queryKey:["setCards"]}).map(o=>o.queryKey[1]).find(o=>{const i=s.getQueryData(["setCards",o]);return i==null?void 0:i.some(d=>d.ID===t.id)});n&&s.invalidateQueries({queryKey:["setCards",n]})}})}function Ma(){const s=M();return oe({mutationFn:({setId:a,front:t,back:r})=>v("/api/flashcards",{method:"POST",headers:{front:t,back:r,set_id:a}}),onSuccess:(a,t)=>{s.invalidateQueries({queryKey:["setCards",t.setId.toString()]})}})}function $a(){const s=M();return oe({mutationFn:a=>v("/api/flashcards",{method:"DELETE",headers:{id:a}}),onSuccess:(a,t)=>{const n=s.getQueryCache().findAll({queryKey:["setCards"]}).map(o=>o.queryKey[1]).find(o=>{const i=s.getQueryData(["setCards",o]);return i==null?void 0:i.some(d=>d.ID===t)});n&&s.invalidateQueries({queryKey:["setCards",n]})}})}function Ba(){const s=M();return oe({mutationFn:a=>v("/api/flashcards/sets/",{method:"DELETE",headers:{id:a}}),onSuccess:(a,t)=>{s.invalidateQueries({queryKey:["userSets"]})}})}const Ka=()=>{var ns;const{id:s}=ss(),a=Se(),[t]=de(),n=(ns=Ce().state)==null?void 0:ns.fromClassId,[o,i]=l.useState(!1),d=M(),{data:m,isLoading:c,error:u}=qa(s,!o),{data:f=[],isLoading:g,error:y}=Oa(s,!o),h=Ra(),j=Ua(),x=Ma(),N=$a(),C=Ba(),[z,se]=l.useState(!1),[B,Z]=l.useState(!1),[b,S]=l.useState([]),[V,te]=l.useState({set_name:"",set_description:""}),[k,P]=l.useState({}),[ae,A]=l.useState({}),je=(m==null?void 0:m.Role)==="owner",ye=c||g,pe=u||y;if(pe){let I="Unknown error";pe instanceof Error&&(I=pe.message),t({message:`Error loading data: ${I}`,duration:3e3,color:"danger"})}const ke=()=>{m&&(te({set_name:m.SetName||"",set_description:m.SetDescription||""}),S((f||[]).map(I=>({...I}))),Z(!0),P({}),A({}))},ze=I=>{const{name:D}=I.target,L=I.detail.value??"";te(w=>({...w,[D]:L}))},Ve=(I,D,L)=>{const w=L??"";S(F=>F==null?void 0:F.map((me,we)=>we===I?{...me,[D]:w}:me))},Ie=()=>{if(!m)return;const I={ID:0-(b||[]).filter(D=>D.ID<=0).length-1,Front:"",Back:"",SetID:m.ID,CreatedAt:new Date().toISOString(),UpdatedAt:new Date().toISOString()};S(D=>[...D||[],I])},Ee=I=>{S(D=>D.filter((L,w)=>w!==I))},O=()=>{const I={};let D=!0;const L=V.set_name.trim(),w=V.set_description.trim();return L||(I.setName="Set name is required",D=!1),w||(I.setDescription="Set description is required",D=!1),P(I),te({set_name:L,set_description:w}),D},ie=()=>{const I={};let D=!0;return b.forEach((L,w)=>{const F={},me=L.Front.trim(),we=L.Back.trim();me||(F.front="Front cannot be empty",D=!1),we||(F.back="Back cannot be empty",D=!1),Object.keys(F).length>0&&(I[w]=F),(me!==L.Front||we!==L.Back)&&S(He=>He==null?void 0:He.map((ls,Ks)=>Ks===w?{...ls,Front:me,Back:we}:ls))}),A(I),D},Ge=async()=>{const I=O(),D=ie();if(!I||!D||!m){t({message:"Please fix validation errors before saving.",duration:3e3,color:"warning"});return}try{V.set_name!==(m.SetName||"").trim()&&await h.mutateAsync({id:s,field:"set_name",value:V.set_name}),V.set_description!==(m.SetDescription||"").trim()&&await h.mutateAsync({id:s,field:"set_description",value:V.set_description});const L=new Map((f||[]).map(w=>[w.ID,w]));for(const w of f||[])!b.some(F=>F.ID===w.ID)&&w.ID>0&&await N.mutateAsync(w.ID);for(const w of b)if(w.ID<=0)await x.mutateAsync({setId:m.ID,front:w.Front,back:w.Back});else{const F=L.get(w.ID);F&&(w.Front!==(F.Front||"").trim()&&await j.mutateAsync({id:w.ID,field:"front",value:w.Front}),w.Back!==(F.Back||"").trim()&&await j.mutateAsync({id:w.ID,field:"back",value:w.Back}))}t({message:"Set details and cards updated successfully!",duration:2e3,color:"success"}),Z(!1),P({}),A({})}catch(L){let w="Unknown error during save";L instanceof Error&&(w=L.message),P(F=>({...F,general:`Failed to save: ${w}`})),t({message:`Failed to save changes: ${w}`,duration:3e3,color:"danger"})}},Ye=()=>{Z(!1),P({}),A({})},Bs=async()=>{if(!s){t({message:"Cannot delete: Set ID missing.",duration:3e3,color:"danger"});return}i(!0);try{await C.mutateAsync(s),d.removeQueries({queryKey:["set",s],exact:!0}),d.removeQueries({queryKey:["setCards",s],exact:!0}),t({message:"Set deleted successfully.",duration:2e3,color:"success"}),a.push("/home")}catch(I){let D="Unknown error during deletion";I instanceof Error&&(D=I.message),t({message:`Failed to delete set: ${D}`,duration:3e3,color:"danger"})}},as=()=>{B||(n?a.push(`/class/${n}`):a.push("/home"))},rs=B?b:f;return ye&&!B?e.jsxs(U,{children:[e.jsxs(_,{className:"",children:[e.jsx(X,{}),e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx($,{name:"circular"})})]}),e.jsx(W,{})]}):e.jsxs(U,{children:[e.jsx(X,{}),e.jsxs(_,{children:[e.jsxs("div",{className:"container max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx(Fa,{loading:ye,flashcardSetData:m,isEditing:B,isOwner:je,updatedInfo:V,metadataErrors:k,onMetadataChange:ze,onBackClick:as}),e.jsx(_a,{isOwner:je,isEditing:B,cardsToDisplay:rs,onBackClick:as,onEditClick:ke,onSaveClick:Ge,onCancelClick:Ye,onDeleteClick:()=>se(!0),studyLink:`/flashcards/${s}`})]}),e.jsx(La,{loading:ye,cardsToDisplay:rs,isEditing:B,isOwner:je,cardErrors:ae,onCardChange:Ve,onAddCard:Ie,onRemoveCard:Ee,onAddCardClick:ke})]}),e.jsx(Ae,{isOpen:z,onDidDismiss:()=>se(!1),header:"Confirm Deletion",message:"Are you sure you want to delete this set? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary"},{text:"Delete",role:"destructive",handler:Bs}]})]}),e.jsx(W,{})]})},re=s=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium",children:[s.label,":"]}),e.jsx("span",{children:s.value})]}),Qa=s=>{var a,t,r,n,o,i,d,m,c,u,f,g,y,h;return e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs(q,{className:"md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(H,{className:"p-6",children:e.jsx(J,{className:"text-xl font-rye font-semibold text-primary",children:"Account Information"})}),e.jsx(Q,{className:"p-6 pt-0",children:s.isEditing?e.jsxs("div",{className:"space-y-4",children:[e.jsx(ce,{type:"text",label:"First Name",name:"first_name",value:((a=s.updatedInfo)==null?void 0:a.first_name)||"",error:s.errors.first_name,onChange:s.handleChange}),e.jsx(ce,{type:"text",label:"Last Name",name:"last_name",value:((t=s.updatedInfo)==null?void 0:t.last_name)||"",error:s.errors.last_name,onChange:s.handleChange}),e.jsx(ce,{type:"text",label:"Username",name:"username",value:((r=s.updatedInfo)==null?void 0:r.username)||"",error:s.errors.username,onChange:s.handleChange}),e.jsx(ce,{type:"email",label:"Email",name:"email",value:((n=s.updatedInfo)==null?void 0:n.email)||"",error:s.errors.email,onChange:s.handleChange}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(p,{onClick:s.handleSave,children:"Save Changes"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{label:"First Name",value:(o=s.userInfo)==null?void 0:o.first_name}),e.jsx(re,{label:"Last Name",value:(i=s.userInfo)==null?void 0:i.last_name}),e.jsx(re,{label:"Username",value:(d=s.userInfo)==null?void 0:d.username}),e.jsx(re,{label:"Email",value:(m=s.userInfo)==null?void 0:m.email}),e.jsxs(p,{onClick:s.handleEdit,className:"mt-4",children:[e.jsx(T,{slot:"start",icon:bs}),"Edit Info"]})]})})]}),e.jsxs(q,{className:"md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(H,{className:"p-6",children:e.jsx(J,{className:"text-xl font-rye font-semibold text-primary",children:"Account Stats"})}),e.jsx(Q,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(re,{label:"Account Created",value:(c=s.userInfo)==null?void 0:c.created_at}),e.jsx(re,{label:"Login Streak",value:(u=s.userInfo)==null?void 0:u.login_streak}),e.jsx(re,{label:"Classes Taken",value:(f=s.userInfo)==null?void 0:f.numClasses}),e.jsx(re,{label:"Cards Studied/Total Views",value:`${(g=s.userInfo)==null?void 0:g.cardsStudied} / ${(y=s.userInfo)==null?void 0:y.totalCardViews}`}),e.jsx(re,{label:"Total Score",value:(h=s.userInfo)==null?void 0:h.totalScore})]})})]})]})},us=256;function za(s){const[a,t]=l.useState(0),{ref:r,inView:n}=Ct({threshold:.7,triggerOnce:!0});return l.useEffect(()=>{let o=1e3;if(n){const i=setTimeout(()=>t(a+1),o*=.75);a==s.streak-1&&clearTimeout(i)}},[a,s.streak,n]),e.jsxs(q,{className:"md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(H,{className:"p-6",children:e.jsx(J,{className:"text-xl font-rye font-semibold text-primary",children:"Login Streak"})}),e.jsxs(Q,{ref:r,className:"py-6 px-0 flex flex-row items-center justify-center gap-8",children:[e.jsx("img",{src:`/frame-${a}.png`,alt:"bonsai tree",width:us,height:us}),e.jsx("span",{className:"text-6xl px-4 font-rye font-extrabold text-[color:--ion-color-primary] tabular-nums -ml-[30%] me:ml-0",children:a+1})]})]})}const Va=s=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 py-6",children:[e.jsx(za,{streak:s.streak}),e.jsxs(q,{className:"md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(H,{className:"p-6",children:e.jsx(J,{className:"text-xl font-rye font-semibold text-primary",children:"Account Options"})}),e.jsx(Q,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(St,{label:"Theme",value:s.theme,onIonChange:a=>s.setTheme(a.detail.value),interface:"popover",placeholder:"Select Theme",children:[e.jsx(is,{value:"light",children:"Light"}),e.jsx(is,{value:"dark",children:"Dark"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"mr-4",children:[e.jsx("h4",{className:"text-sm font-medium text-black dark:text-white",children:"Change Your Password"}),e.jsx("p",{className:"text-xs dark:text-gray-300",children:"Reset your account password."})]}),e.jsx(p,{color:"primary",onClick:()=>s.setShowPasswordAlert(!0),children:"Change Password"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"mr-4",children:[e.jsx("h4",{className:"text-sm font-medium text-black dark:text-white",children:"Delete Your Account"}),e.jsx("p",{className:"text-xs dark:text-gray-300",children:"This will delete all account data and can't be undone."})]}),e.jsx(p,{color:"danger",onClick:()=>s.setShowDeleteAlert(!0),children:"Delete Account"})]})]})})]})]}),e.jsx(Ae,{isOpen:s.showPasswordAlert,onDidDismiss:()=>s.setShowPasswordAlert(!1),header:"Change Password",inputs:[{name:"newPassword",type:"password",placeholder:"New Password"},{name:"confirmPassword",type:"password",placeholder:"Confirm New Password"}],buttons:[{text:"Cancel",role:"cancel",handler:()=>{}},{text:"Save",handler:async a=>{if(a.newPassword!==a.confirmPassword)return s.presentToast({message:"Passwords do not match",duration:4e3,color:"danger"}),!0;try{const t=await v("/api/users/password",{method:"PUT",headers:{password:a.newPassword}});s.presentToast({message:"Password changed.",duration:5e3,color:"success"})}catch(t){s.presentToast({message:"Error changing password: "+t,duration:7e3,color:"danger"})}return!0}}]}),e.jsx(Ae,{isOpen:s.showDeleteAlert,onDidDismiss:()=>s.setShowDeleteAlert(!1),header:"Confirm Deletion",message:"Are you sure you want to delete your account? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{}},{text:"Delete",handler:async()=>{try{const a=await v("/api/users/",{method:"DELETE",headers:{}});s.presentToast({message:"Account deleted. Please close your browser.",duration:5e3,color:"success"})}catch(a){s.presentToast({message:"Error deleting account: "+a,duration:7e3,color:"danger"})}return!0}}]})]}),Ga=()=>{const{theme:s,setTheme:a}=Ps(),[t,r]=l.useState(),[n,o]=l.useState(!0),[i,d]=l.useState(null),[m,c]=l.useState(null),[u,f]=l.useState(!1),[g,y]=l.useState(!1),[h,j]=l.useState(!1),[x,N]=l.useState(t),C=k=>{c(m===k?null:k)},z=()=>{N(t),j(!0)},se=async()=>{var P;if(!B())return;const k=["first_name","last_name","username","email"];try{const ae=(P=k==null?void 0:k.filter(A=>x[A]!==t[A]))==null?void 0:P.map(A=>v(`/api/users/${A}`,{method:"PUT",headers:{[A]:x[A]}}));await Promise.all(ae),r(x),j(!1)}catch(ae){te({message:`Failed to update some fields. Please try again. ${ae.message}`,duration:4e3,color:"danger"})}},B=()=>{const k={};let P=!0;return x.first_name||(k.first_name="First name is required",P=!1),x.last_name||(k.last_name="Last name is required",P=!1),x.email?/\S+@\S+\.\S+/.test(x.email)||(k.email="Email is invalid",P=!1):(k.email="Email is required",P=!1),x.username||(k.username="Username is required",P=!1),x.first_name=x.first_name.trim(),x.last_name=x.last_name.trim(),x.email=x.email.trim(),x.username=x.username.trim(),b(k),P},[Z,b]=l.useState({}),S=k=>{const{name:P}=k.target,ae=k.detail.value;N(A=>({...A,[P]:ae}))},V=l.useCallback(async()=>{o(!0),d(null);try{const k=await v("/api/users/");r(k),N(k)}catch(k){d(`Failed to fetch User Data: ${k.message}`)}finally{o(!1)}},[]);kt(()=>{V()});const[te]=de();return e.jsxs(U,{children:[e.jsx(X,{}),e.jsx(_,{children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx("p",{className:"text-xl font-rye font-semibold text-primary",children:n?"Loading...":`Welcome back, ${(t==null?void 0:t.username)||"User"}!`})}),e.jsxs(p,{onClick:()=>window.history.back(),className:"mb-6",children:[e.jsx(T,{slot:"start",icon:Fe}),"Back"]}),n&&e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx($,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading account details..."})]}),i&&!n&&e.jsx("div",{className:"text-red-500 text-center p-4 border border-red-500 rounded-md",children:i}),!n&&!i&&t&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{isEditing:h,errors:Z,handleChange:S,handleSave:se,updatedInfo:x,userInfo:t,handleEdit:z}),e.jsx(Va,{streak:(t==null?void 0:t.login_streak)??0,isEditing:h,errors:Z,handleChange:S,handleSave:se,updatedInfo:x,userInfo:t,expandedClass:m,toggleClassDetails:C,showPasswordAlert:u,setShowPasswordAlert:f,showDeleteAlert:g,setShowDeleteAlert:y,theme:s,setTheme:a,presentToast:te})]})]})}),e.jsx(W,{})]})};It();const Ya=new Et;function Ha(){return e.jsx(Dt,{client:Ya,children:e.jsx(Yt,{children:e.jsxs(ea,{children:[e.jsx(Tt,{children:e.jsxs(Pt,{children:[e.jsxs(l.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:[e.jsx(X,{}),e.jsxs(At,{id:"main-content",children:[e.jsx(R,{exact:!0,path:"/",component:Da}),e.jsx(R,{exact:!0,path:"/home",component:Ea}),e.jsx(R,{exact:!0,path:"/class/:id",component:ya}),e.jsx(R,{exact:!0,path:"/auth",component:Ds}),e.jsx(R,{exact:!0,path:"/reset-password",component:Gt}),e.jsx(R,{exact:!0,path:"/confirm-reset-password",component:Vt}),e.jsx(R,{exact:!0,path:"/public-cards",component:Pa}),e.jsx(R,{exact:!0,path:"/user-account",component:Ga}),e.jsx(R,{exact:!0,path:"/flashcards/:id",component:Ia}),e.jsx(R,{exact:!0,path:"/create-set",component:wa}),e.jsx(R,{exact:!0,path:"/create-class",component:pa}),e.jsx(R,{exact:!0,path:"/public-classes",component:Aa}),e.jsx(R,{exact:!0,path:"/set-overview/:id",component:Ka}),e.jsx(R,{component:Ta})]})]}),e.jsx(W,{})]})}),e.jsx(Zt,{}),e.jsx(Ht,{})]})})})}const Ja=document.getElementById("root"),Wa=Lt(Ja);Wa.render(e.jsx(Ha,{}));export{sr as _,er as g};
//# sourceMappingURL=index-eR4X6KR9.js.map
