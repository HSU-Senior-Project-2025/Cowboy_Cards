import{t as Cs,c as Is,r,j as e,a as ge,S as Ds,R as He,u as Je,C as Ye,L as le,b as ks,I as w,d as I,e as Es,$ as Ts,V as We,f as Ke,A as Qe,g as Xe,X as Ze,T as es,D as ss,P as As,h as ts,i as Ps,k as Se,l as _s,m as we,n as he,o as as,p as ee,q as _,s as Y,v as B,w as Fs,x as oe,y as U,z as Ls,B as te,E as F,F as Ce,G as Ie,H as De,J as Os,K as rs,M as re,N as ns,O as Rs,Q as Us,U as $s,W as Bs,Y as zs,Z as Ms,_ as je,a0 as Gs,a1 as qs,a2 as Vs,a3 as P,a4 as z,a5 as M,a6 as Hs,a7 as Js,a8 as Ys,a9 as $e,aa as Ws,ab as Ks,ac as Qs,ad as Xs,ae as Zs,af as et,ag as st,ah as ls,ai as xe,aj as pe,ak as W,al as tt,am as Be,an as at,ao as fe,ap as rt,aq as nt,ar as ze,as as lt,at as ot,au as ct,av as Me,aw as it,ax as dt,ay as ut,az as mt,aA as ht,aB as xt,aC as O,aD as ft}from"./nm-BY1UDbxK.js";import"./index-CXxgtYOt.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function a(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(l){if(l.ep)return;l.ep=!0;const i=a(l);fetch(l.href,i)}})();function fa(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function ga(s){if(s.__esModule)return s;var t=s.default;if(typeof t=="function"){var a=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};a.prototype=t.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var l=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(a,n,l.get?l:{enumerable:!0,get:function(){return s[n]}})}),a}function C(...s){return Cs(Is(s))}const gt=ge("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ke=r.forwardRef(({className:s,variant:t,...a},n)=>e.jsx("div",{ref:n,role:"alert",className:C(gt({variant:t}),s),...a}));ke.displayName="Alert";const jt=r.forwardRef(({className:s,...t},a)=>e.jsx("h5",{ref:a,className:C("mb-1 font-medium leading-none tracking-tight",s),...t}));jt.displayName="AlertTitle";const Ee=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("text-sm [&_p]:leading-relaxed",s),...t}));Ee.displayName="AlertDescription";const pt=ge("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),K=r.forwardRef(({className:s,variant:t,size:a,asChild:n=!1,...l},i)=>{const u=n?Ds:"button";return e.jsx(u,{className:C(pt({variant:t,size:a,className:s})),ref:i,...l})});K.displayName="Button";const ce=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));ce.displayName="Card";const Te=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("flex flex-col space-y-1.5 p-6",s),...t}));Te.displayName="CardHeader";const Ae=r.forwardRef(({className:s,...t},a)=>e.jsx("h3",{ref:a,className:C("text-2xl font-semibold leading-none tracking-tight",s),...t}));Ae.displayName="CardTitle";const Pe=r.forwardRef(({className:s,...t},a)=>e.jsx("p",{ref:a,className:C("text-sm text-muted-foreground",s),...t}));Pe.displayName="CardDescription";const _e=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("p-6 pt-0",s),...t}));_e.displayName="CardContent";const Fe=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("flex items-center p-6 pt-0",s),...t}));Fe.displayName="CardFooter";const X=r.forwardRef(({className:s,type:t,...a},n)=>e.jsx("input",{type:t,className:C("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...a}));X.displayName="Input";const vt=ge("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Z=r.forwardRef(({className:s,...t},a)=>e.jsx(He,{ref:a,className:C(vt(),s),...t}));Z.displayName=He.displayName;const Nt=1,yt=1e6;let ye=0;function bt(){return ye=(ye+1)%Number.MAX_SAFE_INTEGER,ye.toString()}const be=new Map,Ge=s=>{if(be.has(s))return;const t=setTimeout(()=>{be.delete(s),ne({type:"REMOVE_TOAST",toastId:s})},yt);be.set(s,t)},wt=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,Nt)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?Ge(a):s.toasts.forEach(n=>{Ge(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},ue=[];let me={toasts:[]};function ne(s){me=wt(me,s),ue.forEach(t=>{t(me)})}function St({...s}){const t=bt(),a=l=>ne({type:"UPDATE_TOAST",toast:{...l,id:t}}),n=()=>ne({type:"DISMISS_TOAST",toastId:t});return ne({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:l=>{l||n()}}}),{id:t,dismiss:n,update:a}}function os(){const[s,t]=r.useState(me);return r.useEffect(()=>(ue.push(t),()=>{const a=ue.indexOf(t);a>-1&&ue.splice(a,1)}),[s]),{...s,toast:St,dismiss:a=>ne({type:"DISMISS_TOAST",toastId:a})}}const qe={method:"GET",headers:{},credentials:"include"},Ct="https://cowboy-cards.dsouth.org";async function b(s="",t=qe){const a={...qe,...t};try{const n=await fetch(Ct+s,a);if(!n.ok)throw console.log("resp",n),new Error(`HTTP error! Status: ${n.status}`);return await n.json()}catch(n){throw console.error("API request failed:",n),n}}const It="modulepreload",Dt=function(s,t){return new URL(s,t).href},Ve={},ja=function(t,a,n){let l=Promise.resolve();if(a&&a.length>0){const u=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),h=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));l=Promise.allSettled(a.map(d=>{if(d=Dt(d,n),d in Ve)return;Ve[d]=!0;const m=d.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(!!n)for(let c=u.length-1;c>=0;c--){const f=u[c];if(f.href===d&&(!m||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${p}`))return;const N=document.createElement("link");if(N.rel=m?"stylesheet":It,m||(N.as="script"),N.crossOrigin="",N.href=d,h&&N.setAttribute("nonce",h),document.head.appendChild(N),m)return new Promise((c,f)=>{N.addEventListener("load",c),N.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(u){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=u,window.dispatchEvent(o),!o.defaultPrevented)throw u}return l.then(u=>{for(const o of u||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},cs=()=>{const[s,t]=r.useState(!0),[a,n]=r.useState(!1),[l,i]=r.useState(""),[u,o]=r.useState(""),[h,d]=r.useState(""),[m,p]=r.useState(""),[x,N]=r.useState(""),[c,f]=r.useState({}),j=Je(),{toast:k}=os(),T=()=>{const S={};let D=!0;return l?/\S+@\S+\.\S+/.test(l)||(S.email="Email is invalid",D=!1):(S.email="Email is required",D=!1),u?u.length<8&&(S.password="Password must be at least 8 characters",D=!1):(S.password="Password is required",D=!1),!s&&!h&&(S.username="Username is required",D=!1),f(S),D},V=async S=>{if(S.preventDefault(),!!T()){n(!0),f({});try{let D;s?D=await b("/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:l,password:u})}):D=await b("/signup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:h,email:l,password:u,first_name:m,last_name:x})}),k({title:s?"Welcome back!":"Account created",description:s?"You have been successfully logged in.":"Your account has been created successfully."}),j.push("/home")}catch(D){console.error("Authentication error:",D),f(D),Object.keys(c).length===0&&f({general:D.message||"An unexpected error occurred. Please try again."}),k({title:"Authentication failed",description:D.message||"Please check your credentials and try again.",variant:"destructive"})}finally{n(!1)}}},$=()=>{f({}),s?(d(""),p(""),N("")):(i(""),o(""))};return e.jsxs(ce,{className:"w-[350px]",children:[e.jsxs(Te,{children:[e.jsx(Ae,{children:s?"Welcome back":"Create account"}),e.jsx(Pe,{children:s?"Enter your credentials to continue":"Sign up for a new account"})]}),e.jsxs("form",{onSubmit:V,children:[e.jsxs(_e,{className:"space-y-4",children:[c.general&&e.jsxs(ke,{variant:"destructive",className:"mb-4",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx(Ee,{children:c.general})]}),!s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"username",children:"Username"}),e.jsx(X,{id:"username",type:"text",placeholder:"johndoe",value:h,onChange:S=>d(S.target.value),required:!0,className:c.username?"border-red-500":""}),c.username&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"firstName",children:"First Name"}),e.jsx(X,{id:"firstName",type:"text",placeholder:"John",value:m,onChange:S=>p(S.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"lastName",children:"Last Name"}),e.jsx(X,{id:"lastName",type:"text",placeholder:"Doe",value:x,onChange:S=>N(S.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"email",children:"Email"}),e.jsx(X,{id:"email",type:"email",placeholder:"name@example.com",value:l,onChange:S=>i(S.target.value),required:!0,className:c.email?"border-red-500":""}),c.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"password",children:"Password"}),e.jsx(X,{id:"password",type:"password",value:u,onChange:S=>o(S.target.value),required:!0,className:c.password?"border-red-500":""}),c.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:c.password}),!s&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long"})]}),s&&e.jsx(le,{to:"/reset-password",className:"text-sm text-purple-500",children:"Forgot password?"})]}),e.jsxs(Fe,{className:"flex flex-col space-y-4",children:[e.jsxs(K,{type:"submit",className:"w-full",disabled:a,children:[e.jsx(ks,{className:"mr-2 h-4 w-4"}),a?s?"Signing in...":"Signing up...":s?"Sign in":"Sign up"]}),e.jsx(K,{variant:"link",type:"button",onClick:()=>{t(!s),$()},className:"text-sm",disabled:a,children:s?"Need an account? Sign up":"Already have an account? Sign in"}),e.jsxs(w,{expand:"block",fill:"outline",className:"flex items-center justify-center space-x-2",onClick:()=>{console.log("Sign in with Google clicked")},children:[e.jsx(I,{slot:"start",src:"https://www.gstatic.com/marketing-cms/assets/images/d5/dc/cfe9ce8b4425b410b49b7f2dd3f3/g.webp=s96-fcrop64=1,00000000ffffffff-rw",className:"h-5 w-5"}),e.jsx("p",{}),"Sign in with Google",e.jsx("img",{slot:"start",src:"https://www.gstatic.com/marketing-cms/assets/images/d5/dc/cfe9ce8b4425b410b49b7f2dd3f3/g.webp=s96-fcrop64=1,00000000ffffffff-rw",className:"h-10 w-10"})]})]})]})]})},kt=()=>{const[s,t]=r.useState(""),[a,n]=r.useState({}),l=i=>{i.preventDefault()};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:e.jsxs(ce,{className:"w-[350px]",children:[e.jsxs(Te,{children:[e.jsx(Ae,{children:"Reset Password"}),e.jsx(Pe,{children:"Enter your email to reset your password"})]}),e.jsxs("form",{onSubmit:l,children:[e.jsxs(_e,{className:"space-y-4",children:[a.general&&e.jsxs(ke,{variant:"destructive",className:"mb-4",children:[e.jsx(Ye,{className:"h-4 w-4"}),e.jsx(Ee,{children:a.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"email",children:"Email"}),e.jsx(X,{id:"email",type:"email",placeholder:"name@example.com",value:s,onChange:i=>t(i.target.value),required:!0,className:a.email?"border-red-500":""}),a.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.email})]})]}),e.jsx(Fe,{className:"flex flex-col space-y-4",children:e.jsx(K,{type:"submit",className:"w-full",children:"Send Reset Link"})})]})]})})},Et=({...s})=>{const{theme:t="system"}=Es();return e.jsx(Ts,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},Tt=As,is=r.forwardRef(({className:s,...t},a)=>e.jsx(We,{ref:a,className:C("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));is.displayName=We.displayName;const At=ge("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ds=r.forwardRef(({className:s,variant:t,...a},n)=>e.jsx(Ke,{ref:n,className:C(At({variant:t}),s),...a}));ds.displayName=Ke.displayName;const Pt=r.forwardRef(({className:s,...t},a)=>e.jsx(Qe,{ref:a,className:C("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));Pt.displayName=Qe.displayName;const us=r.forwardRef(({className:s,...t},a)=>e.jsx(Xe,{ref:a,className:C("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(Ze,{className:"h-4 w-4"})}));us.displayName=Xe.displayName;const ms=r.forwardRef(({className:s,...t},a)=>e.jsx(es,{ref:a,className:C("text-sm font-semibold",s),...t}));ms.displayName=es.displayName;const hs=r.forwardRef(({className:s,...t},a)=>e.jsx(ss,{ref:a,className:C("text-sm opacity-90",s),...t}));hs.displayName=ss.displayName;function _t(){const{toasts:s}=os();return e.jsxs(Tt,{children:[s.map(function({id:t,title:a,description:n,action:l,...i}){return e.jsxs(ds,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(ms,{children:a}),n&&e.jsx(hs,{children:n})]}),l,e.jsx(us,{})]},t)}),e.jsx(is,{})]})}const Ft=Ps,Lt=r.forwardRef(({className:s,sideOffset:t=4,...a},n)=>e.jsx(ts,{ref:n,sideOffset:t,className:C("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));Lt.displayName=ts.displayName;const xs=r.createContext(void 0);function Ot({children:s}){const[t,a]=r.useState(()=>{const n=localStorage.getItem("theme");return n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});return r.useEffect(()=>{localStorage.setItem("theme",t),t==="dark"?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},[t]),e.jsx(xs.Provider,{value:{theme:t,setTheme:a},children:s})}function fs(){const s=r.useContext(xs);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s}const Rt=s=>{const[t,a]=r.useState([]),[n,l]=r.useState([]),[i,u]=r.useState(null),[o,h]=r.useState(!1),[d,m]=r.useState(null),[p]=Se(),x=r.useCallback(async()=>{h(!0),m(null);try{const c=await b("/api/set_user/list",{method:"GET",headers:{}});a(c||[])}catch(c){console.error("Failed to fetch user sets:",c),m(`Failed to load your sets: ${c instanceof Error?c.message:"Unknown error"}`),a([])}finally{h(!1)}},[]);r.useEffect(()=>{s.isOpen?x():(a([]),l([]),u(null),m(null),h(!1))},[s.isOpen,x]),r.useEffect(()=>{const c=t.filter(f=>!s.existingSetIds.includes(f.SetID));l(c)},[t,s.existingSetIds]);const N=async()=>{if(!i||!s.classId){p({message:"Please select a set to add.",duration:2e3,color:"warning"});return}h(!0),m(null);try{await b("/api/class_set/",{method:"POST",headers:{id:s.classId,set_id:i.toString()}}),p({message:"Set added successfully!",duration:2e3,color:"success"}),s.onSetAdded(),s.onDidDismiss()}catch(c){console.error("Failed to add set to class:",c);const f=`Failed to add set: ${c instanceof Error?c.message:"Unknown error"}`;m(f),p({message:f,duration:3e3,color:"danger"})}finally{h(!1)}};return console.log("selectedSetId",i),console.log("availableSets",n),e.jsxs(_s,{isOpen:s.isOpen,onDidDismiss:s.onDidDismiss,children:[e.jsx(we,{children:e.jsxs(he,{children:[e.jsx(as,{children:"Add Set to Class"}),e.jsx(ee,{slot:"end",children:e.jsx(w,{onClick:s.onDidDismiss,color:"medium",children:"Cancel"})})]})}),e.jsxs(_,{className:"ion-padding",children:[o&&!n.length?e.jsxs("div",{className:"flex justify-center items-center h-full",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading your sets..."})]}):d?e.jsx(B,{color:"danger",children:e.jsx("p",{children:d})}):n.length===0?e.jsx("p",{className:"text-center text-gray-500 mt-4",children:"You have no available sets to add to this class. Create a new set or check if all your sets are already added."}):e.jsx(Fs,{value:i,onIonChange:c=>{console.log("e.detail.value",c.detail.value),u(Number(c.detail.value))},children:e.jsx(oe,{children:n.map(c=>e.jsxs(U,{children:[e.jsx(Ls,{slot:"start",value:c.SetID},c.SetID),e.jsxs(te,{children:[e.jsx("h2",{children:c.SetName}),e.jsx("p",{className:"text-sm text-gray-500",children:c.SetDescription})]})]},c.SetID))})}),d&&n.length>0&&e.jsx(B,{color:"danger",className:"block mt-4",children:e.jsx("p",{children:d})})]}),!o&&n.length>0&&e.jsx("div",{className:"ion-padding",children:e.jsx(w,{expand:"block",onClick:N,disabled:!i,className:"ion-margin-bottom",children:o?e.jsx(Y,{name:"dots"}):"Add Selected Set"})})]})},Ut=s=>e.jsx(F,{children:e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs(w,{routerLink:"/home",color:"medium",children:[e.jsx(I,{slot:"start",icon:Ce}),"Back"]}),s.isTeacher&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{onClick:s.onAddSetClick,color:"primary",disabled:!s.classId,children:[e.jsx(I,{slot:"start",icon:Ie}),"Add Existing Set"]}),e.jsxs(w,{routerLink:`/create-set?classId=${s.classId}`,color:"primary",disabled:!s.classId,children:[e.jsx(I,{slot:"start",icon:De}),"Create New Set"]})]})]})}),se=s=>e.jsxs("div",{children:[e.jsx(U,{children:e.jsx(Os,{type:s.type,label:s.label,name:s.name,value:s.value,onIonChange:s.onChange})}),s.error&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.error})]}),$t=s=>e.jsx(e.Fragment,{children:s.isEditing?e.jsxs(e.Fragment,{children:[e.jsx(se,{type:"text",label:"Class Name",name:"class_name",value:s.updatedInfo.class_name,onChange:s.handleChange,error:s.errors.className}),e.jsx(se,{type:"text",label:"Class Description",name:"class_description",value:s.updatedInfo.class_description,onChange:s.handleChange,error:s.errors.classDescription}),s.errors.general&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.errors.general}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx(w,{onClick:s.handleSave,color:"primary",size:"small",children:"Save"}),e.jsx(w,{onClick:s.handleCancel,color:"medium",size:"small",children:"Cancel"})]})]}):s.loading?e.jsx("div",{children:"Loading..."}):s.classData?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s.loading?"Loading...":s.classData.ClassName}),s.isTeacher&&!s.isEditing&&e.jsx(I,{icon:De,size:"large",color:"primary",className:"hover:transform hover:scale-110 cursor-pointer p-2",onClick:s.handleEdit})]}),e.jsx("p",{className:"text-gray-600",children:s.loading?"Loading...":s.classData.ClassDescription})]}):e.jsx("h1",{children:"Class details unavailable"})}),Bt=s=>e.jsxs(rs,{value:s.selectedTab,onIonChange:t=>s.onTabChange(t.detail.value),className:"w-full mb-6",children:[e.jsxs(re,{value:"flashcards",children:[e.jsx(I,{icon:ns,className:"mr-2"}),e.jsx(te,{children:"Flashcard Sets"})]}),e.jsxs(re,{value:"leaderboard",children:[e.jsx(I,{icon:Rs,className:"mr-2"}),e.jsx(te,{children:"Leaderboard"})]}),e.jsxs(re,{value:"students",children:[e.jsx(I,{icon:Us,className:"mr-2"}),e.jsx(te,{children:"Students"})]})]}),gs=s=>{const[t,a]=r.useState(!1),n=async u=>{var o;try{const h=await b(`${u}`,{method:"POST",headers:{card_id:s.cardId.toString()}});console.log(`Score update successful for card ${s.cardId}:`,h),(o=s.onAdvance)==null||o.call(s)}catch(h){console.error(`Failed to update score for card ${s.cardId}:`,h)}},l=()=>{n("/api/card_history/incorrect")},i=()=>{n("/api/card_history/correct")};return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsxs("div",{className:`flip-card cursor-pointer ${t?"flipped":""}`,onClick:()=>a(!t),children:[e.jsx(ce,{className:"flip-card-front p-8 min-h-[300px] flex items-center justify-center text-center",children:e.jsx("p",{className:"text-xl",children:s.front})}),e.jsx(ce,{className:"flip-card-back p-8 min-h-[300px] flex items-center justify-center text-center absolute top-0 w-full",children:e.jsx("p",{className:"text-xl",children:s.back})})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsxs(K,{variant:"outline",className:"w-32",onClick:l,children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Learning"]}),e.jsxs(K,{className:"w-32",onClick:i,children:[e.jsx($s,{className:"mr-2 h-4 w-4"}),"Mastered"]})]})]})},js=r.createContext(null);function ve(){const s=r.useContext(js);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const Le=r.forwardRef(({orientation:s="horizontal",opts:t,setApi:a,plugins:n,className:l,children:i,...u},o)=>{const[h,d]=Bs({...t,axis:s==="horizontal"?"x":"y"},n),[m,p]=r.useState(!1),[x,N]=r.useState(!1),c=r.useCallback(T=>{T&&(p(T.canScrollPrev()),N(T.canScrollNext()))},[]),f=r.useCallback(()=>{d==null||d.scrollPrev()},[d]),j=r.useCallback(()=>{d==null||d.scrollNext()},[d]),k=r.useCallback(T=>{T.key==="ArrowLeft"?(T.preventDefault(),f()):T.key==="ArrowRight"&&(T.preventDefault(),j())},[f,j]);return r.useEffect(()=>{!d||!a||a(d)},[d,a]),r.useEffect(()=>{if(d)return c(d),d.on("reInit",c),d.on("select",c),()=>{d==null||d.off("select",c)}},[d,c]),e.jsx(js.Provider,{value:{carouselRef:h,api:d,opts:t,orientation:s||((t==null?void 0:t.axis)==="y"?"vertical":"horizontal"),scrollPrev:f,scrollNext:j,canScrollPrev:m,canScrollNext:x},children:e.jsx("div",{ref:o,onKeyDownCapture:k,className:C("relative",l),role:"region","aria-roledescription":"carousel",...u,children:i})})});Le.displayName="Carousel";const Oe=r.forwardRef(({className:s,...t},a)=>{const{carouselRef:n,orientation:l}=ve();return e.jsx("div",{ref:n,className:"overflow-hidden",children:e.jsx("div",{ref:a,className:C("flex",l==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...t})})});Oe.displayName="CarouselContent";const Re=r.forwardRef(({className:s,...t},a)=>{const{orientation:n}=ve();return e.jsx("div",{ref:a,role:"group","aria-roledescription":"slide",className:C("min-w-0 shrink-0 grow-0 basis-full",n==="horizontal"?"pl-4":"pt-4",s),...t})});Re.displayName="CarouselItem";const ps=r.forwardRef(({className:s,variant:t="outline",size:a="icon",...n},l)=>{const{orientation:i,scrollPrev:u,canScrollPrev:o}=ve();return e.jsxs(K,{ref:l,variant:t,size:a,className:C("absolute  h-8 w-8 rounded-full",i==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:u,...n,children:[e.jsx(zs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});ps.displayName="CarouselPrevious";const vs=r.forwardRef(({className:s,variant:t="outline",size:a="icon",...n},l)=>{const{orientation:i,scrollNext:u,canScrollNext:o}=ve();return e.jsxs(K,{ref:l,variant:t,size:a,className:C("absolute h-8 w-8 rounded-full",i==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!o,onClick:u,...n,children:[e.jsx(Ms,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});vs.displayName="CarouselNext";const zt=s=>{var u;const t=je(),[a,n]=r.useState([]),[l,i]=r.useState(null);return r.useEffect(()=>{async function o(){console.log("selectedSet",l);const h=await b("/api/flashcards/list",{method:"GET",headers:{set_id:l}});console.log("cards",h),n(h)}l&&o()},[l]),e.jsx("div",{className:"mt-6",children:s.loading?e.jsx("div",{children:"Loading..."}):l===null?(u=s.flashcardSets)!=null&&u.length?e.jsx(Gs,{children:e.jsx(qs,{children:s.flashcardSets.sort((o,h)=>o.ID-h.ID).map(o=>e.jsx(Vs,{size:"12",sizeMd:"6",sizeLg:"4",children:e.jsxs(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-200 rounded-lg border shadow-sm",onClick:()=>t.push(`/set-overview/${o.ID}`),children:[e.jsx(z,{children:e.jsx(M,{className:"text-lg font-semibold",children:o.SetName})}),e.jsx(F,{children:e.jsx("p",{className:"text-muted-foreground mb-2",children:o.SetDescription})})]})},o.ID))})}):e.jsx("p",{children:"No flashcard sets available."}):e.jsxs(e.Fragment,{children:[e.jsxs(w,{fill:"outline",onClick:()=>i(null),className:"mb-6",children:[e.jsx(I,{slot:"start",icon:Ce}),"Back to Sets"]}),e.jsxs("div",{className:"w-full max-w-2xl mx-auto relative",children:[e.jsxs(Le,{orientation:"vertical",className:"w-full",setApi:s.setApi,children:[e.jsx(Oe,{className:"-mt-1 h-[400px]",children:a.map(o=>e.jsx(Re,{children:e.jsx(gs,{front:o.Front,back:o.Back,cardId:o.ID})},o.ID))}),e.jsx(ps,{}),e.jsx(vs,{})]}),e.jsx("div",{className:"absolute right-[-50px] top-1/2 transform -translate-y-1/2 flex flex-col gap-2",children:a.map((o,h)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${h===s.currentCardIndex?"bg-primary":"bg-gray-300"}`},h))})]})]})})},Ue=()=>e.jsx(Hs,{className:"ion-no-border fixed bottom-0 w-full",children:e.jsxs(he,{children:[e.jsx(ee,{slot:"start",children:e.jsx(w,{routerLink:"/home",children:e.jsx(I,{icon:Js})})}),e.jsx(B,{className:"mx-auto text-center text-sm text-gray-500",children:"Cowboy Cards 2025. Built for learning and fun."})]})}),Mt=s=>e.jsxs(P,{className:"rounded-lg border shadow-sm",children:[e.jsx(z,{children:e.jsx(M,{className:"text-xl font-semibold",children:"Class Leaderboard"})}),e.jsx(F,{children:e.jsx(oe,{className:"space-y-3",lines:"none",children:s.leaderboard===null?e.jsx("h1",{className:"text-center text-gray-500",children:"No scores available"}):s.leaderboard.map(t=>e.jsxs(U,{className:"muted-item p-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"font-medium text-lg",children:t.Username})}),e.jsxs("span",{slot:"end",className:"text-primary font-semibold",children:[t.ClassScore," points"]})]},t.UserID))})})]}),Gt=s=>e.jsx(e.Fragment,{children:s.loadingScores?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Calculating scores..."})]}):e.jsx(Mt,{leaderboard:s.leaderboardData})}),G=()=>{const[s,t]=r.useState(null),a=d=>t(d.nativeEvent),n=()=>t(null),l=d=>{var m;i.push(d),(m=document.querySelector("ion-menu"))==null||m.close()},i=Je(),{theme:u,setTheme:o}=fs(),h=()=>{o(u==="dark"?"light":"dark")};return e.jsxs(e.Fragment,{children:[e.jsxs(Ys,{side:"start",contentId:"main-content",children:[e.jsx(we,{children:e.jsx(he,{children:e.jsx(ee,{slot:"start",children:e.jsx($e,{children:e.jsx(w,{children:e.jsx(I,{icon:Ws})})})})})}),e.jsx(_,{children:e.jsxs(oe,{children:[e.jsx(U,{button:!0,onClick:()=>l("/home"),children:"My Dashboard"}),e.jsx(U,{button:!0,onClick:()=>l("/public-cards"),children:"Public Cards"}),e.jsx(U,{button:!0,onClick:()=>l("/public-classes"),children:"Public Classes"}),e.jsx(U,{button:!0,onClick:()=>l("/user-account"),children:"My Account"})]})})]}),e.jsx(we,{children:e.jsxs(he,{children:[e.jsx(ee,{slot:"start",children:e.jsx($e,{children:e.jsx(w,{children:e.jsx(I,{icon:Ks})})})}),e.jsx(as,{color:"primary",className:"text-lg md:text-xl lg:text-2xl font-bold hover:translate-x-1 transition-all duration-300 cursor-pointer",onClick:()=>i.push("/home"),children:"Cowboy Cards"}),e.jsxs(ee,{slot:"end",children:[e.jsx(w,{onClick:a,children:e.jsx(I,{icon:Qs,className:"text-[32px] stroke-[2]"})}),e.jsx(Xs,{event:s,isOpen:!!s,onDidDismiss:n,children:e.jsx(_,{className:"p-2",children:e.jsxs(oe,{children:[e.jsx(U,{button:!0,onClick:()=>{n(),i.push("/create-set")},children:"Create Set"}),e.jsx(U,{button:!0,onClick:()=>{n(),i.push("/class/create")},children:"Create Class"}),e.jsx(U,{button:!0,onClick:()=>{n(),i.push("/public-classes")},children:"Join Class"})]})})}),e.jsx(w,{fill:"clear",onClick:h,children:e.jsx(I,{slot:"icon-only",icon:u==="dark"?Zs:et})})]}),e.jsx(ee,{slot:"end",children:e.jsx(w,{routerLink:"/user-account",children:e.jsx(I,{icon:st,size:"large"})})})]})})]})},qt=s=>e.jsxs(P,{className:"mt-6",children:[e.jsx(z,{children:e.jsx(M,{className:"text-xl font-semibold",children:"Class Students"})}),e.jsx(F,{children:e.jsx(oe,{className:"space-y-3",lines:"none",children:s.students.map(t=>e.jsxs(U,{className:"muted-item p-3",children:[e.jsxs("span",{className:"font-medium",children:[t.FirstName," ",t.LastName]}),e.jsx("span",{slot:"end",className:"text-muted-foreground",children:t.email}),s.isTeacher&&e.jsx(I,{slot:"end",icon:ls,color:"danger",className:"cursor-pointer",onClick:()=>s.onDeleteStudent(t.UserID)})]},t.UserID))})})]}),Vt=s=>{const[t,a]=r.useState({isOpen:!1,studentId:null}),n=l=>{a({isOpen:!0,studentId:l})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(qt,{isTeacher:s.isTeacher,students:s.students,onDeleteStudent:n})}),e.jsx(xe,{isOpen:t.isOpen,onDidDismiss:()=>a({isOpen:!1,studentId:null}),header:"Confirm Deletion",message:"Are you sure you want to remove this student from the class? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Delete",handler:()=>{t.studentId!==null&&(s.handleActualDelete(t.studentId),console.log(`Student deletion initiated for ID: ${t.studentId}`))}}]})]})},Ht=()=>{const{id:s}=pe();console.log("id",s);const[t,a]=r.useState(0),[n,l]=r.useState(),[i,u]=r.useState("flashcards"),[o,h]=r.useState(!1),[d,m]=r.useState(),[p,x]=r.useState([]),[N,c]=r.useState([]),[f,j]=r.useState(null),[k,T]=r.useState(!1),[V,$]=r.useState([]),[S,D]=r.useState(!1),[ae,J]=r.useState(!1),[L,g]=r.useState({class_name:"",class_description:""}),[y,v]=r.useState(!1),R=()=>{console.log("Handling Edit"),g({class_name:(d==null?void 0:d.ClassName)||"",class_description:(d==null?void 0:d.ClassDescription)||""}),J(!0)},[Q,Ne]=r.useState({}),Ns=()=>{const E={};let A=!0;return L.class_name=L.class_name.trim(),L.class_description=L.class_description.trim(),L.class_name||(E.className="Class name is required",A=!1),L.class_description||(E.classDescription="Class description is required",A=!1),Ne(E),A},ys=async()=>{if(!Ns()){console.log("Form validation failed:",Q);return}const E=["class_name","class_description"];try{const A=E.map(q=>b(`/api/classes/${q}`,{method:"PUT",headers:{id:s,[q]:L[q]}}));await Promise.all(A),m(q=>({...q,ClassName:L.class_name,ClassDescription:L.class_description})),J(!1)}catch(A){console.error(A),alert("Failed to update some fields. Please try again.")}},bs=E=>{const{name:A}=E.target,q=E.detail.value;g(de=>({...de,[A]:q}))},ws=()=>{J(!1)},ie=r.useCallback(async()=>{T(!0),D(!0),j(null);try{const[E,A,q,de]=await Promise.all([b("/api/classes/",{method:"GET",headers:{id:s}}),b("/api/class_set/list_sets",{method:"GET",headers:{id:s}}),b("/api/class_user/members",{method:"GET",headers:{class_id:s}}),b("/api/classes/leaderboard",{method:"GET",headers:{id:s}})]);console.log("data",E),h(E.Role==="teacher"),m(E),console.log("sets",A),x(A||[]),console.log("users",q),c(q||[]),console.log("scores",de),$(de||[])}catch(E){let A="Unknown error";E instanceof Error&&(A=E.message),j(`Error fetching class data: ${A}`),m(void 0),x([]),c([]),$([])}finally{T(!1),D(!1)}},[s]);r.useEffect(()=>{ie()},[ie]);const Ss=async E=>{if(E!==null)try{await b("/api/class_user/",{method:"DELETE",headers:{student_id:E,id:s}}),ie()}catch(A){console.error("Error deleting student:",A),j("Error deleting student")}};return r.useEffect(()=>{n&&n.on("select",()=>{a(n.selectedScrollSnap())})},[n]),e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsxs(_,{className:"ion-padding",children:[e.jsxs("div",{id:"main-content",className:"max-w-4xl mx-auto",children:[f&&e.jsx("div",{className:"text-red-500",children:f}),e.jsx($t,{classData:d,isTeacher:o,loading:k,handleEdit:R,isEditing:ae,updatedInfo:L,errors:Q,handleChange:bs,handleSave:ys,handleCancel:ws}),e.jsx(Ut,{isTeacher:o,classId:s,onAddSetClick:()=>v(!0)}),e.jsx(Bt,{selectedTab:i,onTabChange:u}),i==="leaderboard"&&e.jsx(Gt,{leaderboardData:V,loadingScores:S}),i==="flashcards"&&e.jsx(zt,{flashcardSets:p,currentCardIndex:t,setApi:l,loading:k}),i==="students"&&e.jsx(Vt,{isTeacher:o,students:N,handleActualDelete:Ss})]}),e.jsx(Ue,{})]}),e.jsx(Rt,{isOpen:y,onDidDismiss:()=>v(!1),classId:s,existingSetIds:p.map(E=>E.ID),onSetAdded:ie})]})},Jt=()=>{const[s,t]=r.useState(!1),[a,n]=r.useState(!1),[l,i]=r.useState(null),[u,o]=r.useState({className:"",description:""}),[h,d]=r.useState(!1);return r.useEffect(()=>{async function m(){if(s){n(!0),i(null);try{const p=await b("/api/classes",{method:"POST",headers:{class_name:u.className,class_description:u.description}});console.log("Class created successfully:",p),t(!1),o({className:"",description:""}),d(!0),n(!1)}catch(p){i(`Failed to create class: ${p.message}`)}finally{n(!1)}}}s&&m()},[s,u]),e.jsxs(_,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[l&&e.jsx("div",{className:"text-red-500 mt-2",children:l}),e.jsxs("form",{children:[e.jsx(P,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(F,{children:[e.jsx(W,{placeholder:"Enter Class Name",value:u.className,onIonChange:m=>o(p=>({...p,className:m.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),e.jsx(W,{placeholder:"Enter Class Description",value:u.description,onIonChange:m=>o(p=>({...p,description:m.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}})]})}),e.jsx("div",{className:"flex flex-col md:flex-row justify-center md:justify-end gap-4 mt-8",children:e.jsx(w,{color:"success",disabled:a,onClick:()=>t(!0),children:a?"Creating...":"Create Class"})})]}),h&&e.jsx(B,{children:e.jsx("p",{children:"Class created successfully!"})})]})]})},Yt=()=>{const s=je(),[t,a]=r.useState(""),[n,l]=r.useState(""),[i,u]=r.useState({title:"",description:""}),[o,h]=r.useState(!1),[d,m]=r.useState(null),p=async()=>{h(!0),m(null);const x={title:"",description:""};let N=!1;if(t.trim()||(x.title="Title is required",N=!0),n.trim()||(x.description="Description is required",N=!0),u(x),N){h(!1);return}try{const c=await b("/api/flashcards/sets",{method:"POST",headers:{set_name:t,set_description:n}});s.push(`/set-overview/${c.ID}`)}catch(c){console.error("Error saving flashcard set:",c),m(`Failed to save flashcard set: ${c.message}`)}finally{h(!1)}};return e.jsxs(_,{className:"ion-padding",children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[o&&e.jsx("div",{children:"Loading..."}),d&&e.jsx("div",{className:"text-red-500 mt-2",children:d}),e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Create New Flashcard Set"}),e.jsx(P,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(F,{children:[e.jsx(W,{placeholder:"Enter set title",value:t,onIonChange:x=>a(x.detail.value),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),i.title&&e.jsx(B,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:i.title})}),e.jsx(W,{placeholder:"Enter set description",value:n,onIonChange:x=>l(x.detail.value),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}}),i.description&&e.jsx(B,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:i.description})})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(w,{color:"success",className:"rounded-lg shadow-sm w-full md:w-auto",onClick:p,disabled:o,children:o?"Creating...":"Create Set"})})]})]})},Wt=s=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Edit Cards"}),s.cards.map((t,a)=>e.jsx(P,{className:"mb-4 rounded-lg border shadow-sm",children:e.jsxs(F,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"text-sm font-semibold text-gray-600",children:["Card ",a+1," ",t.ID>0?"(Existing)":"(New)"]}),e.jsx(w,{fill:"clear",color:"danger",size:"small",onClick:()=>s.onRemoveCard(a),className:"-mt-2 -mr-2",children:e.jsx(I,{slot:"icon-only",icon:ls})})]}),e.jsx(W,{label:`Front (Card ${a+1})`,labelPlacement:"stacked",placeholder:"Front of card",value:t.Front,onIonChange:n=>s.onUpdateCard(a,"Front",n.detail.value),rows:2,autoGrow:!0,className:"mb-3",style:{resize:"none"}}),e.jsx(W,{label:`Back (Card ${a+1})`,labelPlacement:"stacked",placeholder:"Back of card",value:t.Back,onIonChange:n=>s.onUpdateCard(a,"Back",n.detail.value),rows:2,autoGrow:!0,style:{resize:"none"}})]})},t.ID)),e.jsx("div",{className:"flex justify-center mt-4 mb-6",children:e.jsxs(w,{onClick:s.onAddCard,fill:"outline",children:[e.jsx(I,{slot:"start",icon:Ie})," Add Card"]})})]}),Kt=s=>e.jsx(P,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(F,{children:[e.jsx(W,{label:"Set Title",labelPlacement:"stacked",placeholder:"Enter set title",value:s.setName,onIonChange:t=>s.onNameChange(t.detail.value),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),e.jsx(W,{label:"Set Description",labelPlacement:"stacked",placeholder:"Enter set description",value:s.setDescription,onIonChange:t=>s.onDescriptionChange(t.detail.value),rows:2,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}})]})}),Qt=()=>{const{id:s}=pe(),[t]=Se(),[a,n]=r.useState(null),[l,i]=r.useState([]),[u,o]=r.useState(""),[h,d]=r.useState(""),[m,p]=r.useState([]),[x,N]=r.useState(!0),[c,f]=r.useState(null),[j,k]=r.useState(!1),[T,V]=r.useState(null),$=r.useCallback(async()=>{if(!s){f("Set ID is missing from URL."),N(!1);return}N(!0),f(null),V(null);try{const[g,y]=await Promise.all([b("/api/flashcards/sets/",{method:"GET",headers:{id:s}}),b("/api/flashcards/list",{method:"GET",headers:{set_id:s}})]);n(g),i(y),o(g.SetName),d(g.SetDescription),p(y?y.map(v=>({...v,ID:v.ID||0})):[])}catch(g){console.error("Error fetching data for EditSet:",g);let y="Unknown error";g instanceof Error&&(y=g.message),f(`Failed to load set data: ${y}`)}finally{N(!1)}},[s]);r.useEffect(()=>{$()},[$]);const S=(g,y)=>{const v=y??"";g==="SetName"?o(v):d(v)},D=()=>{if(!a)return;const g={ID:0,Front:"",Back:"",SetID:a.ID,CreatedAt:new Date().toISOString(),UpdatedAt:new Date().toISOString()};p([...m,g])},ae=g=>{p(m.filter((y,v)=>v!==g))},J=(g,y,v)=>{const R=v??"";p(m.map((Q,Ne)=>Ne===g?{...Q,[y]:R}:Q))},L=async()=>{if(!a||j)return;k(!0),V(null);const g=[];u!==a.SetName&&g.push(b("/api/flashcards/sets/set_name",{method:"PUT",headers:{id:a.ID,set_name:u}})),h!==a.SetDescription&&g.push(b("/api/flashcards/sets/set_description",{method:"PUT",headers:{id:a.ID,set_description:h}}));const y=new Set(m.map(v=>v.ID).filter(v=>v>0));l&&l.forEach(v=>{y.has(v.ID)||g.push(b("/api/flashcards",{method:"DELETE",headers:{id:v.ID}}))}),m.forEach(v=>{if(v.ID<=0)g.push(b("/api/flashcards",{method:"POST",headers:{front:v.Front,back:v.Back,id:a.ID}}));else{const R=l.find(Q=>Q.ID===v.ID);R&&(v.Front!==R.Front&&g.push(b("/api/flashcards/front",{method:"PUT",headers:{id:v.ID,front:v.Front}})),v.Back!==R.Back&&g.push(b("/api/flashcards/back",{method:"PUT",headers:{id:v.ID,back:v.Back}})))}});try{await Promise.all(g),t({message:"Changes saved successfully!",duration:2e3,color:"success"}),await $()}catch(v){console.error("Error saving changes:",v);let R="Unknown error during save";v instanceof Error&&(R=v.message),V(`Failed to save changes: ${R}`),t({message:`Save failed: ${R}`,duration:3e3,color:"danger"})}finally{k(!1)}};return e.jsxs(tt,{children:[e.jsx(G,{}),e.jsx(_,{className:"ion-padding",children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Edit Flashcard Set"}),e.jsx(Be,{isOpen:x,message:"Loading set data..."}),e.jsx(Be,{isOpen:j,message:"Saving changes..."}),c&&!x&&e.jsx(B,{color:"danger",className:"block mb-4",children:e.jsxs("p",{children:["Error loading data: ",c]})}),T&&!j&&e.jsx(B,{color:"danger",className:"block mb-4",children:e.jsxs("p",{children:["Error saving: ",T]})}),!x&&!c&&a&&e.jsxs(e.Fragment,{children:[e.jsx(Kt,{setName:u,setDescription:h,onNameChange:g=>S("SetName",g),onDescriptionChange:g=>S("SetDescription",g)}),e.jsx(Wt,{cards:m,onAddCard:D,onRemoveCard:ae,onUpdateCard:J}),e.jsx("div",{className:"flex justify-end",children:e.jsx(w,{onClick:L,color:"primary",disabled:j,children:j?"Saving...":"Save Changes"})})]})]})}),e.jsx(Ue,{})]})},Xt=()=>{const{id:s}=pe();je();const[t,a]=r.useState(""),[n,l]=r.useState(""),[i,u]=r.useState([]),[o,h]=r.useState(),[d,m]=r.useState(0),[p,x]=r.useState(!0);r.useEffect(()=>{const c=async()=>{try{const j=await b("/api/flashcards/sets/",{method:"GET",headers:{id:s}});a(j.SetName),l(j.SetDescription)}catch(j){console.error("Failed to fetch set info",j)}},f=async()=>{x(!0);try{const j=await b("/api/flashcards/list",{method:"GET",headers:{set_id:s}});u(Array.isArray(j)?j.map(k=>({ID:k.ID,Front:k.Front,Back:k.Back,SetID:k.SetID,CreatedAt:k.CreatedAt,UpdatedAt:k.UpdatedAt})):[])}catch(j){console.error("Failed to fetch cards",j),u([])}finally{x(!1)}};s&&(c(),f())},[s]),r.useEffect(()=>{if(!o)return;const c=()=>{m(o.selectedScrollSnap())};return c(),o.on("select",c),o.on("reInit",c),()=>{o.off("select",c),o.off("reInit",c)}},[o]);const N=()=>{o&&o.scrollNext()};return e.jsxs(_,{className:"ion-padding",children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(w,{className:"rounded-lg",fill:"outline",style:{"--border-radius":"0.5rem"},routerLink:`/set-overview/${s}`,children:"Back"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:t}),e.jsx("p",{className:"text-gray-500",children:n})]})]}),e.jsx("div",{className:"w-full max-w-xl mx-auto relative py-8 min-h-[400px] flex items-center justify-center",children:p?e.jsx(Y,{name:"circular"}):i.length===0?e.jsx("div",{className:"text-center text-gray-500 text-lg py-20",children:"This set has no cards yet."}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{orientation:"vertical",setApi:h,className:"w-full",children:e.jsx(Oe,{className:"-mt-1 h-[400px]",children:i.map((c,f)=>e.jsx(Re,{children:e.jsx(gs,{front:c.Front,back:c.Back,onAdvance:N,cardId:c.ID})},f))})}),e.jsx("div",{className:"absolute right-[-50px] top-1/2 transform -translate-y-1/2 flex flex-col gap-2",children:i.map((c,f)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${f===d?"bg-primary":"bg-gray-300"}`},f))})]})})]})]})},Zt=()=>{const[s,t]=r.useState("classes"),[a,n]=r.useState([]),[l,i]=r.useState([]),[u,o]=r.useState(!1),[h,d]=r.useState(!1),[m,p]=r.useState(null);return r.useEffect(()=>{console.log("Classes state updated:",a)},[a]),r.useEffect(()=>{const x=async()=>{o(!0),p(null);try{const c=await b("/api/class_user/classes");console.log("Classes: ",c),n(c)}catch(c){p(`Error fetching classes: ${c.message}`)}finally{o(!1)}},N=async()=>{d(!0);try{const c=await b("/api/set_user/list");console.log("Sets: ",c),i(c)}catch(c){p(`Error fetching sets: ${c.message}`)}finally{d(!1)}};x(),N()},[]),e.jsx(e.Fragment,{children:e.jsxs(_,{className:"ion-padding flex flex-col min-h-screen",fullscreen:!0,children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 flex-grow",children:[m&&e.jsx("div",{className:"text-red-500 mt-2",children:m}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:s==="classes"?"My Classes":"Personal Flashcard Sets"}),e.jsx("div",{className:"flex items-center gap-2 mt-4 md:mt-0",children:e.jsxs(w,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},href:s==="classes"?"/create-class":"/create-set",children:[e.jsx(I,{slot:"start",icon:Ie})," ",s==="classes"?"Add Class":"Add Set"]})})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(rs,{value:s,onIonChange:x=>t(x.detail.value||"classes"),style:{"--background":"var(--ion-color-light)"},children:[e.jsxs(re,{value:"classes",children:[e.jsx(I,{icon:at,className:"mr-2"}),e.jsx(te,{children:"My Classes"})]}),e.jsxs(re,{value:"flashcards",children:[e.jsx(I,{icon:ns,className:"mr-2"}),e.jsx(te,{children:"My Cards"})]})]})}),s==="classes"&&e.jsx(e.Fragment,{children:u?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading classes..."})]}):a===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any classes. Join a class to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(x=>e.jsx(le,{to:`/class/${x.ClassID}`,children:e.jsxs(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(z,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(M,{className:"text-2xl font-semibold leading-none tracking-tight",children:x.ClassName}),e.jsx(fe,{className:"text-sm text-muted-foreground",children:x.ClassDescription})]}),e.jsx(F,{})]})},x.ClassID))})}),s==="flashcards"&&e.jsx(e.Fragment,{children:h?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading sets..."})]}):l===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any sets. Join a set to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:l.map(x=>e.jsx(le,{to:`/set-overview/${x.SetID}`,children:e.jsxs(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(z,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(M,{className:"text-2xl font-semibold leading-none tracking-tight",children:x.SetName}),e.jsx(fe,{className:"text-sm text-muted-foreground",children:x.SetDescription})]}),e.jsx(F,{})]})},x.SetID))})})]}),e.jsx(Ue,{})]})})},ea=()=>e.jsx(_,{children:e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center from-white to-gray-50",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-primary mb-2",children:"CowboyCards"}),e.jsx("p",{children:"Master any subject with smart flashcards"})]}),e.jsx(cs,{})]})}),sa=()=>{const s=rt();return r.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]),e.jsxs(_,{children:[e.jsx(G,{}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})]})},ta=()=>{const[s,t]=r.useState(null),[a,n]=r.useState(!1),[l,i]=r.useState([]),[u,o]=r.useState(""),h=l.filter(d=>d.SetName.toLowerCase().includes(u.toLowerCase())||d.SetDescription&&d.SetDescription.toLowerCase().includes(u.toLowerCase()));return r.useEffect(()=>{async function d(){n(!0),t(null);try{const m=await b("/api/flashcards/sets/list");i(m)}catch(m){console.error("Error fetching flashcard sets:",m),t(`Error fetching flashcard sets: ${m.message}`)}finally{n(!1)}}d()},[]),e.jsxs(_,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 w-1/2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold pb-8",children:"Public Flashcard Sets"}),a&&e.jsx("div",{children:"Loading..."}),s&&e.jsx("div",{className:"text-red-500 mt-2",children:s}),e.jsx(nt,{value:u,onIonInput:d=>o(d.target.value),placeholder:"Search flashcard sets",className:"mb-4 w-1/2"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:h.map(d=>e.jsx(le,{to:`/flashcards/${d.ID}`,children:e.jsx(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(z,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(M,{className:"text-2xl font-semibold leading-none tracking-tight",children:d.SetName}),e.jsx(fe,{className:"text-sm text-gray-600",children:d.SetDescription||"No description"})]})})},d.ID))})]})]})},aa=()=>{const[s,t]=r.useState([]),[a,n]=r.useState(!1),[l,i]=r.useState(null);return r.useEffect(()=>{(async()=>{n(!0),i(null);try{const o=await b("/api/classes/list");t(o),n(!1)}catch(o){i(`Error fetching classes: ${o.message}`)}finally{n(!1)}})()},[]),e.jsxs(_,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold pb-8",children:"Public Classes"}),a&&e.jsx("div",{children:"Loading..."}),l&&e.jsx("div",{className:"text-red-500 mt-2",children:l}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(u=>e.jsx(le,{to:`/class/${u.ID}`,children:e.jsx(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(z,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(M,{className:"text-2xl font-semibold leading-none tracking-tight",children:u.ClassName}),e.jsx(fe,{className:"text-sm text-gray-600",children:u.ClassDescription||"No description"}),e.jsx(w,{expand:"block",color:"primary",className:"mt-4",onClick:async()=>{try{const o=await b("/api/class_user",{method:"POST",headers:{class_id:u.ID,role:"student"}});console.log("Join class response:",o)}catch(o){console.error("Error joining class:",o)}},children:"Join Class"})]})})},u.ID))})]})]})},ra=()=>{const{id:s}=pe(),t=je(),[a,n]=r.useState(""),[l,i]=r.useState(""),[u,o]=r.useState([]),[h,d]=r.useState(!0),[m,p]=r.useState(!1);r.useEffect(()=>{const N=async()=>{try{const f=await b("/api/flashcards/sets/",{method:"GET",headers:{id:s}});n(f.SetName),i(f.SetDescription)}catch(f){console.error("Failed to fetch set info",f)}},c=async()=>{d(!0);try{const f=await b("/api/flashcards/list",{method:"GET",headers:{set_id:s}});o(Array.isArray(f)?f:[])}catch(f){console.error("Failed to fetch cards",f),o([])}finally{d(!1)}};s&&(N(),c())},[s]);const x=async()=>{if(!s){console.error("Cannot delete set: ID is missing.");return}try{await b("/api/flashcards/sets/",{method:"DELETE",headers:{id:s}}),t.push("/student-dashboard")}catch(N){console.error("Failed to delete set:",N)}};return e.jsxs(_,{className:"ion-padding",children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 pr-4",children:[e.jsx(w,{className:"rounded-lg",fill:"outline",style:{"--border-radius":"0.5rem"},onClick:()=>window.history.back(),children:"Back"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-3xl font-bold",children:a}),e.jsx("p",{className:"text-base mt-1 text-gray-700",children:l})]})]}),e.jsxs("div",{className:"self-start md:self-center flex gap-2 md:mt-0 mt-4 w-full md:w-auto",children:[e.jsx(w,{className:"rounded-lg w-1/3 md:w-auto",fill:"outline",style:{"--border-radius":"0.5rem"},routerLink:`/edit-set/${s}`,children:"Edit Set"}),e.jsx(w,{className:"rounded-lg w-1/3 md:w-auto",color:"primary",style:{"--border-radius":"0.5rem"},routerLink:`/flashcards/${s}`,children:"Study Set"}),e.jsx(w,{className:"rounded-lg w-1/3 md:w-auto",color:"danger",style:{"--border-radius":"0.5rem"},onClick:()=>p(!0),children:"Delete Set"})]})]}),e.jsx("div",{className:"mt-8 min-h-[200px] flex items-center justify-center",children:h?e.jsx(Y,{name:"circular"}):u.length===0?e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-900 dark:text-gray-400 mb-4",children:"This set has no cards yet."}),e.jsx(w,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},routerLink:`/edit-set/${s}`,children:"Add Cards"})]}):e.jsx("div",{className:"w-full",children:u.map((N,c)=>e.jsx(P,{className:"mb-4 rounded-lg border shadow-sm",children:e.jsxs(F,{children:[e.jsx("div",{className:"border-b border-gray-300 mb-3 pb-1 m-4",children:e.jsxs(B,{className:"text-md font-semibold text-gray-900 dark:text-gray-300",children:["Card ",c+1]})}),e.jsxs("div",{className:"flex flex-row justify-between items-start",children:[e.jsx("div",{className:"w-3/12 pr-4 border-r border-gray-300 m-4",children:e.jsx(B,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:N.Front})}),e.jsx("div",{className:"w-9/12 pl-4 m-4",children:e.jsx(B,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:N.Back})})]})]})},c))})})]}),e.jsx(xe,{isOpen:m,onDidDismiss:()=>p(!1),header:"Confirm Deletion",message:"Are you sure you want to delete this set? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Delete canceled")}},{text:"Delete",role:"destructive",handler:()=>{x()}}]})]})},H=s=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium",children:[s.label,":"]}),e.jsx("span",{children:s.value})]}),na=s=>{var t,a,n,l,i,u,o,h,d,m,p,x,N,c;return e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs(P,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(z,{className:"p-6",children:e.jsx(M,{className:"text-xl font-semibold text-primary",children:"Account Information"})}),e.jsx(F,{className:"p-6 pt-0",children:s.isEditing?e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{type:"text",label:"First Name",name:"first_name",value:((t=s.updatedInfo)==null?void 0:t.first_name)||"",error:s.errors.first_name,onChange:s.handleChange}),e.jsx(se,{type:"text",label:"Last Name",name:"last_name",value:((a=s.updatedInfo)==null?void 0:a.last_name)||"",error:s.errors.last_name,onChange:s.handleChange}),e.jsx(se,{type:"text",label:"Username",name:"username",value:((n=s.updatedInfo)==null?void 0:n.username)||"",error:s.errors.username,onChange:s.handleChange}),e.jsx(se,{type:"email",label:"Email",name:"email",value:((l=s.updatedInfo)==null?void 0:l.email)||"",error:s.errors.email,onChange:s.handleChange}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(w,{onClick:s.handleSave,children:"Save Changes"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{label:"First Name",value:(i=s.userInfo)==null?void 0:i.first_name}),e.jsx(H,{label:"Last Name",value:(u=s.userInfo)==null?void 0:u.last_name}),e.jsx(H,{label:"Username",value:(o=s.userInfo)==null?void 0:o.username}),e.jsx(H,{label:"Email",value:(h=s.userInfo)==null?void 0:h.email}),e.jsxs(w,{fill:"outline",onClick:s.handleEdit,className:"mt-4",children:[e.jsx(I,{slot:"start",icon:De}),"Edit Info"]})]})})]}),e.jsxs(P,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(z,{className:"p-6",children:e.jsx(M,{className:"text-xl font-semibold text-primary",children:"Account Stats"})}),e.jsx(F,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(H,{label:"Account Created",value:(d=s.userInfo)==null?void 0:d.created_at}),e.jsx(H,{label:"Login Streak",value:(m=s.userInfo)==null?void 0:m.login_streak}),e.jsx(H,{label:"Classes Taken",value:(p=s.userInfo)==null?void 0:p.numClasses}),e.jsx(H,{label:"Cards Mastered/Studied",value:`${(x=s.userInfo)==null?void 0:x.cardsMastered} / ${(N=s.userInfo)==null?void 0:N.cardsStudied}`}),e.jsx(H,{label:"Total Card Views",value:(c=s.userInfo)==null?void 0:c.totalCardViews})]})})]})]})};function la(s){const[t,a]=r.useState(s.streak>0),[n,l]=r.useState(!t),i=r.useRef(s.streak);return r.useEffect(()=>{if(a(s.streak>0),s.streak===0){l(!0);const u=setTimeout(()=>l(!1),3e3);return()=>clearTimeout(u)}else l(!1);i.current=s.streak},[s.streak]),e.jsxs(P,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(z,{className:"pb-16",children:e.jsx(M,{className:"text-xl font-semibold text-primary",children:"Login Streak"})}),e.jsxs(F,{className:"py-6 px-0 flex flex-row items-center justify-center gap-6",children:[e.jsx(ze.div,{animate:n?{opacity:.4,scale:1,filter:"grayscale(1)"}:{scale:[1,1.15,1],filter:["drop-shadow(0 0 2px #fb923c)","drop-shadow(0 0 8px #fb923c)","drop-shadow(0 0 2px #fb923c)"]},transition:n?{duration:.3}:{repeat:1/0,duration:1.2,repeatDelay:2},children:e.jsx(lt,{className:"w-16 h-16 text-orange-500"})}),e.jsx(ze.span,{initial:{y:16,opacity:0},animate:{y:0,opacity:1},transition:{type:"spring",stiffness:260,damping:20},className:"text-6xl font-extrabold text-orange-500 tabular-nums",children:e.jsx(ot,{start:i.current,end:s.streak,duration:.7,preserveValue:!0})},s.streak)]})]})}const oa=s=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 py-6",children:[e.jsx(la,{streak:s.streak}),e.jsxs(P,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(z,{className:"p-6",children:e.jsx(M,{className:"text-xl font-semibold text-primary",children:"Account Options"})}),e.jsx(F,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{children:e.jsxs(ct,{label:"Theme",value:s.theme,onIonChange:t=>s.setTheme(t.detail.value),interface:"popover",placeholder:"Select Theme",children:[e.jsx(Me,{value:"light",children:"Light"}),e.jsx(Me,{value:"dark",children:"Dark"})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Change Your Password"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Reset your account password."})]}),e.jsx(w,{onClick:()=>s.setShowPasswordAlert(!0),children:"Change Password"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Delete Your Account"}),e.jsx("p",{className:"text-xs text-gray-600",children:"This will delete all account data and can't be undone."})]}),e.jsx(w,{color:"danger",onClick:()=>s.setShowDeleteAlert(!0),children:"Delete Account"})]})]})})]})]}),e.jsx(xe,{isOpen:s.showPasswordAlert,onDidDismiss:()=>s.setShowPasswordAlert(!1),header:"Change Password",inputs:[{name:"oldPassword",type:"password",placeholder:"Old Password"},{name:"newPassword",type:"password",placeholder:"New Password"},{name:"confirmPassword",type:"password",placeholder:"Confirm New Password"}],buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Save",handler:t=>t.newPassword!==t.confirmPassword?(s.presentToast({message:"Passwords do not match",duration:2e3,color:"danger"}),!0):(console.log("Password changed"),!0)}]}),e.jsx(xe,{isOpen:s.showDeleteAlert,onDidDismiss:()=>s.setShowDeleteAlert(!1),header:"Confirm Deletion",message:"Are you sure you want to delete your account? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Delete",handler:()=>{console.log("Account deleted")}}]})]}),ca=()=>{const{theme:s,setTheme:t}=fs(),[a,n]=r.useState(),[l,i]=r.useState(!0),[u,o]=r.useState(null),[h,d]=r.useState(null),[m,p]=r.useState(!1),[x,N]=r.useState(!1),[c,f]=r.useState(!1),[j,k]=r.useState(a),T=g=>{d(h===g?null:g)},V=()=>{k(a),f(!0)},$=async()=>{if(!S())return;const g=["first_name","last_name","username","email"];try{const y=g.filter(v=>j[v]!==a[v]).map(v=>b(`/api/users/${v}`,{method:"PUT",headers:{[v]:j[v]}}));await Promise.all(y),n(j),f(!1)}catch(y){console.error(y),alert("Failed to update some fields. Please try again.")}},S=()=>{const g={};let y=!0;return j.first_name||(g.first_name="First name is required",y=!1),j.last_name||(g.last_name="Last name is required",y=!1),j.email?/\S+@\S+\.\S+/.test(j.email)||(g.email="Email is invalid",y=!1):(g.email="Email is required",y=!1),j.username||(g.username="Username is required",y=!1),j.first_name=j.first_name.trim(),j.last_name=j.last_name.trim(),j.email=j.email.trim(),j.username=j.username.trim(),ae(g),y},[D,ae]=r.useState({}),J=g=>{const{name:y}=g.target,v=g.detail.value;k(R=>({...R,[y]:v}))};r.useEffect(()=>{(async()=>{i(!0),o(null);try{const y=await b("/api/users/",{method:"GET",headers:{}});n(y),k(y),console.log("data",y)}catch(y){console.log(`Failed to fetch User Data: ${y.message}`),o(`Failed to fetch User Data: ${y.message}`)}finally{i(!1)}})()},[]);const[L]=Se();return e.jsxs(_,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("p",{className:"text-xl font-semibold text-primary",children:["Welcome back, ",(a==null?void 0:a.username)||"User","!"]})}),e.jsxs(w,{onClick:()=>window.history.back(),fill:"outline",className:"mb-6",children:[e.jsx(I,{slot:"start",icon:Ce}),"Back"]}),l&&e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading account details..."})]}),u&&!l&&e.jsx("div",{className:"text-red-500 text-center p-4 border border-red-500 rounded-md",children:u}),!l&&!u&&a&&e.jsxs(e.Fragment,{children:[e.jsx(na,{isEditing:c,errors:D,handleChange:J,handleSave:$,updatedInfo:j,userInfo:a,handleEdit:V}),e.jsx(oa,{streak:(a==null?void 0:a.login_streak)??0,isEditing:c,errors:D,handleChange:J,handleSave:$,updatedInfo:j,userInfo:a,expandedClass:h,toggleClassDetails:T,showPasswordAlert:m,setShowPasswordAlert:p,showDeleteAlert:x,setShowDeleteAlert:N,theme:s,setTheme:t,presentToast:L})]})]})]})};it();const ia=new dt;function da(){return e.jsx(ut,{client:ia,children:e.jsx(Ot,{children:e.jsxs(Ft,{children:[e.jsx(mt,{children:e.jsx(ht,{children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsxs(xt,{children:[e.jsx(O,{exact:!0,path:"/",component:ea}),e.jsx(O,{exact:!0,path:"/home",component:Zt}),e.jsx(O,{exact:!0,path:"/class/:id",component:Ht}),e.jsx(O,{exact:!0,path:"/auth",component:cs}),e.jsx(O,{exact:!0,path:"/reset-password",component:kt}),e.jsx(O,{exact:!0,path:"/public-cards",component:ta}),e.jsx(O,{exact:!0,path:"/user-account",component:ca}),e.jsx(O,{exact:!0,path:"/flashcards/:id",component:Xt}),e.jsx(O,{exact:!0,path:"/create-set",component:Yt}),e.jsx(O,{exact:!0,path:"/edit-set/:id",component:Qt}),e.jsx(O,{exact:!0,path:"/create-class",component:Jt}),e.jsx(O,{exact:!0,path:"/public-classes",component:aa}),e.jsx(O,{exact:!0,path:"/set-overview/:id",component:ra}),e.jsx(O,{component:sa})]})})})}),e.jsx(_t,{}),e.jsx(Et,{})]})})})}const ua=document.getElementById("root"),ma=ft(ua);ma.render(e.jsx(da,{}));export{ja as _,ga as a,fa as g};
//# sourceMappingURL=index-CXxgtYOt.js.map
