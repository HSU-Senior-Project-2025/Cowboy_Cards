import{t as Is,c as ks,r,j as e,a as je,S as Ds,R as Je,u as Ye,C as We,L as le,b as Es,d as Ts,$ as As,V as Ke,e as Qe,A as Xe,f as Ze,X as es,T as ss,D as ts,P as Ps,g as as,h as Fs,i as Ie,I as _s,k as Ce,l as xe,m as rs,n as ee,o as w,p as P,q as Y,s as B,v as Ls,w as oe,x as $,y as Os,z as te,B as C,E as ie,F as ke,G as De,H as Rs,J as ns,K as re,M as ls,N as Us,O as $s,Q as Bs,U as Ms,W as zs,Y as Gs,Z as pe,_ as qs,a0 as Vs,a1 as Hs,a2 as A,a3 as M,a4 as z,a5 as O,a6 as Js,a7 as Ys,a8 as Ws,a9 as Be,aa as Ks,ab as Qs,ac as Xs,ad as Zs,ae as et,af as st,ag as tt,ah as os,ai as fe,aj as ve,ak as W,al as at,am as Me,an as rt,ao as ge,ap as nt,aq as lt,ar as ot,as as ct,at as ze,au as it,av as dt,aw as ut,ax as mt,ay as ht,az as xt,aA as L,aB as ft}from"./nm-BnW8xv9n.js";import"./index-D1rKs0W_.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function a(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(l){if(l.ep)return;l.ep=!0;const o=a(l);fetch(l.href,o)}})();var ga=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ja(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function I(...s){return Is(ks(s))}const gt=je("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ee=r.forwardRef(({className:s,variant:t,...a},n)=>e.jsx("div",{ref:n,role:"alert",className:I(gt({variant:t}),s),...a}));Ee.displayName="Alert";const jt=r.forwardRef(({className:s,...t},a)=>e.jsx("h5",{ref:a,className:I("mb-1 font-medium leading-none tracking-tight",s),...t}));jt.displayName="AlertTitle";const Te=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:I("text-sm [&_p]:leading-relaxed",s),...t}));Te.displayName="AlertDescription";const pt=je("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),K=r.forwardRef(({className:s,variant:t,size:a,asChild:n=!1,...l},o)=>{const u=n?Ds:"button";return e.jsx(u,{className:I(pt({variant:t,size:a,className:s})),ref:o,...l})});K.displayName="Button";const ce=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:I("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));ce.displayName="Card";const Ae=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:I("flex flex-col space-y-1.5 p-6",s),...t}));Ae.displayName="CardHeader";const Pe=r.forwardRef(({className:s,...t},a)=>e.jsx("h3",{ref:a,className:I("text-2xl font-semibold leading-none tracking-tight",s),...t}));Pe.displayName="CardTitle";const Fe=r.forwardRef(({className:s,...t},a)=>e.jsx("p",{ref:a,className:I("text-sm text-muted-foreground",s),...t}));Fe.displayName="CardDescription";const _e=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:I("p-6 pt-0",s),...t}));_e.displayName="CardContent";const Le=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:I("flex items-center p-6 pt-0",s),...t}));Le.displayName="CardFooter";const X=r.forwardRef(({className:s,type:t,...a},n)=>e.jsx("input",{type:t,className:I("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...a}));X.displayName="Input";const vt=je("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Z=r.forwardRef(({className:s,...t},a)=>e.jsx(Je,{ref:a,className:I(vt(),s),...t}));Z.displayName=Je.displayName;const Nt=1,bt=1e6;let ye=0;function yt(){return ye=(ye+1)%Number.MAX_SAFE_INTEGER,ye.toString()}const we=new Map,Ge=s=>{if(we.has(s))return;const t=setTimeout(()=>{we.delete(s),ne({type:"REMOVE_TOAST",toastId:s})},bt);we.set(s,t)},wt=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,Nt)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?Ge(a):s.toasts.forEach(n=>{Ge(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},me=[];let he={toasts:[]};function ne(s){he=wt(he,s),me.forEach(t=>{t(he)})}function St({...s}){const t=yt(),a=l=>ne({type:"UPDATE_TOAST",toast:{...l,id:t}}),n=()=>ne({type:"DISMISS_TOAST",toastId:t});return ne({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:l=>{l||n()}}}),{id:t,dismiss:n,update:a}}function cs(){const[s,t]=r.useState(he);return r.useEffect(()=>(me.push(t),()=>{const a=me.indexOf(t);a>-1&&me.splice(a,1)}),[s]),{...s,toast:St,dismiss:a=>ne({type:"DISMISS_TOAST",toastId:a})}}const qe={method:"GET",headers:{},credentials:"include"},Ct="https://cowboy-cards.dsouth.org";async function y(s="",t=qe){const a={...qe,...t};try{const n=await fetch(Ct+s,a);if(!n.ok){console.log("resp",n);const o=await n.text();throw new Error(`HTTP error! Status: ${n.status}, Message: ${o}`)}return await n.json()}catch(n){throw console.error("API request failed:",n),n}}const It="modulepreload",kt=function(s,t){return new URL(s,t).href},Ve={},pa=function(t,a,n){let l=Promise.resolve();if(a&&a.length>0){const u=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),x=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));l=Promise.allSettled(a.map(i=>{if(i=kt(i,n),i in Ve)return;Ve[i]=!0;const h=i.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(!!n)for(let d=u.length-1;d>=0;d--){const v=u[d];if(v.href===i&&(!h||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${g}`))return;const f=document.createElement("link");if(f.rel=h?"stylesheet":It,h||(f.as="script"),f.crossOrigin="",f.href=i,x&&f.setAttribute("nonce",x),document.head.appendChild(f),h)return new Promise((d,v)=>{f.addEventListener("load",d),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${i}`)))})}))}function o(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return l.then(u=>{for(const c of u||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})},is=()=>{const[s,t]=r.useState(!0),[a,n]=r.useState(!1),[l,o]=r.useState(""),[u,c]=r.useState(""),[x,i]=r.useState(""),[h,g]=r.useState(""),[m,f]=r.useState(""),[d,v]=r.useState({}),b=Ye(),{toast:F}=cs(),E=()=>{const S={};let k=!0;return l?/\S+@\S+\.\S+/.test(l)||(S.email="Email is invalid",k=!1):(S.email="Email is required",k=!1),u?u.length<8&&(S.password="Password must be at least 8 characters",k=!1):(S.password="Password is required",k=!1),!s&&!x&&(S.username="Username is required",k=!1),v(S),k},V=async S=>{if(S.preventDefault(),!!E()){n(!0),v({});try{let k;s?k=await y("/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:l,password:u})}):k=await y("/signup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:x,email:l,password:u,first_name:h,last_name:m})}),F({title:s?"Welcome back!":"Account created",description:s?"You have been successfully logged in.":"Your account has been created successfully."}),b.push("/home")}catch(k){console.error("Authentication error:",k),v(k),Object.keys(d).length===0&&v({general:k.message||"An unexpected error occurred. Please try again."}),F({title:"Authentication failed",description:k.message||"Please check your credentials and try again.",variant:"destructive"})}finally{n(!1)}}},U=()=>{v({}),s?(i(""),g(""),f("")):(o(""),c(""))};return e.jsxs(ce,{className:"w-[350px]",children:[e.jsxs(Ae,{children:[e.jsx(Pe,{children:s?"Welcome back":"Create account"}),e.jsx(Fe,{children:s?"Enter your credentials to continue":"Sign up for a new account"})]}),e.jsxs("form",{onSubmit:V,children:[e.jsxs(_e,{className:"space-y-4",children:[d.general&&e.jsxs(Ee,{variant:"destructive",className:"mb-4",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx(Te,{children:d.general})]}),!s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"username",children:"Username"}),e.jsx(X,{id:"username",type:"text",placeholder:"johndoe",value:x,onChange:S=>i(S.target.value),required:!0,className:d.username?"border-red-500":""}),d.username&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"firstName",children:"First Name"}),e.jsx(X,{id:"firstName",type:"text",placeholder:"John",value:h,onChange:S=>g(S.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"lastName",children:"Last Name"}),e.jsx(X,{id:"lastName",type:"text",placeholder:"Doe",value:m,onChange:S=>f(S.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"email",children:"Email"}),e.jsx(X,{id:"email",type:"email",placeholder:"name@example.com",value:l,onChange:S=>o(S.target.value),required:!0,className:d.email?"border-red-500":""}),d.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"password",children:"Password"}),e.jsx(X,{id:"password",type:"password",value:u,onChange:S=>c(S.target.value),required:!0,className:d.password?"border-red-500":""}),d.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.password}),!s&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long"})]}),s&&e.jsx(le,{to:"/reset-password",className:"text-sm text-primary",children:"Forgot password?"})]}),e.jsxs(Le,{className:"flex flex-col space-y-4",children:[e.jsxs(K,{type:"submit",className:"w-full",disabled:a,children:[e.jsx(Es,{className:"mr-2 h-4 w-4"}),a?s?"Signing in...":"Signing up...":s?"Sign in":"Sign up"]}),e.jsx(K,{variant:"link",type:"button",onClick:()=>{t(!s),U()},className:"text-sm",disabled:a,children:s?"Need an account? Sign up":"Already have an account? Sign in"})]})]})]})},Dt=()=>{const[s,t]=r.useState(""),[a,n]=r.useState({}),l=o=>{o.preventDefault()};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:e.jsxs(ce,{className:"w-[350px]",children:[e.jsxs(Ae,{children:[e.jsx(Pe,{children:"Reset Password"}),e.jsx(Fe,{children:"Enter your email to reset your password"})]}),e.jsxs("form",{onSubmit:l,children:[e.jsxs(_e,{className:"space-y-4",children:[a.general&&e.jsxs(Ee,{variant:"destructive",className:"mb-4",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx(Te,{children:a.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"email",children:"Email"}),e.jsx(X,{id:"email",type:"email",placeholder:"name@example.com",value:s,onChange:o=>t(o.target.value),required:!0,className:a.email?"border-red-500":""}),a.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.email})]})]}),e.jsx(Le,{className:"flex flex-col space-y-4",children:e.jsx(K,{type:"submit",className:"w-full",children:"Send Reset Link"})})]})]})})},Et=({...s})=>{const{theme:t="system"}=Ts();return e.jsx(As,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},Tt=Ps,ds=r.forwardRef(({className:s,...t},a)=>e.jsx(Ke,{ref:a,className:I("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));ds.displayName=Ke.displayName;const At=je("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),us=r.forwardRef(({className:s,variant:t,...a},n)=>e.jsx(Qe,{ref:n,className:I(At({variant:t}),s),...a}));us.displayName=Qe.displayName;const Pt=r.forwardRef(({className:s,...t},a)=>e.jsx(Xe,{ref:a,className:I("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));Pt.displayName=Xe.displayName;const ms=r.forwardRef(({className:s,...t},a)=>e.jsx(Ze,{ref:a,className:I("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(es,{className:"h-4 w-4"})}));ms.displayName=Ze.displayName;const hs=r.forwardRef(({className:s,...t},a)=>e.jsx(ss,{ref:a,className:I("text-sm font-semibold",s),...t}));hs.displayName=ss.displayName;const xs=r.forwardRef(({className:s,...t},a)=>e.jsx(ts,{ref:a,className:I("text-sm opacity-90",s),...t}));xs.displayName=ts.displayName;function Ft(){const{toasts:s}=cs();return e.jsxs(Tt,{children:[s.map(function({id:t,title:a,description:n,action:l,...o}){return e.jsxs(us,{...o,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(hs,{children:a}),n&&e.jsx(xs,{children:n})]}),l,e.jsx(ms,{})]},t)}),e.jsx(ds,{})]})}const _t=Fs,Lt=r.forwardRef(({className:s,sideOffset:t=4,...a},n)=>e.jsx(as,{ref:n,sideOffset:t,className:I("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));Lt.displayName=as.displayName;const fs=r.createContext(void 0);function Ot({children:s}){const[t,a]=r.useState(()=>{const n=localStorage.getItem("theme");return n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});return r.useEffect(()=>{localStorage.setItem("theme",t),t==="dark"?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},[t]),e.jsx(fs.Provider,{value:{theme:t,setTheme:a},children:s})}function gs(){const s=r.useContext(fs);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s}const Rt=s=>{const[t,a]=r.useState([]),[n,l]=r.useState([]),[o,u]=r.useState(null),[c,x]=r.useState(!1),[i,h]=r.useState(null),[g]=Ie(),m=r.useCallback(async()=>{x(!0),h(null);try{const d=await y("/api/set_user/list",{method:"GET",headers:{}});a(d||[])}catch(d){console.error("Failed to fetch user sets:",d),h(`Failed to load your sets: ${d instanceof Error?d.message:"Unknown error"}`),a([])}finally{x(!1)}},[]);r.useEffect(()=>{s.isOpen?m():(a([]),l([]),u(null),h(null),x(!1))},[s.isOpen,m]),r.useEffect(()=>{const d=t.filter(v=>!s.existingSetIds.includes(v.SetID));l(d)},[t,s.existingSetIds]);const f=async()=>{if(!o||!s.classId){g({message:"Please select a set to add.",duration:2e3,color:"warning"});return}x(!0),h(null);try{await y("/api/class_set/",{method:"POST",headers:{id:s.classId,set_id:o.toString()}}),g({message:"Set added successfully!",duration:2e3,color:"success"}),s.onSetAdded(),s.onDidDismiss()}catch(d){console.error("Failed to add set to class:",d);const v=`Failed to add set: ${d instanceof Error?d.message:"Unknown error"}`;h(v),g({message:v,duration:3e3,color:"danger"})}finally{x(!1)}};return console.log("selectedSetId",o),console.log("availableSets",n),e.jsxs(_s,{isOpen:s.isOpen,onDidDismiss:s.onDidDismiss,children:[e.jsx(Ce,{children:e.jsxs(xe,{children:[e.jsx(rs,{children:"Add Set to Class"}),e.jsx(ee,{slot:"end",children:e.jsx(w,{onClick:s.onDidDismiss,color:"medium",children:"Cancel"})})]})}),e.jsxs(P,{className:"ion-padding",children:[c&&!n.length?e.jsxs("div",{className:"flex justify-center items-center h-full",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading your sets..."})]}):i?e.jsx(B,{color:"danger",children:e.jsx("p",{children:i})}):n.length===0?e.jsx("p",{className:"text-center text-gray-500 mt-4",children:"You have no available sets to add to this class. Create a new set or check if all your sets are already added."}):e.jsx(Ls,{value:o,onIonChange:d=>{console.log("e.detail.value",d.detail.value),u(Number(d.detail.value))},children:e.jsx(oe,{children:n.map(d=>e.jsxs($,{children:[e.jsx(Os,{slot:"start",value:d.SetID},d.SetID),e.jsxs(te,{children:[e.jsx("h2",{children:d.SetName}),e.jsx("p",{className:"text-sm text-gray-500",children:d.SetDescription})]})]},d.SetID))})}),i&&n.length>0&&e.jsx(B,{color:"danger",className:"block mt-4",children:e.jsx("p",{children:i})})]}),!c&&n.length>0&&e.jsx("div",{className:"ion-padding",children:e.jsx(w,{expand:"block",onClick:f,disabled:!o,className:"ion-margin-bottom",children:c?e.jsx(Y,{name:"dots"}):"Add Selected Set"})})]})},Ut=s=>e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs(w,{routerLink:"/home",color:"primary",children:[e.jsx(C,{slot:"start",icon:ie}),"Back"]}),s.isTeacher&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{onClick:s.onAddSetClick,color:"primary",disabled:!s.classId,children:[e.jsx(C,{slot:"start",icon:ke}),"Add Existing Set"]}),e.jsxs(w,{routerLink:`/create-set?classId=${s.classId}`,color:"primary",disabled:!s.classId,children:[e.jsx(C,{slot:"start",icon:De}),"Create New Set"]})]})]}),se=s=>e.jsxs("div",{children:[e.jsx($,{children:e.jsx(Rs,{type:s.type,label:s.label,name:s.name,value:s.value,onIonChange:s.onChange})}),s.error&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.error})]}),$t=s=>e.jsx(e.Fragment,{children:s.isEditing?e.jsxs(e.Fragment,{children:[e.jsx(se,{type:"text",label:"Class Name",name:"class_name",value:s.updatedInfo.class_name,onChange:s.handleChange,error:s.errors.className}),e.jsx(se,{type:"text",label:"Class Description",name:"class_description",value:s.updatedInfo.class_description,onChange:s.handleChange,error:s.errors.classDescription}),s.errors.general&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.errors.general}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx(w,{onClick:s.handleSave,color:"primary",size:"small",children:"Save"}),e.jsx(w,{onClick:s.handleCancel,color:"medium",size:"small",children:"Cancel"})]})]}):s.loading?e.jsx("div",{children:"Loading..."}):s.classData?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s.loading?"Loading...":s.classData.ClassName}),s.isTeacher&&!s.isEditing&&e.jsx(C,{icon:De,size:"large",color:"primary",className:"hover:transform hover:scale-110 cursor-pointer p-2",onClick:s.handleEdit})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:s.loading?"Loading...":s.classData.ClassDescription})]}):e.jsx("h1",{children:"Class details unavailable"})}),Bt=s=>e.jsxs(ns,{value:s.selectedTab,onIonChange:t=>s.onTabChange(t.detail.value),className:"w-full mb-6",children:[e.jsxs(re,{value:"flashcards",children:[e.jsx(C,{icon:ls,className:"mr-2"}),e.jsx(te,{children:"Flashcard Sets"})]}),e.jsxs(re,{value:"leaderboard",children:[e.jsx(C,{icon:Us,className:"mr-2"}),e.jsx(te,{children:"Leaderboard"})]}),e.jsxs(re,{value:"students",children:[e.jsx(C,{icon:$s,className:"mr-2"}),e.jsx(te,{children:"Students"})]})]}),js=s=>{const[t,a]=r.useState(!1),n=async u=>{var c;try{const x=await y(`${u}`,{method:"POST",headers:{card_id:s.cardId.toString()}});console.log(`Score update successful for card ${s.cardId}:`,x),(c=s.onAdvance)==null||c.call(s)}catch(x){console.error(`Failed to update score for card ${s.cardId}:`,x)}},l=()=>{n("/api/card_history/incorrect")},o=()=>{n("/api/card_history/correct")};return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsxs("div",{className:`flip-card cursor-pointer ${t?"flipped":""}`,onClick:()=>a(!t),children:[e.jsx(ce,{className:"flip-card-front p-8 min-h-[300px] flex items-center justify-center text-center",children:e.jsx("p",{className:"text-xl",children:s.front})}),e.jsx(ce,{className:"flip-card-back p-8 min-h-[300px] flex items-center justify-center text-center absolute top-0 w-full",children:e.jsx("p",{className:"text-xl",children:s.back})})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsxs(K,{variant:"outline",className:"w-32",onClick:l,children:[e.jsx(es,{className:"mr-2 h-4 w-4"}),"Learning"]}),e.jsxs(K,{className:"w-32",onClick:o,children:[e.jsx(Bs,{className:"mr-2 h-4 w-4"}),"Mastered"]})]})]})},ps=r.createContext(null);function Ne(){const s=r.useContext(ps);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const Oe=r.forwardRef(({orientation:s="horizontal",opts:t,setApi:a,plugins:n,className:l,children:o,...u},c)=>{const[x,i]=Ms({...t,axis:s==="horizontal"?"x":"y"},n),[h,g]=r.useState(!1),[m,f]=r.useState(!1),d=r.useCallback(E=>{E&&(g(E.canScrollPrev()),f(E.canScrollNext()))},[]),v=r.useCallback(()=>{i==null||i.scrollPrev()},[i]),b=r.useCallback(()=>{i==null||i.scrollNext()},[i]),F=r.useCallback(E=>{E.key==="ArrowLeft"?(E.preventDefault(),v()):E.key==="ArrowRight"&&(E.preventDefault(),b())},[v,b]);return r.useEffect(()=>{!i||!a||a(i)},[i,a]),r.useEffect(()=>{if(i)return d(i),i.on("reInit",d),i.on("select",d),()=>{i==null||i.off("select",d)}},[i,d]),e.jsx(ps.Provider,{value:{carouselRef:x,api:i,opts:t,orientation:s||((t==null?void 0:t.axis)==="y"?"vertical":"horizontal"),scrollPrev:v,scrollNext:b,canScrollPrev:h,canScrollNext:m},children:e.jsx("div",{ref:c,onKeyDownCapture:F,className:I("relative",l),role:"region","aria-roledescription":"carousel",...u,children:o})})});Oe.displayName="Carousel";const Re=r.forwardRef(({className:s,...t},a)=>{const{carouselRef:n,orientation:l}=Ne();return e.jsx("div",{ref:n,className:"overflow-hidden",children:e.jsx("div",{ref:a,className:I("flex",l==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...t})})});Re.displayName="CarouselContent";const Ue=r.forwardRef(({className:s,...t},a)=>{const{orientation:n}=Ne();return e.jsx("div",{ref:a,role:"group","aria-roledescription":"slide",className:I("min-w-0 shrink-0 grow-0 basis-full",n==="horizontal"?"pl-4":"pt-4",s),...t})});Ue.displayName="CarouselItem";const vs=r.forwardRef(({className:s,variant:t="outline",size:a="icon",...n},l)=>{const{orientation:o,scrollPrev:u,canScrollPrev:c}=Ne();return e.jsxs(K,{ref:l,variant:t,size:a,className:I("absolute  h-8 w-8 rounded-full",o==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!c,onClick:u,...n,children:[e.jsx(zs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});vs.displayName="CarouselPrevious";const Ns=r.forwardRef(({className:s,variant:t="outline",size:a="icon",...n},l)=>{const{orientation:o,scrollNext:u,canScrollNext:c}=Ne();return e.jsxs(K,{ref:l,variant:t,size:a,className:I("absolute h-8 w-8 rounded-full",o==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!c,onClick:u,...n,children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});Ns.displayName="CarouselNext";const Mt=s=>{var u;const t=pe(),[a,n]=r.useState([]),[l,o]=r.useState(null);return r.useEffect(()=>{async function c(){console.log("selectedSet",l);const x=await y("/api/flashcards/list",{method:"GET",headers:{set_id:l}});console.log("cards",x),n(x)}l&&c()},[l]),e.jsx("div",{className:"mt-6",children:s.loading?e.jsx("div",{children:"Loading..."}):l===null?(u=s.flashcardSets)!=null&&u.length?e.jsx(qs,{children:e.jsx(Vs,{children:s.flashcardSets.sort((c,x)=>c.ID-x.ID).map(c=>e.jsx(Hs,{size:"12",sizeMd:"6",sizeLg:"4",children:e.jsxs(A,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-200 rounded-lg border shadow-sm",onClick:()=>t.push(`/set-overview/${c.ID}`),children:[e.jsx(M,{children:e.jsx(z,{className:"text-lg font-semibold",children:c.SetName})}),e.jsx(O,{children:e.jsx("p",{className:"text-muted-foreground mb-2",children:c.SetDescription})})]})},c.ID))})}):e.jsx("p",{children:"No flashcard sets available."}):e.jsxs(e.Fragment,{children:[e.jsxs(w,{fill:"outline",onClick:()=>o(null),className:"mb-6",children:[e.jsx(C,{slot:"start",icon:ie}),"Back to Sets"]}),e.jsxs("div",{className:"w-full max-w-2xl mx-auto relative",children:[e.jsxs(Oe,{orientation:"vertical",className:"w-full",setApi:s.setApi,children:[e.jsx(Re,{className:"-mt-1 h-[400px]",children:a.map(c=>e.jsx(Ue,{children:e.jsx(js,{front:c.Front,back:c.Back,cardId:c.ID})},c.ID))}),e.jsx(vs,{}),e.jsx(Ns,{})]}),e.jsx("div",{className:"absolute right-[-50px] top-1/2 transform -translate-y-1/2 flex flex-col gap-2",children:a.map((c,x)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${x===s.currentCardIndex?"bg-primary":"bg-gray-300"}`},x))})]})]})})},$e=()=>e.jsx(Js,{className:"hidden md:block ion-no-border fixed bottom-0 w-full",children:e.jsxs(xe,{children:[e.jsx(ee,{slot:"start",children:e.jsx(w,{routerLink:"/home",children:e.jsx(C,{icon:Ys})})}),e.jsx(B,{className:"mx-auto text-center text-sm",children:"Cowboy Cards 2025. Built for learning and fun."})]})}),zt=s=>e.jsxs(A,{className:"rounded-lg border shadow-sm",children:[e.jsx(M,{children:e.jsx(z,{className:"text-xl font-semibold",children:"Class Leaderboard"})}),e.jsx(O,{children:e.jsx(oe,{className:"space-y-3",lines:"none",children:s.leaderboard===null?e.jsx("h1",{className:"text-center text-gray-500",children:"No scores available"}):s.leaderboard.map(t=>e.jsxs($,{className:"muted-item p-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"font-medium text-lg",children:t.Username})}),e.jsxs("span",{slot:"end",className:"text-primary font-semibold",children:[t.ClassScore," points"]})]},t.UserID))})})]}),Gt=s=>e.jsx(e.Fragment,{children:s.loadingScores?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Calculating scores..."})]}):e.jsx(zt,{leaderboard:s.leaderboardData})}),G=()=>{const[s,t]=r.useState(null),a=i=>t(i.nativeEvent),n=()=>t(null),l=i=>{var h;o.push(i),(h=document.querySelector("ion-menu"))==null||h.close()},o=Ye(),{theme:u,setTheme:c}=gs(),x=()=>{c(u==="dark"?"light":"dark")};return e.jsxs(e.Fragment,{children:[e.jsxs(Ws,{side:"start",contentId:"main-content",children:[e.jsx(Ce,{children:e.jsx(xe,{children:e.jsx(ee,{slot:"start",children:e.jsx(Be,{children:e.jsx(w,{children:e.jsx(C,{icon:Ks})})})})})}),e.jsx(P,{children:e.jsxs(oe,{children:[e.jsx($,{button:!0,onClick:()=>l("/home"),children:"My Dashboard"}),e.jsx($,{button:!0,onClick:()=>l("/public-cards"),children:"Public Cards"}),e.jsx($,{button:!0,onClick:()=>l("/public-classes"),children:"Public Classes"}),e.jsx($,{button:!0,onClick:()=>l("/user-account"),children:"My Account"})]})})]}),e.jsx(Ce,{children:e.jsxs(xe,{children:[e.jsx(ee,{slot:"start",children:e.jsx(Be,{children:e.jsx(w,{children:e.jsx(C,{icon:Qs})})})}),e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>o.push("/home"),children:[e.jsx("img",{src:"src/assets/Spirit-Cowboy-Profile-Only.png",alt:"Cowboy Cards Logo",className:"h-8 w-auto md:hidden"}),e.jsx(rs,{color:"primary",className:"hidden md:inline-block text-lg md:text-xl lg:text-2xl font-bold hover:translate-x-1 transition-all duration-300",children:"Cowboy Cards"})]}),e.jsxs(ee,{slot:"end",children:[e.jsx(w,{onClick:a,children:e.jsx(C,{icon:Xs,className:"text-[32px] stroke-[2]"})}),e.jsx(Zs,{event:s,isOpen:!!s,onDidDismiss:n,children:e.jsx(P,{className:"p-2",children:e.jsxs(oe,{children:[e.jsx($,{button:!0,onClick:()=>{n(),o.push("/create-set")},children:"Create Set"}),e.jsx($,{button:!0,onClick:()=>{n(),o.push("/create-class")},children:"Create Class"}),e.jsx($,{button:!0,onClick:()=>{n(),o.push("/public-classes")},children:"Join Class"})]})})}),e.jsx(w,{fill:"clear",onClick:x,children:e.jsx(C,{slot:"icon-only",icon:u==="dark"?et:st})})]}),e.jsx(ee,{slot:"end",children:e.jsx(w,{routerLink:"/user-account",children:e.jsx(C,{icon:tt,size:"large"})})})]})})]})},qt=s=>e.jsxs(A,{className:"mt-6",children:[e.jsx(M,{children:e.jsx(z,{className:"text-xl font-semibold",children:"Class Students"})}),e.jsx(O,{children:e.jsx(oe,{className:"space-y-3",lines:"none",children:s.students.map(t=>e.jsxs($,{className:"muted-item p-3",children:[e.jsxs("span",{className:"font-medium",children:[t.FirstName," ",t.LastName]}),e.jsx("span",{slot:"end",className:"text-muted-foreground",children:t.email}),s.isTeacher&&e.jsx(C,{slot:"end",icon:os,color:"danger",className:"cursor-pointer",onClick:()=>s.onDeleteStudent(t.UserID)})]},t.UserID))})})]}),Vt=s=>{const[t,a]=r.useState({isOpen:!1,studentId:null}),n=l=>{a({isOpen:!0,studentId:l})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(qt,{isTeacher:s.isTeacher,students:s.students,onDeleteStudent:n})}),e.jsx(fe,{isOpen:t.isOpen,onDidDismiss:()=>a({isOpen:!1,studentId:null}),header:"Confirm Deletion",message:"Are you sure you want to remove this student from the class? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Delete",handler:()=>{t.studentId!==null&&(s.handleActualDelete(t.studentId),console.log(`Student deletion initiated for ID: ${t.studentId}`))}}]})]})},Ht=()=>{const{id:s}=ve();console.log("id",s);const[t,a]=r.useState(0),[n,l]=r.useState(),[o,u]=r.useState("flashcards"),[c,x]=r.useState(!1),[i,h]=r.useState(),[g,m]=r.useState([]),[f,d]=r.useState([]),[v,b]=r.useState(null),[F,E]=r.useState(!1),[V,U]=r.useState([]),[S,k]=r.useState(!1),[ae,J]=r.useState(!1),[_,j]=r.useState({class_name:"",class_description:""}),[N,p]=r.useState(!1),R=()=>{console.log("Handling Edit"),j({class_name:(i==null?void 0:i.ClassName)||"",class_description:(i==null?void 0:i.ClassDescription)||""}),J(!0)},[Q,be]=r.useState({}),bs=()=>{const D={};let T=!0;return _.class_name=_.class_name.trim(),_.class_description=_.class_description.trim(),_.class_name||(D.className="Class name is required",T=!1),_.class_description||(D.classDescription="Class description is required",T=!1),be(D),T},ys=async()=>{if(!bs()){console.log("Form validation failed:",Q);return}const D=["class_name","class_description"];try{const T=D.map(q=>y(`/api/classes/${q}`,{method:"PUT",headers:{id:s,[q]:_[q]}}));await Promise.all(T),h(q=>({...q,ClassName:_.class_name,ClassDescription:_.class_description})),J(!1)}catch(T){console.error(T),alert("Failed to update some fields. Please try again.")}},ws=D=>{const{name:T}=D.target,q=D.detail.value;j(ue=>({...ue,[T]:q}))},Ss=()=>{J(!1)},de=r.useCallback(async()=>{E(!0),k(!0),b(null);try{const[D,T,q,ue]=await Promise.all([y("/api/classes/",{method:"GET",headers:{id:s}}),y("/api/class_set/list_sets",{method:"GET",headers:{id:s}}),y("/api/class_user/members",{method:"GET",headers:{class_id:s}}),y("/api/classes/leaderboard",{method:"GET",headers:{id:s}})]);console.log("data",D),x(D.Role==="teacher"),h(D),console.log("sets",T),m(T||[]),console.log("users",q),d(q||[]),console.log("scores",ue),U(ue||[])}catch(D){let T="Unknown error";D instanceof Error&&(T=D.message),b(`Error fetching class data: ${T}`),h(void 0),m([]),d([]),U([])}finally{E(!1),k(!1)}},[s]);r.useEffect(()=>{de()},[de]);const Cs=async D=>{if(D!==null)try{await y("/api/class_user/",{method:"DELETE",headers:{student_id:D,id:s}}),de()}catch(T){console.error("Error deleting student:",T),b("Error deleting student")}};return r.useEffect(()=>{n&&n.on("select",()=>{a(n.selectedScrollSnap())})},[n]),e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsxs(P,{className:"ion-padding",children:[e.jsxs("div",{id:"main-content",className:"max-w-4xl mx-auto",children:[v&&e.jsx("div",{className:"text-red-500",children:v}),e.jsx($t,{classData:i,isTeacher:c,loading:F,handleEdit:R,isEditing:ae,updatedInfo:_,errors:Q,handleChange:ws,handleSave:ys,handleCancel:Ss}),e.jsx(Ut,{isTeacher:c,classId:s,onAddSetClick:()=>p(!0)}),e.jsx(Bt,{selectedTab:o,onTabChange:u}),o==="leaderboard"&&e.jsx(Gt,{leaderboardData:V,loadingScores:S}),o==="flashcards"&&e.jsx(Mt,{flashcardSets:g,currentCardIndex:t,setApi:l,loading:F}),o==="students"&&e.jsx(Vt,{isTeacher:c,students:f,handleActualDelete:Cs})]}),e.jsx($e,{})]}),e.jsx(Rt,{isOpen:N,onDidDismiss:()=>p(!1),classId:s,existingSetIds:g.map(D=>D.ID),onSetAdded:de})]})},Jt=()=>{const[s,t]=r.useState(!1),[a,n]=r.useState(!1),[l,o]=r.useState(null),[u,c]=r.useState({className:"",description:""}),[x,i]=r.useState(!1);return r.useEffect(()=>{async function h(){if(s){n(!0),o(null);try{const g=await y("/api/classes",{method:"POST",headers:{class_name:u.className,class_description:u.description}});console.log("Class created successfully:",g),t(!1),c({className:"",description:""}),i(!0),n(!1)}catch(g){o(`Failed to create class: ${g.message}`)}finally{n(!1)}}}s&&h()},[s,u]),e.jsxs(P,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[l&&e.jsx("div",{className:"text-red-500 mt-2",children:l}),e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Create New Class"}),e.jsxs("form",{children:[e.jsx(A,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsx(W,{placeholder:"Enter Class Name",value:u.className,onIonChange:h=>c(g=>({...g,className:h.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),e.jsx(W,{placeholder:"Enter Class Description",value:u.description,onIonChange:h=>c(g=>({...g,description:h.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}})]})}),e.jsx("div",{className:"flex flex-col md:flex-row justify-center md:justify-end gap-4 mt-8",children:e.jsx(w,{color:"success",disabled:a,onClick:()=>t(!0),children:a?"Creating...":"Create Class"})})]}),x&&e.jsx(B,{children:e.jsx("p",{children:"Class created successfully!"})})]})]})},Yt=()=>{const s=pe(),[t,a]=r.useState(""),[n,l]=r.useState(""),[o,u]=r.useState({title:"",description:""}),[c,x]=r.useState(!1),[i,h]=r.useState(null),g=async()=>{x(!0),h(null);const m={title:"",description:""};let f=!1;if(t.trim()||(m.title="Title is required",f=!0),n.trim()||(m.description="Description is required",f=!0),u(m),f){x(!1);return}try{const d=await y("/api/flashcards/sets",{method:"POST",headers:{set_name:t,set_description:n}});s.push(`/set-overview/${d.ID}`)}catch(d){console.error("Error saving flashcard set:",d),h(`Failed to save flashcard set: ${d.message}`)}finally{x(!1)}};return e.jsxs(P,{className:"ion-padding",children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[c&&e.jsx("div",{children:"Loading..."}),i&&e.jsx("div",{className:"text-red-500 mt-2",children:i}),e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Create New Flashcard Set"}),e.jsx(A,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsx(W,{placeholder:"Enter set title",value:t,onIonChange:m=>a(m.detail.value),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),o.title&&e.jsx(B,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:o.title})}),e.jsx(W,{placeholder:"Enter set description",value:n,onIonChange:m=>l(m.detail.value),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}}),o.description&&e.jsx(B,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:o.description})})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(w,{color:"success",className:"rounded-lg shadow-sm w-full md:w-auto",onClick:g,disabled:c,children:c?"Creating...":"Create Set"})})]})]})},Wt=s=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Edit Cards"}),s.cards.map((t,a)=>e.jsx(A,{className:"mb-4 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"text-sm font-semibold text-gray-600",children:["Card ",a+1," ",t.ID>0?"(Existing)":"(New)"]}),e.jsx(w,{fill:"clear",color:"danger",size:"small",onClick:()=>s.onRemoveCard(a),className:"-mt-2 -mr-2",children:e.jsx(C,{slot:"icon-only",icon:os})})]}),e.jsx(W,{label:`Front (Card ${a+1})`,labelPlacement:"stacked",placeholder:"Front of card",value:t.Front,onIonChange:n=>s.onUpdateCard(a,"Front",n.detail.value),rows:2,autoGrow:!0,className:"mb-3",style:{resize:"none"}}),e.jsx(W,{label:`Back (Card ${a+1})`,labelPlacement:"stacked",placeholder:"Back of card",value:t.Back,onIonChange:n=>s.onUpdateCard(a,"Back",n.detail.value),rows:2,autoGrow:!0,style:{resize:"none"}})]})},t.ID)),e.jsx("div",{className:"flex justify-center mt-4 mb-6",children:e.jsxs(w,{onClick:s.onAddCard,fill:"outline",children:[e.jsx(C,{slot:"start",icon:ke})," Add Card"]})})]}),Kt=s=>e.jsx(A,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsx(W,{label:"Set Title",labelPlacement:"stacked",placeholder:"Enter set title",value:s.setName,onIonChange:t=>s.onNameChange(t.detail.value),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),e.jsx(W,{label:"Set Description",labelPlacement:"stacked",placeholder:"Enter set description",value:s.setDescription,onIonChange:t=>s.onDescriptionChange(t.detail.value),rows:2,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}})]})}),Qt=()=>{const{id:s}=ve(),[t]=Ie(),[a,n]=r.useState(null),[l,o]=r.useState([]),[u,c]=r.useState(""),[x,i]=r.useState(""),[h,g]=r.useState([]),[m,f]=r.useState(!0),[d,v]=r.useState(null),[b,F]=r.useState(!1),[E,V]=r.useState(null),U=r.useCallback(async()=>{if(!s){v("Set ID is missing from URL."),f(!1);return}f(!0),v(null),V(null);try{const[j,N]=await Promise.all([y("/api/flashcards/sets/",{method:"GET",headers:{id:s}}),y("/api/flashcards/list",{method:"GET",headers:{set_id:s}})]);n(j),o(N),c(j.SetName),i(j.SetDescription),g(N?N.map(p=>({...p,ID:p.ID||0})):[])}catch(j){console.error("Error fetching data for EditSet:",j);let N="Unknown error";j instanceof Error&&(N=j.message),v(`Failed to load set data: ${N}`)}finally{f(!1)}},[s]);r.useEffect(()=>{U()},[U]);const S=(j,N)=>{const p=N??"";j==="SetName"?c(p):i(p)},k=()=>{if(!a)return;const j={ID:0,Front:"",Back:"",SetID:a.ID,CreatedAt:new Date().toISOString(),UpdatedAt:new Date().toISOString()};g([...h,j])},ae=j=>{g(h.filter((N,p)=>p!==j))},J=(j,N,p)=>{const R=p??"";g(h.map((Q,be)=>be===j?{...Q,[N]:R}:Q))},_=async()=>{if(!a||b)return;F(!0),V(null);const j=[];u!==a.SetName&&j.push(y("/api/flashcards/sets/set_name",{method:"PUT",headers:{id:a.ID,set_name:u}})),x!==a.SetDescription&&j.push(y("/api/flashcards/sets/set_description",{method:"PUT",headers:{id:a.ID,set_description:x}}));const N=new Set(h.map(p=>p.ID).filter(p=>p>0));l&&l.forEach(p=>{N.has(p.ID)||j.push(y("/api/flashcards",{method:"DELETE",headers:{id:p.ID}}))}),h.forEach(p=>{if(p.ID<=0)j.push(y("/api/flashcards",{method:"POST",headers:{front:p.Front,back:p.Back,id:a.ID}}));else{const R=l.find(Q=>Q.ID===p.ID);R&&(p.Front!==R.Front&&j.push(y("/api/flashcards/front",{method:"PUT",headers:{id:p.ID,front:p.Front}})),p.Back!==R.Back&&j.push(y("/api/flashcards/back",{method:"PUT",headers:{id:p.ID,back:p.Back}})))}});try{await Promise.all(j),t({message:"Changes saved successfully!",duration:2e3,color:"success"}),await U()}catch(p){console.error("Error saving changes:",p);let R="Unknown error during save";p instanceof Error&&(R=p.message),V(`Failed to save changes: ${R}`),t({message:`Save failed: ${R}`,duration:3e3,color:"danger"})}finally{F(!1)}};return e.jsxs(at,{children:[e.jsx(G,{}),e.jsx(P,{className:"ion-padding",children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Edit Flashcard Set"}),e.jsx(Me,{isOpen:m,message:"Loading set data..."}),e.jsx(Me,{isOpen:b,message:"Saving changes..."}),d&&!m&&e.jsx(B,{color:"danger",className:"block mb-4",children:e.jsxs("p",{children:["Error loading data: ",d]})}),E&&!b&&e.jsx(B,{color:"danger",className:"block mb-4",children:e.jsxs("p",{children:["Error saving: ",E]})}),!m&&!d&&a&&e.jsxs(e.Fragment,{children:[e.jsx(Kt,{setName:u,setDescription:x,onNameChange:j=>S("SetName",j),onDescriptionChange:j=>S("SetDescription",j)}),e.jsx(Wt,{cards:h,onAddCard:k,onRemoveCard:ae,onUpdateCard:J}),e.jsx("div",{className:"flex justify-end",children:e.jsx(w,{onClick:_,color:"primary",disabled:b,children:b?"Saving...":"Save Changes"})})]})]})}),e.jsx($e,{})]})},Xt=()=>{const{id:s}=ve();pe();const[t,a]=r.useState(),[n,l]=r.useState([]),[o,u]=r.useState(),[c,x]=r.useState(0),[i,h]=r.useState(!0);r.useEffect(()=>{const m=async()=>{try{const d=await y("/api/flashcards/sets/",{method:"GET",headers:{id:s}});a(d)}catch(d){console.error("Failed to fetch set info",d)}},f=async()=>{h(!0);try{const d=await y("/api/flashcards/list",{method:"GET",headers:{set_id:s}});l(Array.isArray(d)?d.map(v=>({ID:v.ID,Front:v.Front,Back:v.Back,SetID:v.SetID,CreatedAt:v.CreatedAt,UpdatedAt:v.UpdatedAt})):[])}catch(d){console.error("Failed to fetch cards",d),l([])}finally{h(!1)}};s&&(m(),f())},[s]),r.useEffect(()=>{if(!o)return;const m=()=>{x(o.selectedScrollSnap())};return m(),o.on("select",m),o.on("reInit",m),()=>{o.off("select",m),o.off("reInit",m)}},[o]);const g=()=>{o&&o.scrollNext()};return e.jsxs(P,{className:"ion-padding",children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(w,{className:"rounded-lg",fill:"outline",style:{"--border-radius":"0.5rem"},routerLink:`/set-overview/${s}`,children:[e.jsx(C,{slot:"start",icon:ie}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:t.SetName}),e.jsx("p",{className:"text-gray-500",children:t.SetDescription})]})]}),e.jsx("div",{className:"w-full max-w-xl mx-auto relative py-8 min-h-[400px] flex items-center justify-center",children:i?e.jsx(Y,{name:"circular"}):n.length===0?e.jsx("div",{className:"text-center text-gray-500 text-lg py-20",children:"This set has no cards yet."}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{orientation:"vertical",setApi:u,className:"w-full",children:e.jsx(Re,{className:"-mt-1 h-[400px]",children:n.map((m,f)=>e.jsx(Ue,{children:e.jsx(js,{front:m.Front,back:m.Back,onAdvance:g,cardId:m.ID})},f))})}),e.jsx("div",{className:"absolute right-[-50px] top-1/2 transform -translate-y-1/2 flex flex-col gap-2",children:n.map((m,f)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${f===c?"bg-primary":"bg-gray-300"}`},f))})]})})]})]})},Zt=()=>{const[s,t]=r.useState("classes"),[a,n]=r.useState([]),[l,o]=r.useState([]),[u,c]=r.useState(!1),[x,i]=r.useState(!1),[h,g]=r.useState(null);return r.useEffect(()=>{console.log("Classes state updated:",a)},[a]),r.useEffect(()=>{const m=async()=>{c(!0),g(null);try{const d=await y("/api/class_user/classes");console.log("Classes: ",d),n(d)}catch(d){g(`Error fetching classes: ${d.message}`)}finally{c(!1)}},f=async()=>{i(!0);try{const d=await y("/api/set_user/list");console.log("Sets: ",d),o(d)}catch(d){g(`Error fetching sets: ${d.message}`)}finally{i(!1)}};m(),f()},[]),e.jsx(e.Fragment,{children:e.jsxs(P,{className:"ion-padding flex flex-col min-h-screen",fullscreen:!0,children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 flex-grow",children:[h&&e.jsx("div",{className:"text-red-500 mt-2",children:h}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:s==="classes"?"My Classes":"Personal Flashcard Sets"}),e.jsx("div",{className:"flex items-center gap-2 mt-4 md:mt-0",children:e.jsxs(w,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},href:s==="classes"?"/public-classes":"/public-cards",children:[e.jsx(C,{slot:"start",icon:ke})," ",s==="classes"?"Join Class":"Join Set"]})})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(ns,{value:s,onIonChange:m=>t(m.detail.value||"classes"),style:{"--background":"var(--ion-color-light)"},children:[e.jsxs(re,{value:"classes",children:[e.jsx(C,{icon:rt,className:"mr-2"}),e.jsx(te,{children:"My Classes"})]}),e.jsxs(re,{value:"flashcards",children:[e.jsx(C,{icon:ls,className:"mr-2"}),e.jsx(te,{children:"My Cards"})]})]})}),s==="classes"&&e.jsx(e.Fragment,{children:u?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading classes..."})]}):a===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any classes. Join a class to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(m=>e.jsx(le,{to:`/class/${m.ClassID}`,children:e.jsxs(A,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(M,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(z,{className:"text-2xl font-semibold leading-none tracking-tight",children:m.ClassName}),e.jsx(ge,{className:"text-sm text-muted-foreground",children:m.ClassDescription})]}),e.jsx(O,{})]})},m.ClassID))})}),s==="flashcards"&&e.jsx(e.Fragment,{children:x?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading sets..."})]}):l===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any sets. Join a set to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:l.map(m=>e.jsx(le,{to:`/set-overview/${m.SetID}`,children:e.jsxs(A,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(M,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(z,{className:"text-2xl font-semibold leading-none tracking-tight",children:m.SetName}),e.jsx(ge,{className:"text-sm text-muted-foreground",children:m.SetDescription})]}),e.jsx(O,{})]})},m.SetID))})})]}),e.jsx($e,{})]})})},ea=()=>e.jsx(P,{children:e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center from-white to-gray-50",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-primary mb-2",children:"CowboyCards"}),e.jsx("p",{children:"Master any subject with smart flashcards"})]}),e.jsx(is,{})]})}),sa=()=>{const s=nt();return r.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]),e.jsxs(P,{children:[e.jsx(G,{}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})]})},ta=()=>{const[s,t]=r.useState(null),[a,n]=r.useState(!1),[l,o]=r.useState([]),[u,c]=r.useState(""),x=l.filter(i=>i.SetName.toLowerCase().includes(u.toLowerCase())||i.SetDescription&&i.SetDescription.toLowerCase().includes(u.toLowerCase()));return r.useEffect(()=>{async function i(){n(!0),t(null);try{const h=await y("/api/flashcards/sets/list");o(h)}catch(h){console.error("Error fetching flashcard sets:",h),t(`Error fetching flashcard sets: ${h.message}`)}finally{n(!1)}}i()},[]),e.jsxs(P,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 w-1/2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold pb-8",children:"Public Flashcard Sets"}),a&&e.jsx("div",{children:"Loading..."}),s&&e.jsx("div",{className:"text-red-500 mt-2",children:s}),e.jsx(lt,{value:u,onIonInput:i=>c(i.target.value),placeholder:"Search flashcard sets",className:"mb-4 w-1/2"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:x.map(i=>e.jsx(le,{to:`/flashcards/${i.ID}`,children:e.jsx(A,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(M,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(z,{className:"text-2xl font-semibold leading-none tracking-tight",children:i.SetName}),e.jsx(ge,{className:"text-sm ",children:i.SetDescription||"No description"})]})})},i.ID))})]})]})},aa=()=>{const[s,t]=r.useState([]),[a,n]=r.useState(!1),[l,o]=r.useState(null);return r.useEffect(()=>{(async()=>{n(!0),o(null);try{const c=await y("/api/classes/list");t(c),n(!1)}catch(c){o(`Error fetching classes: ${c.message}`)}finally{n(!1)}})()},[]),e.jsxs(P,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold pb-8",children:"Public Classes"}),a&&e.jsx("div",{children:"Loading..."}),l&&e.jsx("div",{className:"text-red-500 mt-2",children:l}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(u=>e.jsx(le,{to:`/class/${u.ID}`,children:e.jsx(A,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(M,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(z,{className:"text-2xl font-semibold leading-none tracking-tight",children:u.ClassName}),e.jsx(ge,{className:"text-sm ",children:u.ClassDescription||"No description"}),e.jsx(w,{expand:"block",color:"primary",className:"mt-4",onClick:async()=>{try{const c=await y("/api/class_user",{method:"POST",headers:{class_id:u.ID,role:"student"}});console.log("Join class response:",c)}catch(c){console.error("Error joining class:",c)}},children:"Join Class"})]})})},u.ID))})]})]})},ra=()=>{const{id:s}=ve(),t=pe(),[a,n]=r.useState(),[l,o]=r.useState([]),[u,c]=r.useState(!0),[x,i]=r.useState(!1);r.useEffect(()=>{const g=async()=>{try{const f=await y("/api/flashcards/sets/",{method:"GET",headers:{id:s}});n(f)}catch(f){console.error("Failed to fetch set info",f)}},m=async()=>{c(!0);try{const f=await y("/api/flashcards/list",{method:"GET",headers:{set_id:s}});o(Array.isArray(f)?f:[])}catch(f){console.error("Failed to fetch cards",f),o([])}finally{c(!1)}};s&&(g(),m())},[s]);const h=async()=>{if(!s){console.error("Cannot delete set: ID is missing.");return}try{await y("/api/flashcards/sets/",{method:"DELETE",headers:{id:s}}),t.push("/student-dashboard")}catch(g){console.error("Failed to delete set:",g)}};return e.jsxs(P,{className:"ion-padding",children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 pr-4",children:[e.jsxs(w,{className:"rounded-lg",fill:"outline",style:{"--border-radius":"0.5rem"},onClick:()=>window.history.back(),children:[e.jsx(C,{slot:"start",icon:ie}),"Back"]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-3xl font-bold",children:a.SetName}),e.jsx("p",{className:"text-base mt-1 text-gray-700",children:a.SetDescription})]})]}),e.jsxs("div",{className:"self-start md:self-center flex gap-2 md:mt-0 mt-4 w-full md:w-auto",children:[e.jsx(w,{className:"rounded-lg w-1/3 md:w-auto",fill:"outline",style:{"--border-radius":"0.5rem"},routerLink:`/edit-set/${s}`,children:"Edit Set"}),e.jsx(w,{className:"rounded-lg w-1/3 md:w-auto",color:"primary",style:{"--border-radius":"0.5rem"},routerLink:`/flashcards/${s}`,children:"Study Set"}),e.jsx(w,{className:"rounded-lg w-1/3 md:w-auto",color:"danger",style:{"--border-radius":"0.5rem"},onClick:()=>i(!0),children:"Delete Set"})]})]}),e.jsx("div",{className:"mt-8 min-h-[200px] flex items-center justify-center",children:u?e.jsx(Y,{name:"circular"}):l.length===0?e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-900 dark:text-gray-400 mb-4",children:"This set has no cards yet."}),e.jsx(w,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},routerLink:`/edit-set/${s}`,children:"Add Cards"})]}):e.jsx("div",{className:"w-full",children:l.map((g,m)=>e.jsx(A,{className:"mb-4 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsx("div",{className:"border-b border-gray-300 mb-3 pb-1 m-4",children:e.jsxs(B,{className:"text-md font-semibold text-gray-900 dark:text-gray-300",children:["Card ",m+1]})}),e.jsxs("div",{className:"flex flex-row justify-between items-start",children:[e.jsx("div",{className:"w-3/12 pr-4 border-r border-gray-300 m-4",children:e.jsx(B,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:g.Front})}),e.jsx("div",{className:"w-9/12 pl-4 m-4",children:e.jsx(B,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:g.Back})})]})]})},m))})})]}),e.jsx(fe,{isOpen:x,onDidDismiss:()=>i(!1),header:"Confirm Deletion",message:"Are you sure you want to delete this set? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Delete canceled")}},{text:"Delete",role:"destructive",handler:()=>{h()}}]})]})},H=s=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium",children:[s.label,":"]}),e.jsx("span",{children:s.value})]}),na=s=>{var t,a,n,l,o,u,c,x,i,h,g,m,f,d;return e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs(A,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(M,{className:"p-6",children:e.jsx(z,{className:"text-xl font-semibold text-primary",children:"Account Information"})}),e.jsx(O,{className:"p-6 pt-0",children:s.isEditing?e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{type:"text",label:"First Name",name:"first_name",value:((t=s.updatedInfo)==null?void 0:t.first_name)||"",error:s.errors.first_name,onChange:s.handleChange}),e.jsx(se,{type:"text",label:"Last Name",name:"last_name",value:((a=s.updatedInfo)==null?void 0:a.last_name)||"",error:s.errors.last_name,onChange:s.handleChange}),e.jsx(se,{type:"text",label:"Username",name:"username",value:((n=s.updatedInfo)==null?void 0:n.username)||"",error:s.errors.username,onChange:s.handleChange}),e.jsx(se,{type:"email",label:"Email",name:"email",value:((l=s.updatedInfo)==null?void 0:l.email)||"",error:s.errors.email,onChange:s.handleChange}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(w,{onClick:s.handleSave,children:"Save Changes"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{label:"First Name",value:(o=s.userInfo)==null?void 0:o.first_name}),e.jsx(H,{label:"Last Name",value:(u=s.userInfo)==null?void 0:u.last_name}),e.jsx(H,{label:"Username",value:(c=s.userInfo)==null?void 0:c.username}),e.jsx(H,{label:"Email",value:(x=s.userInfo)==null?void 0:x.email}),e.jsxs(w,{fill:"outline",onClick:s.handleEdit,className:"mt-4",children:[e.jsx(C,{slot:"start",icon:De}),"Edit Info"]})]})})]}),e.jsxs(A,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(M,{className:"p-6",children:e.jsx(z,{className:"text-xl font-semibold text-primary",children:"Account Stats"})}),e.jsx(O,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(H,{label:"Account Created",value:(i=s.userInfo)==null?void 0:i.created_at}),e.jsx(H,{label:"Login Streak",value:(h=s.userInfo)==null?void 0:h.login_streak}),e.jsx(H,{label:"Classes Taken",value:(g=s.userInfo)==null?void 0:g.numClasses}),e.jsx(H,{label:"Cards Mastered/Studied",value:`${(m=s.userInfo)==null?void 0:m.cardsMastered} / ${(f=s.userInfo)==null?void 0:f.cardsStudied}`}),e.jsx(H,{label:"Total Card Views",value:(d=s.userInfo)==null?void 0:d.totalCardViews})]})})]})]})},Se=256,He=11,la=s=>{const t=Math.max(0,Math.min(s.streak,He)),u={backgroundImage:"url('src/assets/bonsai-growth.png')",backgroundPosition:`${`-${(t===0?0:Math.min(t-1,He-1))*Se}px`} 0px`,backgroundRepeat:"no-repeat",width:`${Se}px`,height:`${Se}px`,imageRendering:"pixelated"};return e.jsx("div",{style:u,"aria-label":`Bonsai growth animation frame for streak ${s.streak}`,role:"img"})};function oa(s){const t=r.useRef(s.streak);return e.jsxs(A,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(M,{className:"p-6",children:e.jsx(z,{className:"text-xl font-semibold text-primary",children:"Login Streak"})}),e.jsxs(O,{className:"py-6 px-0 flex flex-row items-center justify-center gap-8",children:[e.jsx(la,{streak:s.streak}),e.jsx("span",{className:"text-6xl font-extrabold text-green-500 tabular-nums",children:e.jsx(ot,{start:t.current,end:s.streak,duration:.7,preserveValue:!0})},s.streak)]})]})}const ca=s=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 py-6",children:[e.jsx(oa,{streak:s.streak}),e.jsxs(A,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(M,{className:"p-6",children:e.jsx(z,{className:"text-xl font-semibold text-primary",children:"Account Options"})}),e.jsx(O,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ct,{label:"Theme",value:s.theme,onIonChange:t=>s.setTheme(t.detail.value),interface:"popover",placeholder:"Select Theme",children:[e.jsx(ze,{value:"light",children:"Light"}),e.jsx(ze,{value:"dark",children:"Dark"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-black dark:text-white",children:"Change Your Password"}),e.jsx("p",{className:"text-xs dark:text-gray-300",children:"Reset your account password."})]}),e.jsx(w,{color:"primary",onClick:()=>s.setShowPasswordAlert(!0),children:"Change Password"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-black dark:text-white",children:"Delete Your Account"}),e.jsx("p",{className:"text-xs dark:text-gray-300",children:"This will delete all account data and can't be undone."})]}),e.jsx(w,{color:"danger",onClick:()=>s.setShowDeleteAlert(!0),children:"Delete Account"})]})]})})]})]}),e.jsx(fe,{isOpen:s.showPasswordAlert,onDidDismiss:()=>s.setShowPasswordAlert(!1),header:"Change Password",inputs:[{name:"oldPassword",type:"password",placeholder:"Old Password"},{name:"newPassword",type:"password",placeholder:"New Password"},{name:"confirmPassword",type:"password",placeholder:"Confirm New Password"}],buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Save",handler:t=>t.newPassword!==t.confirmPassword?(s.presentToast({message:"Passwords do not match",duration:2e3,color:"danger"}),!0):(console.log("Password changed"),!0)}]}),e.jsx(fe,{isOpen:s.showDeleteAlert,onDidDismiss:()=>s.setShowDeleteAlert(!1),header:"Confirm Deletion",message:"Are you sure you want to delete your account? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Delete",handler:()=>{console.log("Account deleted")}}]})]}),ia=()=>{const{theme:s,setTheme:t}=gs(),[a,n]=r.useState(),[l,o]=r.useState(!0),[u,c]=r.useState(null),[x,i]=r.useState(null),[h,g]=r.useState(!1),[m,f]=r.useState(!1),[d,v]=r.useState(!1),[b,F]=r.useState(a),E=j=>{i(x===j?null:j)},V=()=>{F(a),v(!0)},U=async()=>{if(!S())return;const j=["first_name","last_name","username","email"];try{const N=j.filter(p=>b[p]!==a[p]).map(p=>y(`/api/users/${p}`,{method:"PUT",headers:{[p]:b[p]}}));await Promise.all(N),n(b),v(!1)}catch(N){console.error(N),alert("Failed to update some fields. Please try again.")}},S=()=>{const j={};let N=!0;return b.first_name||(j.first_name="First name is required",N=!1),b.last_name||(j.last_name="Last name is required",N=!1),b.email?/\S+@\S+\.\S+/.test(b.email)||(j.email="Email is invalid",N=!1):(j.email="Email is required",N=!1),b.username||(j.username="Username is required",N=!1),b.first_name=b.first_name.trim(),b.last_name=b.last_name.trim(),b.email=b.email.trim(),b.username=b.username.trim(),ae(j),N},[k,ae]=r.useState({}),J=j=>{const{name:N}=j.target,p=j.detail.value;F(R=>({...R,[N]:p}))};r.useEffect(()=>{(async()=>{o(!0),c(null);try{const N=await y("/api/users/",{method:"GET",headers:{}});n(N),F(N),console.log("data",N)}catch(N){console.log(`Failed to fetch User Data: ${N.message}`),c(`Failed to fetch User Data: ${N.message}`)}finally{o(!1)}})()},[]);const[_]=Ie();return e.jsxs(P,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("p",{className:"text-xl font-semibold text-primary",children:["Welcome back, ",(a==null?void 0:a.username)||"User","!"]})}),e.jsxs(w,{onClick:()=>window.history.back(),fill:"outline",className:"mb-6",children:[e.jsx(C,{slot:"start",icon:ie}),"Back"]}),l&&e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading account details..."})]}),u&&!l&&e.jsx("div",{className:"text-red-500 text-center p-4 border border-red-500 rounded-md",children:u}),!l&&!u&&a&&e.jsxs(e.Fragment,{children:[e.jsx(na,{isEditing:d,errors:k,handleChange:J,handleSave:U,updatedInfo:b,userInfo:a,handleEdit:V}),e.jsx(ca,{streak:(a==null?void 0:a.login_streak)??0,isEditing:d,errors:k,handleChange:J,handleSave:U,updatedInfo:b,userInfo:a,expandedClass:x,toggleClassDetails:E,showPasswordAlert:h,setShowPasswordAlert:g,showDeleteAlert:m,setShowDeleteAlert:f,theme:s,setTheme:t,presentToast:_})]})]})]})};it();const da=new dt;function ua(){return e.jsx(ut,{client:da,children:e.jsx(Ot,{children:e.jsxs(_t,{children:[e.jsx(mt,{children:e.jsx(ht,{children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsxs(xt,{children:[e.jsx(L,{exact:!0,path:"/",component:ea}),e.jsx(L,{exact:!0,path:"/home",component:Zt}),e.jsx(L,{exact:!0,path:"/class/:id",component:Ht}),e.jsx(L,{exact:!0,path:"/auth",component:is}),e.jsx(L,{exact:!0,path:"/reset-password",component:Dt}),e.jsx(L,{exact:!0,path:"/public-cards",component:ta}),e.jsx(L,{exact:!0,path:"/user-account",component:ia}),e.jsx(L,{exact:!0,path:"/flashcards/:id",component:Xt}),e.jsx(L,{exact:!0,path:"/create-set",component:Yt}),e.jsx(L,{exact:!0,path:"/edit-set/:id",component:Qt}),e.jsx(L,{exact:!0,path:"/create-class",component:Jt}),e.jsx(L,{exact:!0,path:"/public-classes",component:aa}),e.jsx(L,{exact:!0,path:"/set-overview/:id",component:ra}),e.jsx(L,{component:sa})]})})})}),e.jsx(Ft,{}),e.jsx(Et,{})]})})})}const ma=document.getElementById("root"),ha=ft(ma);ha.render(e.jsx(ua,{}));export{pa as _,ga as c,ja as g};
//# sourceMappingURL=index-D1rKs0W_.js.map
