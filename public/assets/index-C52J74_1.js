import{t as Is,c as ks,r,j as e,a as ge,S as Ds,R as Je,u as Ye,C as We,L as le,b as Es,d as Ts,$ as As,V as Ke,e as Qe,A as Xe,f as Ze,X as es,T as ss,D as ts,P as Ps,g as as,h as Fs,i as Ce,I as _s,k as Se,l as he,m as rs,n as ee,o as w,p as F,q as Y,s as B,v as Ls,w as oe,x as $,y as Os,z as te,B as k,E as Ie,F as ke,G as De,H as Rs,J as ns,K as re,M as ls,N as Us,O as $s,Q as Bs,U as Ms,W as zs,Y as Gs,Z as je,_ as qs,a0 as Vs,a1 as Hs,a2 as P,a3 as M,a4 as z,a5 as O,a6 as Js,a7 as Ys,a8 as Ws,a9 as Be,aa as Ks,ab as Qs,ac as Xs,ad as Zs,ae as et,af as st,ag as tt,ah as os,ai as xe,aj as pe,ak as W,al as at,am as Me,an as rt,ao as fe,ap as nt,aq as lt,ar as ot,as as it,at as ze,au as ct,av as dt,aw as ut,ax as mt,ay as ht,az as xt,aA as L,aB as ft}from"./nm-C7Nv4H3x.js";import"./index-C52J74_1.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function a(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(o){if(o.ep)return;o.ep=!0;const c=a(o);fetch(o.href,c)}})();var ga=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ja(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function C(...s){return Is(ks(s))}const gt=ge("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ee=r.forwardRef(({className:s,variant:t,...a},n)=>e.jsx("div",{ref:n,role:"alert",className:C(gt({variant:t}),s),...a}));Ee.displayName="Alert";const jt=r.forwardRef(({className:s,...t},a)=>e.jsx("h5",{ref:a,className:C("mb-1 font-medium leading-none tracking-tight",s),...t}));jt.displayName="AlertTitle";const Te=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("text-sm [&_p]:leading-relaxed",s),...t}));Te.displayName="AlertDescription";const pt=ge("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),K=r.forwardRef(({className:s,variant:t,size:a,asChild:n=!1,...o},c)=>{const u=n?Ds:"button";return e.jsx(u,{className:C(pt({variant:t,size:a,className:s})),ref:c,...o})});K.displayName="Button";const ie=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));ie.displayName="Card";const Ae=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("flex flex-col space-y-1.5 p-6",s),...t}));Ae.displayName="CardHeader";const Pe=r.forwardRef(({className:s,...t},a)=>e.jsx("h3",{ref:a,className:C("text-2xl font-semibold leading-none tracking-tight",s),...t}));Pe.displayName="CardTitle";const Fe=r.forwardRef(({className:s,...t},a)=>e.jsx("p",{ref:a,className:C("text-sm text-muted-foreground",s),...t}));Fe.displayName="CardDescription";const _e=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("p-6 pt-0",s),...t}));_e.displayName="CardContent";const Le=r.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:C("flex items-center p-6 pt-0",s),...t}));Le.displayName="CardFooter";const X=r.forwardRef(({className:s,type:t,...a},n)=>e.jsx("input",{type:t,className:C("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...a}));X.displayName="Input";const vt=ge("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Z=r.forwardRef(({className:s,...t},a)=>e.jsx(Je,{ref:a,className:C(vt(),s),...t}));Z.displayName=Je.displayName;const Nt=1,bt=1e6;let be=0;function yt(){return be=(be+1)%Number.MAX_SAFE_INTEGER,be.toString()}const ye=new Map,Ge=s=>{if(ye.has(s))return;const t=setTimeout(()=>{ye.delete(s),ne({type:"REMOVE_TOAST",toastId:s})},bt);ye.set(s,t)},wt=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,Nt)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?Ge(a):s.toasts.forEach(n=>{Ge(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},ue=[];let me={toasts:[]};function ne(s){me=wt(me,s),ue.forEach(t=>{t(me)})}function St({...s}){const t=yt(),a=o=>ne({type:"UPDATE_TOAST",toast:{...o,id:t}}),n=()=>ne({type:"DISMISS_TOAST",toastId:t});return ne({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:o=>{o||n()}}}),{id:t,dismiss:n,update:a}}function is(){const[s,t]=r.useState(me);return r.useEffect(()=>(ue.push(t),()=>{const a=ue.indexOf(t);a>-1&&ue.splice(a,1)}),[s]),{...s,toast:St,dismiss:a=>ne({type:"DISMISS_TOAST",toastId:a})}}const qe={method:"GET",headers:{},credentials:"include"},Ct="https://cowboy-cards.dsouth.org";async function y(s="",t=qe){const a={...qe,...t};try{const n=await fetch(Ct+s,a);if(!n.ok){console.log("resp",n);const c=await n.text();throw new Error(`HTTP error! Status: ${n.status}, Message: ${c}`)}return await n.json()}catch(n){throw console.error("API request failed:",n),n}}const It="modulepreload",kt=function(s,t){return new URL(s,t).href},Ve={},pa=function(t,a,n){let o=Promise.resolve();if(a&&a.length>0){const u=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));o=Promise.allSettled(a.map(d=>{if(d=kt(d,n),d in Ve)return;Ve[d]=!0;const m=d.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(!!n)for(let i=u.length-1;i>=0;i--){const f=u[i];if(f.href===d&&(!m||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${p}`))return;const N=document.createElement("link");if(N.rel=m?"stylesheet":It,m||(N.as="script"),N.crossOrigin="",N.href=d,h&&N.setAttribute("nonce",h),document.head.appendChild(N),m)return new Promise((i,f)=>{N.addEventListener("load",i),N.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${d}`)))})}))}function c(u){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=u,window.dispatchEvent(l),!l.defaultPrevented)throw u}return o.then(u=>{for(const l of u||[])l.status==="rejected"&&c(l.reason);return t().catch(c)})},cs=()=>{const[s,t]=r.useState(!0),[a,n]=r.useState(!1),[o,c]=r.useState(""),[u,l]=r.useState(""),[h,d]=r.useState(""),[m,p]=r.useState(""),[x,N]=r.useState(""),[i,f]=r.useState({}),j=Ye(),{toast:D}=is(),T=()=>{const S={};let I=!0;return o?/\S+@\S+\.\S+/.test(o)||(S.email="Email is invalid",I=!1):(S.email="Email is required",I=!1),u?u.length<8&&(S.password="Password must be at least 8 characters",I=!1):(S.password="Password is required",I=!1),!s&&!h&&(S.username="Username is required",I=!1),f(S),I},V=async S=>{if(S.preventDefault(),!!T()){n(!0),f({});try{let I;s?I=await y("/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:o,password:u})}):I=await y("/signup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:h,email:o,password:u,first_name:m,last_name:x})}),D({title:s?"Welcome back!":"Account created",description:s?"You have been successfully logged in.":"Your account has been created successfully."}),j.push("/home")}catch(I){console.error("Authentication error:",I),f(I),Object.keys(i).length===0&&f({general:I.message||"An unexpected error occurred. Please try again."}),D({title:"Authentication failed",description:I.message||"Please check your credentials and try again.",variant:"destructive"})}finally{n(!1)}}},U=()=>{f({}),s?(d(""),p(""),N("")):(c(""),l(""))};return e.jsxs(ie,{className:"w-[350px]",children:[e.jsxs(Ae,{children:[e.jsx(Pe,{children:s?"Welcome back":"Create account"}),e.jsx(Fe,{children:s?"Enter your credentials to continue":"Sign up for a new account"})]}),e.jsxs("form",{onSubmit:V,children:[e.jsxs(_e,{className:"space-y-4",children:[i.general&&e.jsxs(Ee,{variant:"destructive",className:"mb-4",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx(Te,{children:i.general})]}),!s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"username",children:"Username"}),e.jsx(X,{id:"username",type:"text",placeholder:"johndoe",value:h,onChange:S=>d(S.target.value),required:!0,className:i.username?"border-red-500":""}),i.username&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"firstName",children:"First Name"}),e.jsx(X,{id:"firstName",type:"text",placeholder:"John",value:m,onChange:S=>p(S.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"lastName",children:"Last Name"}),e.jsx(X,{id:"lastName",type:"text",placeholder:"Doe",value:x,onChange:S=>N(S.target.value),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"email",children:"Email"}),e.jsx(X,{id:"email",type:"email",placeholder:"name@example.com",value:o,onChange:S=>c(S.target.value),required:!0,className:i.email?"border-red-500":""}),i.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"password",children:"Password"}),e.jsx(X,{id:"password",type:"password",value:u,onChange:S=>l(S.target.value),required:!0,className:i.password?"border-red-500":""}),i.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.password}),!s&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 8 characters long"})]}),s&&e.jsx(le,{to:"/reset-password",className:"text-sm text-primary",children:"Forgot password?"})]}),e.jsxs(Le,{className:"flex flex-col space-y-4",children:[e.jsxs(K,{type:"submit",className:"w-full",disabled:a,children:[e.jsx(Es,{className:"mr-2 h-4 w-4"}),a?s?"Signing in...":"Signing up...":s?"Sign in":"Sign up"]}),e.jsx(K,{variant:"link",type:"button",onClick:()=>{t(!s),U()},className:"text-sm",disabled:a,children:s?"Need an account? Sign up":"Already have an account? Sign in"})]})]})]})},Dt=()=>{const[s,t]=r.useState(""),[a,n]=r.useState({}),o=c=>{c.preventDefault()};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:e.jsxs(ie,{className:"w-[350px]",children:[e.jsxs(Ae,{children:[e.jsx(Pe,{children:"Reset Password"}),e.jsx(Fe,{children:"Enter your email to reset your password"})]}),e.jsxs("form",{onSubmit:o,children:[e.jsxs(_e,{className:"space-y-4",children:[a.general&&e.jsxs(Ee,{variant:"destructive",className:"mb-4",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx(Te,{children:a.general})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{htmlFor:"email",children:"Email"}),e.jsx(X,{id:"email",type:"email",placeholder:"name@example.com",value:s,onChange:c=>t(c.target.value),required:!0,className:a.email?"border-red-500":""}),a.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.email})]})]}),e.jsx(Le,{className:"flex flex-col space-y-4",children:e.jsx(K,{type:"submit",className:"w-full",children:"Send Reset Link"})})]})]})})},Et=({...s})=>{const{theme:t="system"}=Ts();return e.jsx(As,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},Tt=Ps,ds=r.forwardRef(({className:s,...t},a)=>e.jsx(Ke,{ref:a,className:C("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));ds.displayName=Ke.displayName;const At=ge("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),us=r.forwardRef(({className:s,variant:t,...a},n)=>e.jsx(Qe,{ref:n,className:C(At({variant:t}),s),...a}));us.displayName=Qe.displayName;const Pt=r.forwardRef(({className:s,...t},a)=>e.jsx(Xe,{ref:a,className:C("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));Pt.displayName=Xe.displayName;const ms=r.forwardRef(({className:s,...t},a)=>e.jsx(Ze,{ref:a,className:C("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(es,{className:"h-4 w-4"})}));ms.displayName=Ze.displayName;const hs=r.forwardRef(({className:s,...t},a)=>e.jsx(ss,{ref:a,className:C("text-sm font-semibold",s),...t}));hs.displayName=ss.displayName;const xs=r.forwardRef(({className:s,...t},a)=>e.jsx(ts,{ref:a,className:C("text-sm opacity-90",s),...t}));xs.displayName=ts.displayName;function Ft(){const{toasts:s}=is();return e.jsxs(Tt,{children:[s.map(function({id:t,title:a,description:n,action:o,...c}){return e.jsxs(us,{...c,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(hs,{children:a}),n&&e.jsx(xs,{children:n})]}),o,e.jsx(ms,{})]},t)}),e.jsx(ds,{})]})}const _t=Fs,Lt=r.forwardRef(({className:s,sideOffset:t=4,...a},n)=>e.jsx(as,{ref:n,sideOffset:t,className:C("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));Lt.displayName=as.displayName;const fs=r.createContext(void 0);function Ot({children:s}){const[t,a]=r.useState(()=>{const n=localStorage.getItem("theme");return n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});return r.useEffect(()=>{localStorage.setItem("theme",t),t==="dark"?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},[t]),e.jsx(fs.Provider,{value:{theme:t,setTheme:a},children:s})}function gs(){const s=r.useContext(fs);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s}const Rt=s=>{const[t,a]=r.useState([]),[n,o]=r.useState([]),[c,u]=r.useState(null),[l,h]=r.useState(!1),[d,m]=r.useState(null),[p]=Ce(),x=r.useCallback(async()=>{h(!0),m(null);try{const i=await y("/api/set_user/list",{method:"GET",headers:{}});a(i||[])}catch(i){console.error("Failed to fetch user sets:",i),m(`Failed to load your sets: ${i instanceof Error?i.message:"Unknown error"}`),a([])}finally{h(!1)}},[]);r.useEffect(()=>{s.isOpen?x():(a([]),o([]),u(null),m(null),h(!1))},[s.isOpen,x]),r.useEffect(()=>{const i=t.filter(f=>!s.existingSetIds.includes(f.SetID));o(i)},[t,s.existingSetIds]);const N=async()=>{if(!c||!s.classId){p({message:"Please select a set to add.",duration:2e3,color:"warning"});return}h(!0),m(null);try{await y("/api/class_set/",{method:"POST",headers:{id:s.classId,set_id:c.toString()}}),p({message:"Set added successfully!",duration:2e3,color:"success"}),s.onSetAdded(),s.onDidDismiss()}catch(i){console.error("Failed to add set to class:",i);const f=`Failed to add set: ${i instanceof Error?i.message:"Unknown error"}`;m(f),p({message:f,duration:3e3,color:"danger"})}finally{h(!1)}};return console.log("selectedSetId",c),console.log("availableSets",n),e.jsxs(_s,{isOpen:s.isOpen,onDidDismiss:s.onDidDismiss,children:[e.jsx(Se,{children:e.jsxs(he,{children:[e.jsx(rs,{children:"Add Set to Class"}),e.jsx(ee,{slot:"end",children:e.jsx(w,{onClick:s.onDidDismiss,color:"medium",children:"Cancel"})})]})}),e.jsxs(F,{className:"ion-padding",children:[l&&!n.length?e.jsxs("div",{className:"flex justify-center items-center h-full",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading your sets..."})]}):d?e.jsx(B,{color:"danger",children:e.jsx("p",{children:d})}):n.length===0?e.jsx("p",{className:"text-center text-gray-500 mt-4",children:"You have no available sets to add to this class. Create a new set or check if all your sets are already added."}):e.jsx(Ls,{value:c,onIonChange:i=>{console.log("e.detail.value",i.detail.value),u(Number(i.detail.value))},children:e.jsx(oe,{children:n.map(i=>e.jsxs($,{children:[e.jsx(Os,{slot:"start",value:i.SetID},i.SetID),e.jsxs(te,{children:[e.jsx("h2",{children:i.SetName}),e.jsx("p",{className:"text-sm text-gray-500",children:i.SetDescription})]})]},i.SetID))})}),d&&n.length>0&&e.jsx(B,{color:"danger",className:"block mt-4",children:e.jsx("p",{children:d})})]}),!l&&n.length>0&&e.jsx("div",{className:"ion-padding",children:e.jsx(w,{expand:"block",onClick:N,disabled:!c,className:"ion-margin-bottom",children:l?e.jsx(Y,{name:"dots"}):"Add Selected Set"})})]})},Ut=s=>e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs(w,{routerLink:"/home",color:"primary",children:[e.jsx(k,{slot:"start",icon:Ie}),"Back"]}),s.isTeacher&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{onClick:s.onAddSetClick,color:"primary",disabled:!s.classId,children:[e.jsx(k,{slot:"start",icon:ke}),"Add Existing Set"]}),e.jsxs(w,{routerLink:`/create-set?classId=${s.classId}`,color:"primary",disabled:!s.classId,children:[e.jsx(k,{slot:"start",icon:De}),"Create New Set"]})]})]}),se=s=>e.jsxs("div",{children:[e.jsx($,{children:e.jsx(Rs,{type:s.type,label:s.label,name:s.name,value:s.value,onIonChange:s.onChange})}),s.error&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.error})]}),$t=s=>e.jsx(e.Fragment,{children:s.isEditing?e.jsxs(e.Fragment,{children:[e.jsx(se,{type:"text",label:"Class Name",name:"class_name",value:s.updatedInfo.class_name,onChange:s.handleChange,error:s.errors.className}),e.jsx(se,{type:"text",label:"Class Description",name:"class_description",value:s.updatedInfo.class_description,onChange:s.handleChange,error:s.errors.classDescription}),s.errors.general&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.errors.general}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx(w,{onClick:s.handleSave,color:"primary",size:"small",children:"Save"}),e.jsx(w,{onClick:s.handleCancel,color:"medium",size:"small",children:"Cancel"})]})]}):s.loading?e.jsx("div",{children:"Loading..."}):s.classData?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s.loading?"Loading...":s.classData.ClassName}),s.isTeacher&&!s.isEditing&&e.jsx(k,{icon:De,size:"large",color:"primary",className:"hover:transform hover:scale-110 cursor-pointer p-2",onClick:s.handleEdit})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:s.loading?"Loading...":s.classData.ClassDescription})]}):e.jsx("h1",{children:"Class details unavailable"})}),Bt=s=>e.jsxs(ns,{value:s.selectedTab,onIonChange:t=>s.onTabChange(t.detail.value),className:"w-full mb-6",children:[e.jsxs(re,{value:"flashcards",children:[e.jsx(k,{icon:ls,className:"mr-2"}),e.jsx(te,{children:"Flashcard Sets"})]}),e.jsxs(re,{value:"leaderboard",children:[e.jsx(k,{icon:Us,className:"mr-2"}),e.jsx(te,{children:"Leaderboard"})]}),e.jsxs(re,{value:"students",children:[e.jsx(k,{icon:$s,className:"mr-2"}),e.jsx(te,{children:"Students"})]})]}),js=s=>{const[t,a]=r.useState(!1),n=async u=>{var l;try{const h=await y(`${u}`,{method:"POST",headers:{card_id:s.cardId.toString()}});console.log(`Score update successful for card ${s.cardId}:`,h),(l=s.onAdvance)==null||l.call(s)}catch(h){console.error(`Failed to update score for card ${s.cardId}:`,h)}},o=()=>{n("/api/card_history/incorrect")},c=()=>{n("/api/card_history/correct")};return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsxs("div",{className:`flip-card cursor-pointer ${t?"flipped":""}`,onClick:()=>a(!t),children:[e.jsx(ie,{className:"flip-card-front p-8 min-h-[300px] flex items-center justify-center text-center",children:e.jsx("p",{className:"text-xl",children:s.front})}),e.jsx(ie,{className:"flip-card-back p-8 min-h-[300px] flex items-center justify-center text-center absolute top-0 w-full",children:e.jsx("p",{className:"text-xl",children:s.back})})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-6",children:[e.jsxs(K,{variant:"outline",className:"w-32",onClick:o,children:[e.jsx(es,{className:"mr-2 h-4 w-4"}),"Learning"]}),e.jsxs(K,{className:"w-32",onClick:c,children:[e.jsx(Bs,{className:"mr-2 h-4 w-4"}),"Mastered"]})]})]})},ps=r.createContext(null);function ve(){const s=r.useContext(ps);if(!s)throw new Error("useCarousel must be used within a <Carousel />");return s}const Oe=r.forwardRef(({orientation:s="horizontal",opts:t,setApi:a,plugins:n,className:o,children:c,...u},l)=>{const[h,d]=Ms({...t,axis:s==="horizontal"?"x":"y"},n),[m,p]=r.useState(!1),[x,N]=r.useState(!1),i=r.useCallback(T=>{T&&(p(T.canScrollPrev()),N(T.canScrollNext()))},[]),f=r.useCallback(()=>{d==null||d.scrollPrev()},[d]),j=r.useCallback(()=>{d==null||d.scrollNext()},[d]),D=r.useCallback(T=>{T.key==="ArrowLeft"?(T.preventDefault(),f()):T.key==="ArrowRight"&&(T.preventDefault(),j())},[f,j]);return r.useEffect(()=>{!d||!a||a(d)},[d,a]),r.useEffect(()=>{if(d)return i(d),d.on("reInit",i),d.on("select",i),()=>{d==null||d.off("select",i)}},[d,i]),e.jsx(ps.Provider,{value:{carouselRef:h,api:d,opts:t,orientation:s||((t==null?void 0:t.axis)==="y"?"vertical":"horizontal"),scrollPrev:f,scrollNext:j,canScrollPrev:m,canScrollNext:x},children:e.jsx("div",{ref:l,onKeyDownCapture:D,className:C("relative",o),role:"region","aria-roledescription":"carousel",...u,children:c})})});Oe.displayName="Carousel";const Re=r.forwardRef(({className:s,...t},a)=>{const{carouselRef:n,orientation:o}=ve();return e.jsx("div",{ref:n,className:"overflow-hidden",children:e.jsx("div",{ref:a,className:C("flex",o==="horizontal"?"-ml-4":"-mt-4 flex-col",s),...t})})});Re.displayName="CarouselContent";const Ue=r.forwardRef(({className:s,...t},a)=>{const{orientation:n}=ve();return e.jsx("div",{ref:a,role:"group","aria-roledescription":"slide",className:C("min-w-0 shrink-0 grow-0 basis-full",n==="horizontal"?"pl-4":"pt-4",s),...t})});Ue.displayName="CarouselItem";const vs=r.forwardRef(({className:s,variant:t="outline",size:a="icon",...n},o)=>{const{orientation:c,scrollPrev:u,canScrollPrev:l}=ve();return e.jsxs(K,{ref:o,variant:t,size:a,className:C("absolute  h-8 w-8 rounded-full",c==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!l,onClick:u,...n,children:[e.jsx(zs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Previous slide"})]})});vs.displayName="CarouselPrevious";const Ns=r.forwardRef(({className:s,variant:t="outline",size:a="icon",...n},o)=>{const{orientation:c,scrollNext:u,canScrollNext:l}=ve();return e.jsxs(K,{ref:o,variant:t,size:a,className:C("absolute h-8 w-8 rounded-full",c==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!l,onClick:u,...n,children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Next slide"})]})});Ns.displayName="CarouselNext";const Mt=s=>{var u;const t=je(),[a,n]=r.useState([]),[o,c]=r.useState(null);return r.useEffect(()=>{async function l(){console.log("selectedSet",o);const h=await y("/api/flashcards/list",{method:"GET",headers:{set_id:o}});console.log("cards",h),n(h)}o&&l()},[o]),e.jsx("div",{className:"mt-6",children:s.loading?e.jsx("div",{children:"Loading..."}):o===null?(u=s.flashcardSets)!=null&&u.length?e.jsx(qs,{children:e.jsx(Vs,{children:s.flashcardSets.sort((l,h)=>l.ID-h.ID).map(l=>e.jsx(Hs,{size:"12",sizeMd:"6",sizeLg:"4",children:e.jsxs(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-200 rounded-lg border shadow-sm",onClick:()=>t.push(`/set-overview/${l.ID}`),children:[e.jsx(M,{children:e.jsx(z,{className:"text-lg font-semibold",children:l.SetName})}),e.jsx(O,{children:e.jsx("p",{className:"text-muted-foreground mb-2",children:l.SetDescription})})]})},l.ID))})}):e.jsx("p",{children:"No flashcard sets available."}):e.jsxs(e.Fragment,{children:[e.jsxs(w,{fill:"outline",onClick:()=>c(null),className:"mb-6",children:[e.jsx(k,{slot:"start",icon:Ie}),"Back to Sets"]}),e.jsxs("div",{className:"w-full max-w-2xl mx-auto relative",children:[e.jsxs(Oe,{orientation:"vertical",className:"w-full",setApi:s.setApi,children:[e.jsx(Re,{className:"-mt-1 h-[400px]",children:a.map(l=>e.jsx(Ue,{children:e.jsx(js,{front:l.Front,back:l.Back,cardId:l.ID})},l.ID))}),e.jsx(vs,{}),e.jsx(Ns,{})]}),e.jsx("div",{className:"absolute right-[-50px] top-1/2 transform -translate-y-1/2 flex flex-col gap-2",children:a.map((l,h)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${h===s.currentCardIndex?"bg-primary":"bg-gray-300"}`},h))})]})]})})},$e=()=>e.jsx(Js,{className:"hidden md:block ion-no-border fixed bottom-0 w-full",children:e.jsxs(he,{children:[e.jsx(ee,{slot:"start",children:e.jsx(w,{routerLink:"/home",children:e.jsx(k,{icon:Ys})})}),e.jsx(B,{className:"mx-auto text-center text-sm",children:"Cowboy Cards 2025. Built for learning and fun."})]})}),zt=s=>e.jsxs(P,{className:"rounded-lg border shadow-sm",children:[e.jsx(M,{children:e.jsx(z,{className:"text-xl font-semibold",children:"Class Leaderboard"})}),e.jsx(O,{children:e.jsx(oe,{className:"space-y-3",lines:"none",children:s.leaderboard===null?e.jsx("h1",{className:"text-center text-gray-500",children:"No scores available"}):s.leaderboard.map(t=>e.jsxs($,{className:"muted-item p-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"font-medium text-lg",children:t.Username})}),e.jsxs("span",{slot:"end",className:"text-primary font-semibold",children:[t.ClassScore," points"]})]},t.UserID))})})]}),Gt=s=>e.jsx(e.Fragment,{children:s.loadingScores?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Calculating scores..."})]}):e.jsx(zt,{leaderboard:s.leaderboardData})}),G=()=>{const[s,t]=r.useState(null),a=d=>t(d.nativeEvent),n=()=>t(null),o=d=>{var m;c.push(d),(m=document.querySelector("ion-menu"))==null||m.close()},c=Ye(),{theme:u,setTheme:l}=gs(),h=()=>{l(u==="dark"?"light":"dark")};return e.jsxs(e.Fragment,{children:[e.jsxs(Ws,{side:"start",contentId:"main-content",children:[e.jsx(Se,{children:e.jsx(he,{children:e.jsx(ee,{slot:"start",children:e.jsx(Be,{children:e.jsx(w,{children:e.jsx(k,{icon:Ks})})})})})}),e.jsx(F,{children:e.jsxs(oe,{children:[e.jsx($,{button:!0,onClick:()=>o("/home"),children:"My Dashboard"}),e.jsx($,{button:!0,onClick:()=>o("/public-cards"),children:"Public Cards"}),e.jsx($,{button:!0,onClick:()=>o("/public-classes"),children:"Public Classes"}),e.jsx($,{button:!0,onClick:()=>o("/user-account"),children:"My Account"})]})})]}),e.jsx(Se,{children:e.jsxs(he,{children:[e.jsx(ee,{slot:"start",children:e.jsx(Be,{children:e.jsx(w,{children:e.jsx(k,{icon:Qs})})})}),e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>c.push("/home"),children:[e.jsx("img",{src:"src/assets/Spirit-Cowboy-Profile-Only.png",alt:"Cowboy Cards Logo",className:"h-8 w-auto md:hidden"}),e.jsx(rs,{color:"primary",className:"hidden md:inline-block text-lg md:text-xl lg:text-2xl font-bold hover:translate-x-1 transition-all duration-300",children:"Cowboy Cards"})]}),e.jsxs(ee,{slot:"end",children:[e.jsx(w,{onClick:a,children:e.jsx(k,{icon:Xs,className:"text-[32px] stroke-[2]"})}),e.jsx(Zs,{event:s,isOpen:!!s,onDidDismiss:n,children:e.jsx(F,{className:"p-2",children:e.jsxs(oe,{children:[e.jsx($,{button:!0,onClick:()=>{n(),c.push("/create-set")},children:"Create Set"}),e.jsx($,{button:!0,onClick:()=>{n(),c.push("/create-class")},children:"Create Class"}),e.jsx($,{button:!0,onClick:()=>{n(),c.push("/public-classes")},children:"Join Class"})]})})}),e.jsx(w,{fill:"clear",onClick:h,children:e.jsx(k,{slot:"icon-only",icon:u==="dark"?et:st})})]}),e.jsx(ee,{slot:"end",children:e.jsx(w,{routerLink:"/user-account",children:e.jsx(k,{icon:tt,size:"large"})})})]})})]})},qt=s=>e.jsxs(P,{className:"mt-6",children:[e.jsx(M,{children:e.jsx(z,{className:"text-xl font-semibold",children:"Class Students"})}),e.jsx(O,{children:e.jsx(oe,{className:"space-y-3",lines:"none",children:s.students.map(t=>e.jsxs($,{className:"muted-item p-3",children:[e.jsxs("span",{className:"font-medium",children:[t.FirstName," ",t.LastName]}),e.jsx("span",{slot:"end",className:"text-muted-foreground",children:t.email}),s.isTeacher&&e.jsx(k,{slot:"end",icon:os,color:"danger",className:"cursor-pointer",onClick:()=>s.onDeleteStudent(t.UserID)})]},t.UserID))})})]}),Vt=s=>{const[t,a]=r.useState({isOpen:!1,studentId:null}),n=o=>{a({isOpen:!0,studentId:o})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(qt,{isTeacher:s.isTeacher,students:s.students,onDeleteStudent:n})}),e.jsx(xe,{isOpen:t.isOpen,onDidDismiss:()=>a({isOpen:!1,studentId:null}),header:"Confirm Deletion",message:"Are you sure you want to remove this student from the class? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Delete",handler:()=>{t.studentId!==null&&(s.handleActualDelete(t.studentId),console.log(`Student deletion initiated for ID: ${t.studentId}`))}}]})]})},Ht=()=>{const{id:s}=pe();console.log("id",s);const[t,a]=r.useState(0),[n,o]=r.useState(),[c,u]=r.useState("flashcards"),[l,h]=r.useState(!1),[d,m]=r.useState(),[p,x]=r.useState([]),[N,i]=r.useState([]),[f,j]=r.useState(null),[D,T]=r.useState(!1),[V,U]=r.useState([]),[S,I]=r.useState(!1),[ae,J]=r.useState(!1),[_,g]=r.useState({class_name:"",class_description:""}),[b,v]=r.useState(!1),R=()=>{console.log("Handling Edit"),g({class_name:(d==null?void 0:d.ClassName)||"",class_description:(d==null?void 0:d.ClassDescription)||""}),J(!0)},[Q,Ne]=r.useState({}),bs=()=>{const E={};let A=!0;return _.class_name=_.class_name.trim(),_.class_description=_.class_description.trim(),_.class_name||(E.className="Class name is required",A=!1),_.class_description||(E.classDescription="Class description is required",A=!1),Ne(E),A},ys=async()=>{if(!bs()){console.log("Form validation failed:",Q);return}const E=["class_name","class_description"];try{const A=E.map(q=>y(`/api/classes/${q}`,{method:"PUT",headers:{id:s,[q]:_[q]}}));await Promise.all(A),m(q=>({...q,ClassName:_.class_name,ClassDescription:_.class_description})),J(!1)}catch(A){console.error(A),alert("Failed to update some fields. Please try again.")}},ws=E=>{const{name:A}=E.target,q=E.detail.value;g(de=>({...de,[A]:q}))},Ss=()=>{J(!1)},ce=r.useCallback(async()=>{T(!0),I(!0),j(null);try{const[E,A,q,de]=await Promise.all([y("/api/classes/",{method:"GET",headers:{id:s}}),y("/api/class_set/list_sets",{method:"GET",headers:{id:s}}),y("/api/class_user/members",{method:"GET",headers:{class_id:s}}),y("/api/classes/leaderboard",{method:"GET",headers:{id:s}})]);console.log("data",E),h(E.Role==="teacher"),m(E),console.log("sets",A),x(A||[]),console.log("users",q),i(q||[]),console.log("scores",de),U(de||[])}catch(E){let A="Unknown error";E instanceof Error&&(A=E.message),j(`Error fetching class data: ${A}`),m(void 0),x([]),i([]),U([])}finally{T(!1),I(!1)}},[s]);r.useEffect(()=>{ce()},[ce]);const Cs=async E=>{if(E!==null)try{await y("/api/class_user/",{method:"DELETE",headers:{student_id:E,id:s}}),ce()}catch(A){console.error("Error deleting student:",A),j("Error deleting student")}};return r.useEffect(()=>{n&&n.on("select",()=>{a(n.selectedScrollSnap())})},[n]),e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsxs(F,{className:"ion-padding",children:[e.jsxs("div",{id:"main-content",className:"max-w-4xl mx-auto",children:[f&&e.jsx("div",{className:"text-red-500",children:f}),e.jsx($t,{classData:d,isTeacher:l,loading:D,handleEdit:R,isEditing:ae,updatedInfo:_,errors:Q,handleChange:ws,handleSave:ys,handleCancel:Ss}),e.jsx(Ut,{isTeacher:l,classId:s,onAddSetClick:()=>v(!0)}),e.jsx(Bt,{selectedTab:c,onTabChange:u}),c==="leaderboard"&&e.jsx(Gt,{leaderboardData:V,loadingScores:S}),c==="flashcards"&&e.jsx(Mt,{flashcardSets:p,currentCardIndex:t,setApi:o,loading:D}),c==="students"&&e.jsx(Vt,{isTeacher:l,students:N,handleActualDelete:Cs})]}),e.jsx($e,{})]}),e.jsx(Rt,{isOpen:b,onDidDismiss:()=>v(!1),classId:s,existingSetIds:p.map(E=>E.ID),onSetAdded:ce})]})},Jt=()=>{const[s,t]=r.useState(!1),[a,n]=r.useState(!1),[o,c]=r.useState(null),[u,l]=r.useState({className:"",description:""}),[h,d]=r.useState(!1);return r.useEffect(()=>{async function m(){if(s){n(!0),c(null);try{const p=await y("/api/classes",{method:"POST",headers:{class_name:u.className,class_description:u.description}});console.log("Class created successfully:",p),t(!1),l({className:"",description:""}),d(!0),n(!1)}catch(p){c(`Failed to create class: ${p.message}`)}finally{n(!1)}}}s&&m()},[s,u]),e.jsxs(F,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[o&&e.jsx("div",{className:"text-red-500 mt-2",children:o}),e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Create New Class"}),e.jsxs("form",{children:[e.jsx(P,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsx(W,{placeholder:"Enter Class Name",value:u.className,onIonChange:m=>l(p=>({...p,className:m.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),e.jsx(W,{placeholder:"Enter Class Description",value:u.description,onIonChange:m=>l(p=>({...p,description:m.detail.value||""})),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}})]})}),e.jsx("div",{className:"flex flex-col md:flex-row justify-center md:justify-end gap-4 mt-8",children:e.jsx(w,{color:"success",disabled:a,onClick:()=>t(!0),children:a?"Creating...":"Create Class"})})]}),h&&e.jsx(B,{children:e.jsx("p",{children:"Class created successfully!"})})]})]})},Yt=()=>{const s=je(),[t,a]=r.useState(""),[n,o]=r.useState(""),[c,u]=r.useState({title:"",description:""}),[l,h]=r.useState(!1),[d,m]=r.useState(null),p=async()=>{h(!0),m(null);const x={title:"",description:""};let N=!1;if(t.trim()||(x.title="Title is required",N=!0),n.trim()||(x.description="Description is required",N=!0),u(x),N){h(!1);return}try{const i=await y("/api/flashcards/sets",{method:"POST",headers:{set_name:t,set_description:n}});s.push(`/set-overview/${i.ID}`)}catch(i){console.error("Error saving flashcard set:",i),m(`Failed to save flashcard set: ${i.message}`)}finally{h(!1)}};return e.jsxs(F,{className:"ion-padding",children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[l&&e.jsx("div",{children:"Loading..."}),d&&e.jsx("div",{className:"text-red-500 mt-2",children:d}),e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Create New Flashcard Set"}),e.jsx(P,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsx(W,{placeholder:"Enter set title",value:t,onIonChange:x=>a(x.detail.value),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),c.title&&e.jsx(B,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:c.title})}),e.jsx(W,{placeholder:"Enter set description",value:n,onIonChange:x=>o(x.detail.value),rows:1,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}}),c.description&&e.jsx(B,{color:"danger",children:e.jsx("p",{className:"text-sm mt-1",children:c.description})})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(w,{color:"success",className:"rounded-lg shadow-sm w-full md:w-auto",onClick:p,disabled:l,children:l?"Creating...":"Create Set"})})]})]})},Wt=s=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Edit Cards"}),s.cards.map((t,a)=>e.jsx(P,{className:"mb-4 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"text-sm font-semibold text-gray-600",children:["Card ",a+1," ",t.ID>0?"(Existing)":"(New)"]}),e.jsx(w,{fill:"clear",color:"danger",size:"small",onClick:()=>s.onRemoveCard(a),className:"-mt-2 -mr-2",children:e.jsx(k,{slot:"icon-only",icon:os})})]}),e.jsx(W,{label:`Front (Card ${a+1})`,labelPlacement:"stacked",placeholder:"Front of card",value:t.Front,onIonChange:n=>s.onUpdateCard(a,"Front",n.detail.value),rows:2,autoGrow:!0,className:"mb-3",style:{resize:"none"}}),e.jsx(W,{label:`Back (Card ${a+1})`,labelPlacement:"stacked",placeholder:"Back of card",value:t.Back,onIonChange:n=>s.onUpdateCard(a,"Back",n.detail.value),rows:2,autoGrow:!0,style:{resize:"none"}})]})},t.ID)),e.jsx("div",{className:"flex justify-center mt-4 mb-6",children:e.jsxs(w,{onClick:s.onAddCard,fill:"outline",children:[e.jsx(k,{slot:"start",icon:ke})," Add Card"]})})]}),Kt=s=>e.jsx(P,{className:"mb-6 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsx(W,{label:"Set Title",labelPlacement:"stacked",placeholder:"Enter set title",value:s.setName,onIonChange:t=>s.onNameChange(t.detail.value),rows:1,autoGrow:!0,className:"w-full text-xl font-bold mb-2",style:{resize:"none"}}),e.jsx(W,{label:"Set Description",labelPlacement:"stacked",placeholder:"Enter set description",value:s.setDescription,onIonChange:t=>s.onDescriptionChange(t.detail.value),rows:2,autoGrow:!0,className:"w-full text-base mt-4",style:{resize:"none"}})]})}),Qt=()=>{const{id:s}=pe(),[t]=Ce(),[a,n]=r.useState(null),[o,c]=r.useState([]),[u,l]=r.useState(""),[h,d]=r.useState(""),[m,p]=r.useState([]),[x,N]=r.useState(!0),[i,f]=r.useState(null),[j,D]=r.useState(!1),[T,V]=r.useState(null),U=r.useCallback(async()=>{if(!s){f("Set ID is missing from URL."),N(!1);return}N(!0),f(null),V(null);try{const[g,b]=await Promise.all([y("/api/flashcards/sets/",{method:"GET",headers:{id:s}}),y("/api/flashcards/list",{method:"GET",headers:{set_id:s}})]);n(g),c(b),l(g.SetName),d(g.SetDescription),p(b?b.map(v=>({...v,ID:v.ID||0})):[])}catch(g){console.error("Error fetching data for EditSet:",g);let b="Unknown error";g instanceof Error&&(b=g.message),f(`Failed to load set data: ${b}`)}finally{N(!1)}},[s]);r.useEffect(()=>{U()},[U]);const S=(g,b)=>{const v=b??"";g==="SetName"?l(v):d(v)},I=()=>{if(!a)return;const g={ID:0,Front:"",Back:"",SetID:a.ID,CreatedAt:new Date().toISOString(),UpdatedAt:new Date().toISOString()};p([...m,g])},ae=g=>{p(m.filter((b,v)=>v!==g))},J=(g,b,v)=>{const R=v??"";p(m.map((Q,Ne)=>Ne===g?{...Q,[b]:R}:Q))},_=async()=>{if(!a||j)return;D(!0),V(null);const g=[];u!==a.SetName&&g.push(y("/api/flashcards/sets/set_name",{method:"PUT",headers:{id:a.ID,set_name:u}})),h!==a.SetDescription&&g.push(y("/api/flashcards/sets/set_description",{method:"PUT",headers:{id:a.ID,set_description:h}}));const b=new Set(m.map(v=>v.ID).filter(v=>v>0));o&&o.forEach(v=>{b.has(v.ID)||g.push(y("/api/flashcards",{method:"DELETE",headers:{id:v.ID}}))}),m.forEach(v=>{if(v.ID<=0)g.push(y("/api/flashcards",{method:"POST",headers:{front:v.Front,back:v.Back,id:a.ID}}));else{const R=o.find(Q=>Q.ID===v.ID);R&&(v.Front!==R.Front&&g.push(y("/api/flashcards/front",{method:"PUT",headers:{id:v.ID,front:v.Front}})),v.Back!==R.Back&&g.push(y("/api/flashcards/back",{method:"PUT",headers:{id:v.ID,back:v.Back}})))}});try{await Promise.all(g),t({message:"Changes saved successfully!",duration:2e3,color:"success"}),await U()}catch(v){console.error("Error saving changes:",v);let R="Unknown error during save";v instanceof Error&&(R=v.message),V(`Failed to save changes: ${R}`),t({message:`Save failed: ${R}`,duration:3e3,color:"danger"})}finally{D(!1)}};return e.jsxs(at,{children:[e.jsx(G,{}),e.jsx(F,{className:"ion-padding",children:e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Edit Flashcard Set"}),e.jsx(Me,{isOpen:x,message:"Loading set data..."}),e.jsx(Me,{isOpen:j,message:"Saving changes..."}),i&&!x&&e.jsx(B,{color:"danger",className:"block mb-4",children:e.jsxs("p",{children:["Error loading data: ",i]})}),T&&!j&&e.jsx(B,{color:"danger",className:"block mb-4",children:e.jsxs("p",{children:["Error saving: ",T]})}),!x&&!i&&a&&e.jsxs(e.Fragment,{children:[e.jsx(Kt,{setName:u,setDescription:h,onNameChange:g=>S("SetName",g),onDescriptionChange:g=>S("SetDescription",g)}),e.jsx(Wt,{cards:m,onAddCard:I,onRemoveCard:ae,onUpdateCard:J}),e.jsx("div",{className:"flex justify-end",children:e.jsx(w,{onClick:_,color:"primary",disabled:j,children:j?"Saving...":"Save Changes"})})]})]})}),e.jsx($e,{})]})},Xt=()=>{const{id:s}=pe();je();const[t,a]=r.useState(""),[n,o]=r.useState(""),[c,u]=r.useState([]),[l,h]=r.useState(),[d,m]=r.useState(0),[p,x]=r.useState(!0);r.useEffect(()=>{const i=async()=>{try{const j=await y("/api/flashcards/sets/",{method:"GET",headers:{id:s}});a(j.SetName),o(j.SetDescription)}catch(j){console.error("Failed to fetch set info",j)}},f=async()=>{x(!0);try{const j=await y("/api/flashcards/list",{method:"GET",headers:{set_id:s}});u(Array.isArray(j)?j.map(D=>({ID:D.ID,Front:D.Front,Back:D.Back,SetID:D.SetID,CreatedAt:D.CreatedAt,UpdatedAt:D.UpdatedAt})):[])}catch(j){console.error("Failed to fetch cards",j),u([])}finally{x(!1)}};s&&(i(),f())},[s]),r.useEffect(()=>{if(!l)return;const i=()=>{m(l.selectedScrollSnap())};return i(),l.on("select",i),l.on("reInit",i),()=>{l.off("select",i),l.off("reInit",i)}},[l]);const N=()=>{l&&l.scrollNext()};return e.jsxs(F,{className:"ion-padding",children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(w,{className:"rounded-lg",fill:"outline",style:{"--border-radius":"0.5rem"},routerLink:`/set-overview/${s}`,children:"Back"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:t}),e.jsx("p",{className:"text-gray-500",children:n})]})]}),e.jsx("div",{className:"w-full max-w-xl mx-auto relative py-8 min-h-[400px] flex items-center justify-center",children:p?e.jsx(Y,{name:"circular"}):c.length===0?e.jsx("div",{className:"text-center text-gray-500 text-lg py-20",children:"This set has no cards yet."}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{orientation:"vertical",setApi:h,className:"w-full",children:e.jsx(Re,{className:"-mt-1 h-[400px]",children:c.map((i,f)=>e.jsx(Ue,{children:e.jsx(js,{front:i.Front,back:i.Back,onAdvance:N,cardId:i.ID})},f))})}),e.jsx("div",{className:"absolute right-[-50px] top-1/2 transform -translate-y-1/2 flex flex-col gap-2",children:c.map((i,f)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${f===d?"bg-primary":"bg-gray-300"}`},f))})]})})]})]})},Zt=()=>{const[s,t]=r.useState("classes"),[a,n]=r.useState([]),[o,c]=r.useState([]),[u,l]=r.useState(!1),[h,d]=r.useState(!1),[m,p]=r.useState(null);return r.useEffect(()=>{console.log("Classes state updated:",a)},[a]),r.useEffect(()=>{const x=async()=>{l(!0),p(null);try{const i=await y("/api/class_user/classes");console.log("Classes: ",i),n(i)}catch(i){p(`Error fetching classes: ${i.message}`)}finally{l(!1)}},N=async()=>{d(!0);try{const i=await y("/api/set_user/list");console.log("Sets: ",i),c(i)}catch(i){p(`Error fetching sets: ${i.message}`)}finally{d(!1)}};x(),N()},[]),e.jsx(e.Fragment,{children:e.jsxs(F,{className:"ion-padding flex flex-col min-h-screen",fullscreen:!0,children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 flex-grow",children:[m&&e.jsx("div",{className:"text-red-500 mt-2",children:m}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:s==="classes"?"My Classes":"Personal Flashcard Sets"}),e.jsx("div",{className:"flex items-center gap-2 mt-4 md:mt-0",children:e.jsxs(w,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},href:s==="classes"?"/public-classes":"/public-cards",children:[e.jsx(k,{slot:"start",icon:ke})," ",s==="classes"?"Join Class":"Join Set"]})})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(ns,{value:s,onIonChange:x=>t(x.detail.value||"classes"),style:{"--background":"var(--ion-color-light)"},children:[e.jsxs(re,{value:"classes",children:[e.jsx(k,{icon:rt,className:"mr-2"}),e.jsx(te,{children:"My Classes"})]}),e.jsxs(re,{value:"flashcards",children:[e.jsx(k,{icon:ls,className:"mr-2"}),e.jsx(te,{children:"My Cards"})]})]})}),s==="classes"&&e.jsx(e.Fragment,{children:u?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading classes..."})]}):a===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any classes. Join a class to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(x=>e.jsx(le,{to:`/class/${x.ClassID}`,children:e.jsxs(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(M,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(z,{className:"text-2xl font-semibold leading-none tracking-tight",children:x.ClassName}),e.jsx(fe,{className:"text-sm text-muted-foreground",children:x.ClassDescription})]}),e.jsx(O,{})]})},x.ClassID))})}),s==="flashcards"&&e.jsx(e.Fragment,{children:h?e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading sets..."})]}):o===null?e.jsx("div",{className:"text-center p-8 text-gray-600",children:"You are not part of any sets. Join a set to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:o.map(x=>e.jsx(le,{to:`/set-overview/${x.SetID}`,children:e.jsxs(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:[e.jsxs(M,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(z,{className:"text-2xl font-semibold leading-none tracking-tight",children:x.SetName}),e.jsx(fe,{className:"text-sm text-muted-foreground",children:x.SetDescription})]}),e.jsx(O,{})]})},x.SetID))})})]}),e.jsx($e,{})]})})},ea=()=>e.jsx(F,{children:e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center from-white to-gray-50",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-primary mb-2",children:"CowboyCards"}),e.jsx("p",{children:"Master any subject with smart flashcards"})]}),e.jsx(cs,{})]})}),sa=()=>{const s=nt();return r.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",s.pathname)},[s.pathname]),e.jsxs(F,{children:[e.jsx(G,{}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})]})},ta=()=>{const[s,t]=r.useState(null),[a,n]=r.useState(!1),[o,c]=r.useState([]),[u,l]=r.useState(""),h=o.filter(d=>d.SetName.toLowerCase().includes(u.toLowerCase())||d.SetDescription&&d.SetDescription.toLowerCase().includes(u.toLowerCase()));return r.useEffect(()=>{async function d(){n(!0),t(null);try{const m=await y("/api/flashcards/sets/list");c(m)}catch(m){console.error("Error fetching flashcard sets:",m),t(`Error fetching flashcard sets: ${m.message}`)}finally{n(!1)}}d()},[]),e.jsxs(F,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 w-1/2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold pb-8",children:"Public Flashcard Sets"}),a&&e.jsx("div",{children:"Loading..."}),s&&e.jsx("div",{className:"text-red-500 mt-2",children:s}),e.jsx(lt,{value:u,onIonInput:d=>l(d.target.value),placeholder:"Search flashcard sets",className:"mb-4 w-1/2"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:h.map(d=>e.jsx(le,{to:`/flashcards/${d.ID}`,children:e.jsx(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(M,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(z,{className:"text-2xl font-semibold leading-none tracking-tight",children:d.SetName}),e.jsx(fe,{className:"text-sm ",children:d.SetDescription||"No description"})]})})},d.ID))})]})]})},aa=()=>{const[s,t]=r.useState([]),[a,n]=r.useState(!1),[o,c]=r.useState(null);return r.useEffect(()=>{(async()=>{n(!0),c(null);try{const l=await y("/api/classes/list");t(l),n(!1)}catch(l){c(`Error fetching classes: ${l.message}`)}finally{n(!1)}})()},[]),e.jsxs(F,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold pb-8",children:"Public Classes"}),a&&e.jsx("div",{children:"Loading..."}),o&&e.jsx("div",{className:"text-red-500 mt-2",children:o}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(u=>e.jsx(le,{to:`/class/${u.ID}`,children:e.jsx(P,{className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-transform-shadow duration-200 rounded-lg border shadow-sm",children:e.jsxs(M,{className:"flex flex-col space-y-1.5 p-6",children:[e.jsx(z,{className:"text-2xl font-semibold leading-none tracking-tight",children:u.ClassName}),e.jsx(fe,{className:"text-sm ",children:u.ClassDescription||"No description"}),e.jsx(w,{expand:"block",color:"primary",className:"mt-4",onClick:async()=>{try{const l=await y("/api/class_user",{method:"POST",headers:{class_id:u.ID,role:"student"}});console.log("Join class response:",l)}catch(l){console.error("Error joining class:",l)}},children:"Join Class"})]})})},u.ID))})]})]})},ra=()=>{const{id:s}=pe(),t=je(),[a,n]=r.useState(""),[o,c]=r.useState(""),[u,l]=r.useState([]),[h,d]=r.useState(!0),[m,p]=r.useState(!1);r.useEffect(()=>{const N=async()=>{try{const f=await y("/api/flashcards/sets/",{method:"GET",headers:{id:s}});n(f.SetName),c(f.SetDescription)}catch(f){console.error("Failed to fetch set info",f)}},i=async()=>{d(!0);try{const f=await y("/api/flashcards/list",{method:"GET",headers:{set_id:s}});l(Array.isArray(f)?f:[])}catch(f){console.error("Failed to fetch cards",f),l([])}finally{d(!1)}};s&&(N(),i())},[s]);const x=async()=>{if(!s){console.error("Cannot delete set: ID is missing.");return}try{await y("/api/flashcards/sets/",{method:"DELETE",headers:{id:s}}),t.push("/student-dashboard")}catch(N){console.error("Failed to delete set:",N)}};return e.jsxs(F,{className:"ion-padding",children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 pr-4",children:[e.jsx(w,{className:"rounded-lg",fill:"outline",style:{"--border-radius":"0.5rem"},onClick:()=>window.history.back(),children:"Back"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-3xl font-bold",children:a}),e.jsx("p",{className:"text-base mt-1 text-gray-700",children:o})]})]}),e.jsxs("div",{className:"self-start md:self-center flex gap-2 md:mt-0 mt-4 w-full md:w-auto",children:[e.jsx(w,{className:"rounded-lg w-1/3 md:w-auto",fill:"outline",style:{"--border-radius":"0.5rem"},routerLink:`/edit-set/${s}`,children:"Edit Set"}),e.jsx(w,{className:"rounded-lg w-1/3 md:w-auto",color:"primary",style:{"--border-radius":"0.5rem"},routerLink:`/flashcards/${s}`,children:"Study Set"}),e.jsx(w,{className:"rounded-lg w-1/3 md:w-auto",color:"danger",style:{"--border-radius":"0.5rem"},onClick:()=>p(!0),children:"Delete Set"})]})]}),e.jsx("div",{className:"mt-8 min-h-[200px] flex items-center justify-center",children:h?e.jsx(Y,{name:"circular"}):u.length===0?e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-900 dark:text-gray-400 mb-4",children:"This set has no cards yet."}),e.jsx(w,{color:"primary",className:"rounded-lg",style:{"--border-radius":"0.5rem"},routerLink:`/edit-set/${s}`,children:"Add Cards"})]}):e.jsx("div",{className:"w-full",children:u.map((N,i)=>e.jsx(P,{className:"mb-4 rounded-lg border shadow-sm",children:e.jsxs(O,{children:[e.jsx("div",{className:"border-b border-gray-300 mb-3 pb-1 m-4",children:e.jsxs(B,{className:"text-md font-semibold text-gray-900 dark:text-gray-300",children:["Card ",i+1]})}),e.jsxs("div",{className:"flex flex-row justify-between items-start",children:[e.jsx("div",{className:"w-3/12 pr-4 border-r border-gray-300 m-4",children:e.jsx(B,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:N.Front})}),e.jsx("div",{className:"w-9/12 pl-4 m-4",children:e.jsx(B,{className:"block whitespace-pre-wrap text-lg text-gray-900 dark:text-gray-200",children:N.Back})})]})]})},i))})})]}),e.jsx(xe,{isOpen:m,onDidDismiss:()=>p(!1),header:"Confirm Deletion",message:"Are you sure you want to delete this set? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Delete canceled")}},{text:"Delete",role:"destructive",handler:()=>{x()}}]})]})},H=s=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium",children:[s.label,":"]}),e.jsx("span",{children:s.value})]}),na=s=>{var t,a,n,o,c,u,l,h,d,m,p,x,N,i;return e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs(P,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(M,{className:"p-6",children:e.jsx(z,{className:"text-xl font-semibold text-primary",children:"Account Information"})}),e.jsx(O,{className:"p-6 pt-0",children:s.isEditing?e.jsxs("div",{className:"space-y-4",children:[e.jsx(se,{type:"text",label:"First Name",name:"first_name",value:((t=s.updatedInfo)==null?void 0:t.first_name)||"",error:s.errors.first_name,onChange:s.handleChange}),e.jsx(se,{type:"text",label:"Last Name",name:"last_name",value:((a=s.updatedInfo)==null?void 0:a.last_name)||"",error:s.errors.last_name,onChange:s.handleChange}),e.jsx(se,{type:"text",label:"Username",name:"username",value:((n=s.updatedInfo)==null?void 0:n.username)||"",error:s.errors.username,onChange:s.handleChange}),e.jsx(se,{type:"email",label:"Email",name:"email",value:((o=s.updatedInfo)==null?void 0:o.email)||"",error:s.errors.email,onChange:s.handleChange}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(w,{onClick:s.handleSave,children:"Save Changes"})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(H,{label:"First Name",value:(c=s.userInfo)==null?void 0:c.first_name}),e.jsx(H,{label:"Last Name",value:(u=s.userInfo)==null?void 0:u.last_name}),e.jsx(H,{label:"Username",value:(l=s.userInfo)==null?void 0:l.username}),e.jsx(H,{label:"Email",value:(h=s.userInfo)==null?void 0:h.email}),e.jsxs(w,{fill:"outline",onClick:s.handleEdit,className:"mt-4",children:[e.jsx(k,{slot:"start",icon:De}),"Edit Info"]})]})})]}),e.jsxs(P,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(M,{className:"p-6",children:e.jsx(z,{className:"text-xl font-semibold text-primary",children:"Account Stats"})}),e.jsx(O,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(H,{label:"Account Created",value:(d=s.userInfo)==null?void 0:d.created_at}),e.jsx(H,{label:"Login Streak",value:(m=s.userInfo)==null?void 0:m.login_streak}),e.jsx(H,{label:"Classes Taken",value:(p=s.userInfo)==null?void 0:p.numClasses}),e.jsx(H,{label:"Cards Mastered/Studied",value:`${(x=s.userInfo)==null?void 0:x.cardsMastered} / ${(N=s.userInfo)==null?void 0:N.cardsStudied}`}),e.jsx(H,{label:"Total Card Views",value:(i=s.userInfo)==null?void 0:i.totalCardViews})]})})]})]})},we=256,He=11,la=s=>{const t=Math.max(0,Math.min(s.streak,He)),u={backgroundImage:"url('src/assets/bonsai-growth.png')",backgroundPosition:`${`-${(t===0?0:Math.min(t-1,He-1))*we}px`} 0px`,backgroundRepeat:"no-repeat",width:`${we}px`,height:`${we}px`,imageRendering:"pixelated"};return e.jsx("div",{style:u,"aria-label":`Bonsai growth animation frame for streak ${s.streak}`,role:"img"})};function oa(s){const t=r.useRef(s.streak);return e.jsxs(P,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(M,{className:"p-6",children:e.jsx(z,{className:"text-xl font-semibold text-primary",children:"Login Streak"})}),e.jsxs(O,{className:"py-6 px-0 flex flex-row items-center justify-center gap-8",children:[e.jsx(la,{streak:s.streak}),e.jsx("span",{className:"text-6xl font-extrabold text-green-500 tabular-nums",children:e.jsx(ot,{start:t.current,end:s.streak,duration:.7,preserveValue:!0})},s.streak)]})]})}const ia=s=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 py-6",children:[e.jsx(oa,{streak:s.streak}),e.jsxs(P,{className:"w-full md:w-1/2 rounded-lg border shadow-sm",children:[e.jsx(M,{className:"p-6",children:e.jsx(z,{className:"text-xl font-semibold text-primary",children:"Account Options"})}),e.jsx(O,{className:"p-6 pt-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(it,{label:"Theme",value:s.theme,onIonChange:t=>s.setTheme(t.detail.value),interface:"popover",placeholder:"Select Theme",children:[e.jsx(ze,{value:"light",children:"Light"}),e.jsx(ze,{value:"dark",children:"Dark"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-black dark:text-white",children:"Change Your Password"}),e.jsx("p",{className:"text-xs dark:text-gray-300",children:"Reset your account password."})]}),e.jsx(w,{color:"primary",onClick:()=>s.setShowPasswordAlert(!0),children:"Change Password"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-black dark:text-white",children:"Delete Your Account"}),e.jsx("p",{className:"text-xs dark:text-gray-300",children:"This will delete all account data and can't be undone."})]}),e.jsx(w,{color:"danger",onClick:()=>s.setShowDeleteAlert(!0),children:"Delete Account"})]})]})})]})]}),e.jsx(xe,{isOpen:s.showPasswordAlert,onDidDismiss:()=>s.setShowPasswordAlert(!1),header:"Change Password",inputs:[{name:"oldPassword",type:"password",placeholder:"Old Password"},{name:"newPassword",type:"password",placeholder:"New Password"},{name:"confirmPassword",type:"password",placeholder:"Confirm New Password"}],buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Save",handler:t=>t.newPassword!==t.confirmPassword?(s.presentToast({message:"Passwords do not match",duration:2e3,color:"danger"}),!0):(console.log("Password changed"),!0)}]}),e.jsx(xe,{isOpen:s.showDeleteAlert,onDidDismiss:()=>s.setShowDeleteAlert(!1),header:"Confirm Deletion",message:"Are you sure you want to delete your account? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Cancel clicked")}},{text:"Delete",handler:()=>{console.log("Account deleted")}}]})]}),ca=()=>{const{theme:s,setTheme:t}=gs(),[a,n]=r.useState(),[o,c]=r.useState(!0),[u,l]=r.useState(null),[h,d]=r.useState(null),[m,p]=r.useState(!1),[x,N]=r.useState(!1),[i,f]=r.useState(!1),[j,D]=r.useState(a),T=g=>{d(h===g?null:g)},V=()=>{D(a),f(!0)},U=async()=>{if(!S())return;const g=["first_name","last_name","username","email"];try{const b=g.filter(v=>j[v]!==a[v]).map(v=>y(`/api/users/${v}`,{method:"PUT",headers:{[v]:j[v]}}));await Promise.all(b),n(j),f(!1)}catch(b){console.error(b),alert("Failed to update some fields. Please try again.")}},S=()=>{const g={};let b=!0;return j.first_name||(g.first_name="First name is required",b=!1),j.last_name||(g.last_name="Last name is required",b=!1),j.email?/\S+@\S+\.\S+/.test(j.email)||(g.email="Email is invalid",b=!1):(g.email="Email is required",b=!1),j.username||(g.username="Username is required",b=!1),j.first_name=j.first_name.trim(),j.last_name=j.last_name.trim(),j.email=j.email.trim(),j.username=j.username.trim(),ae(g),b},[I,ae]=r.useState({}),J=g=>{const{name:b}=g.target,v=g.detail.value;D(R=>({...R,[b]:v}))};r.useEffect(()=>{(async()=>{c(!0),l(null);try{const b=await y("/api/users/",{method:"GET",headers:{}});n(b),D(b),console.log("data",b)}catch(b){console.log(`Failed to fetch User Data: ${b.message}`),l(`Failed to fetch User Data: ${b.message}`)}finally{c(!1)}})()},[]);const[_]=Ce();return e.jsxs(F,{children:[e.jsx(G,{}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("p",{className:"text-xl font-semibold text-primary",children:["Welcome back, ",(a==null?void 0:a.username)||"User","!"]})}),e.jsxs(w,{onClick:()=>window.history.back(),fill:"outline",className:"mb-6",children:[e.jsx(k,{slot:"start",icon:Ie}),"Back"]}),o&&e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx(Y,{name:"circular"}),e.jsx("span",{className:"ml-2",children:"Loading account details..."})]}),u&&!o&&e.jsx("div",{className:"text-red-500 text-center p-4 border border-red-500 rounded-md",children:u}),!o&&!u&&a&&e.jsxs(e.Fragment,{children:[e.jsx(na,{isEditing:i,errors:I,handleChange:J,handleSave:U,updatedInfo:j,userInfo:a,handleEdit:V}),e.jsx(ia,{streak:(a==null?void 0:a.login_streak)??0,isEditing:i,errors:I,handleChange:J,handleSave:U,updatedInfo:j,userInfo:a,expandedClass:h,toggleClassDetails:T,showPasswordAlert:m,setShowPasswordAlert:p,showDeleteAlert:x,setShowDeleteAlert:N,theme:s,setTheme:t,presentToast:_})]})]})]})};ct();const da=new dt;function ua(){return e.jsx(ut,{client:da,children:e.jsx(Ot,{children:e.jsxs(_t,{children:[e.jsx(mt,{children:e.jsx(ht,{children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsxs(xt,{children:[e.jsx(L,{exact:!0,path:"/",component:ea}),e.jsx(L,{exact:!0,path:"/home",component:Zt}),e.jsx(L,{exact:!0,path:"/class/:id",component:Ht}),e.jsx(L,{exact:!0,path:"/auth",component:cs}),e.jsx(L,{exact:!0,path:"/reset-password",component:Dt}),e.jsx(L,{exact:!0,path:"/public-cards",component:ta}),e.jsx(L,{exact:!0,path:"/user-account",component:ca}),e.jsx(L,{exact:!0,path:"/flashcards/:id",component:Xt}),e.jsx(L,{exact:!0,path:"/create-set",component:Yt}),e.jsx(L,{exact:!0,path:"/edit-set/:id",component:Qt}),e.jsx(L,{exact:!0,path:"/create-class",component:Jt}),e.jsx(L,{exact:!0,path:"/public-classes",component:aa}),e.jsx(L,{exact:!0,path:"/set-overview/:id",component:ra}),e.jsx(L,{component:sa})]})})})}),e.jsx(Ft,{}),e.jsx(Et,{})]})})})}const ma=document.getElementById("root"),ha=ft(ma);ha.render(e.jsx(ua,{}));export{pa as _,ga as c,ja as g};
//# sourceMappingURL=index-C52J74_1.js.map
